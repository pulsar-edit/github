"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.DecorableContext = exports.MarkerContext = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _eventKit = require("event-kit");
var _helpers = require("../helpers");
var _propTypes2 = require("../prop-types");
var _refHolder = _interopRequireDefault(require("../models/ref-holder"));
var _atomTextEditor = require("./atom-text-editor");
var _markerLayer = require("./marker-layer");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }
function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
const MarkablePropType = _propTypes.default.shape({
  markBufferRange: _propTypes.default.func.isRequired
});
const markerProps = {
  exclusive: _propTypes.default.bool,
  reversed: _propTypes.default.bool,
  invalidate: _propTypes.default.oneOf(['never', 'surround', 'overlap', 'inside', 'touch'])
};
const MarkerContext = _react.default.createContext();
exports.MarkerContext = MarkerContext;
const DecorableContext = _react.default.createContext();
exports.DecorableContext = DecorableContext;
class BareMarker extends _react.default.Component {
  constructor(props) {
    super(props);
    (0, _helpers.autobind)(this, 'createMarker', 'didChange');
    this.markerSubs = new _eventKit.CompositeDisposable();
    this.subs = new _eventKit.CompositeDisposable();
    this.markerHolder = new _refHolder.default();
    this.markerHolder.observe(marker => {
      this.props.handleMarker(marker);
    });
    this.decorable = {
      holder: this.markerHolder,
      decorateMethod: 'decorateMarker'
    };
  }
  componentDidMount() {
    this.observeMarkable();
  }
  render() {
    return _react.default.createElement(MarkerContext.Provider, {
      value: this.markerHolder
    }, _react.default.createElement(DecorableContext.Provider, {
      value: this.decorable
    }, this.props.children));
  }
  componentDidUpdate(prevProps) {
    if (prevProps.markableHolder !== this.props.markableHolder) {
      this.observeMarkable();
    }
    if (Object.keys(markerProps).some(key => prevProps[key] !== this.props[key])) {
      this.markerHolder.map(marker => marker.setProperties((0, _helpers.extractProps)(this.props, markerProps)));
    }
    this.updateMarkerPosition();
  }
  componentWillUnmount() {
    this.subs.dispose();
  }
  observeMarkable() {
    this.subs.dispose();
    this.subs = new _eventKit.CompositeDisposable();
    this.subs.add(this.props.markableHolder.observe(this.createMarker));
  }
  createMarker() {
    this.markerSubs.dispose();
    this.markerSubs = new _eventKit.CompositeDisposable();
    this.subs.add(this.markerSubs);
    const options = (0, _helpers.extractProps)(this.props, markerProps);
    this.props.markableHolder.map(markable => {
      let marker;
      if (this.props.id !== undefined) {
        marker = markable.getMarker(this.props.id);
        if (!marker) {
          throw new Error(`Invalid marker ID: ${this.props.id}`);
        }
        marker.setProperties(options);
      } else {
        marker = markable.markBufferRange(this.props.bufferRange, options);
        this.markerSubs.add(new _eventKit.Disposable(() => marker.destroy()));
      }
      this.markerSubs.add(marker.onDidChange(this.didChange));
      this.markerHolder.setter(marker);
      this.props.handleID(marker.id);
      return null;
    });
  }
  updateMarkerPosition() {
    this.markerHolder.map(marker => marker.setBufferRange(this.props.bufferRange));
  }
  didChange(event) {
    const reversed = this.markerHolder.map(marker => marker.isReversed()).getOr(false);
    const oldBufferStartPosition = reversed ? event.oldHeadBufferPosition : event.oldTailBufferPosition;
    const oldBufferEndPosition = reversed ? event.oldTailBufferPosition : event.oldHeadBufferPosition;
    const newBufferStartPosition = reversed ? event.newHeadBufferPosition : event.newTailBufferPosition;
    const newBufferEndPosition = reversed ? event.newTailBufferPosition : event.newHeadBufferPosition;
    this.props.onDidChange(_objectSpread({
      oldRange: new Range(oldBufferStartPosition, oldBufferEndPosition),
      newRange: new Range(newBufferStartPosition, newBufferEndPosition)
    }, event));
  }
}
_defineProperty(BareMarker, "propTypes", _objectSpread({}, markerProps, {
  id: _propTypes.default.number,
  bufferRange: _propTypes2.RangePropType,
  markableHolder: _propTypes2.RefHolderPropType,
  children: _propTypes.default.node,
  onDidChange: _propTypes.default.func,
  handleID: _propTypes.default.func,
  handleMarker: _propTypes.default.func
}));
_defineProperty(BareMarker, "defaultProps", {
  onDidChange: () => {},
  handleID: () => {},
  handleMarker: () => {}
});
class Marker extends _react.default.Component {
  constructor(props) {
    super(props);
    this.state = {
      markableHolder: _refHolder.default.on(props.layer || props.editor)
    };
  }
  static getDerivedStateFromProps(props, state) {
    const markable = props.layer || props.editor;
    if (state.markableHolder.map(m => m === markable).getOr(markable === undefined)) {
      return {};
    }
    return {
      markableHolder: _refHolder.default.on(markable)
    };
  }
  render() {
    if (!this.state.markableHolder.isEmpty()) {
      return _react.default.createElement(BareMarker, _extends({}, this.props, {
        markableHolder: this.state.markableHolder
      }));
    }
    return _react.default.createElement(_markerLayer.MarkerLayerContext.Consumer, null, layerHolder => {
      if (layerHolder) {
        return _react.default.createElement(BareMarker, _extends({}, this.props, {
          markableHolder: layerHolder
        }));
      } else {
        return _react.default.createElement(_atomTextEditor.TextEditorContext.Consumer, null, editorHolder => _react.default.createElement(BareMarker, _extends({}, this.props, {
          markableHolder: editorHolder
        })));
      }
    });
  }
}
exports.default = Marker;
_defineProperty(Marker, "propTypes", {
  editor: MarkablePropType,
  layer: MarkablePropType
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfZXZlbnRLaXQiLCJfaGVscGVycyIsIl9wcm9wVHlwZXMyIiwiX3JlZkhvbGRlciIsIl9hdG9tVGV4dEVkaXRvciIsIl9tYXJrZXJMYXllciIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJiaW5kIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImFwcGx5Iiwib3duS2V5cyIsIm9iamVjdCIsImVudW1lcmFibGVPbmx5Iiwia2V5cyIsImdldE93blByb3BlcnR5U3ltYm9scyIsInN5bWJvbHMiLCJmaWx0ZXIiLCJzeW0iLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJlbnVtZXJhYmxlIiwicHVzaCIsIl9vYmplY3RTcHJlYWQiLCJmb3JFYWNoIiwiX2RlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImFyZyIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsImlucHV0IiwiaGludCIsInByaW0iLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsInVuZGVmaW5lZCIsInJlcyIsIlR5cGVFcnJvciIsIk51bWJlciIsIk1hcmthYmxlUHJvcFR5cGUiLCJQcm9wVHlwZXMiLCJzaGFwZSIsIm1hcmtCdWZmZXJSYW5nZSIsImZ1bmMiLCJpc1JlcXVpcmVkIiwibWFya2VyUHJvcHMiLCJleGNsdXNpdmUiLCJib29sIiwicmV2ZXJzZWQiLCJpbnZhbGlkYXRlIiwib25lT2YiLCJNYXJrZXJDb250ZXh0IiwiUmVhY3QiLCJjcmVhdGVDb250ZXh0IiwiZXhwb3J0cyIsIkRlY29yYWJsZUNvbnRleHQiLCJCYXJlTWFya2VyIiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsImF1dG9iaW5kIiwibWFya2VyU3VicyIsIkNvbXBvc2l0ZURpc3Bvc2FibGUiLCJzdWJzIiwibWFya2VySG9sZGVyIiwiUmVmSG9sZGVyIiwib2JzZXJ2ZSIsIm1hcmtlciIsImhhbmRsZU1hcmtlciIsImRlY29yYWJsZSIsImhvbGRlciIsImRlY29yYXRlTWV0aG9kIiwiY29tcG9uZW50RGlkTW91bnQiLCJvYnNlcnZlTWFya2FibGUiLCJyZW5kZXIiLCJjcmVhdGVFbGVtZW50IiwiUHJvdmlkZXIiLCJjaGlsZHJlbiIsImNvbXBvbmVudERpZFVwZGF0ZSIsInByZXZQcm9wcyIsIm1hcmthYmxlSG9sZGVyIiwic29tZSIsIm1hcCIsInNldFByb3BlcnRpZXMiLCJleHRyYWN0UHJvcHMiLCJ1cGRhdGVNYXJrZXJQb3NpdGlvbiIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiZGlzcG9zZSIsImFkZCIsImNyZWF0ZU1hcmtlciIsIm9wdGlvbnMiLCJtYXJrYWJsZSIsImlkIiwiZ2V0TWFya2VyIiwiRXJyb3IiLCJidWZmZXJSYW5nZSIsIkRpc3Bvc2FibGUiLCJkZXN0cm95Iiwib25EaWRDaGFuZ2UiLCJkaWRDaGFuZ2UiLCJzZXR0ZXIiLCJoYW5kbGVJRCIsInNldEJ1ZmZlclJhbmdlIiwiZXZlbnQiLCJpc1JldmVyc2VkIiwiZ2V0T3IiLCJvbGRCdWZmZXJTdGFydFBvc2l0aW9uIiwib2xkSGVhZEJ1ZmZlclBvc2l0aW9uIiwib2xkVGFpbEJ1ZmZlclBvc2l0aW9uIiwib2xkQnVmZmVyRW5kUG9zaXRpb24iLCJuZXdCdWZmZXJTdGFydFBvc2l0aW9uIiwibmV3SGVhZEJ1ZmZlclBvc2l0aW9uIiwibmV3VGFpbEJ1ZmZlclBvc2l0aW9uIiwibmV3QnVmZmVyRW5kUG9zaXRpb24iLCJvbGRSYW5nZSIsIlJhbmdlIiwibmV3UmFuZ2UiLCJudW1iZXIiLCJSYW5nZVByb3BUeXBlIiwiUmVmSG9sZGVyUHJvcFR5cGUiLCJub2RlIiwiTWFya2VyIiwic3RhdGUiLCJvbiIsImxheWVyIiwiZWRpdG9yIiwiZ2V0RGVyaXZlZFN0YXRlRnJvbVByb3BzIiwibSIsImlzRW1wdHkiLCJNYXJrZXJMYXllckNvbnRleHQiLCJDb25zdW1lciIsImxheWVySG9sZGVyIiwiVGV4dEVkaXRvckNvbnRleHQiLCJlZGl0b3JIb2xkZXIiXSwic291cmNlcyI6WyJtYXJrZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQge0NvbXBvc2l0ZURpc3Bvc2FibGUsIERpc3Bvc2FibGV9IGZyb20gJ2V2ZW50LWtpdCc7XG5cbmltcG9ydCB7YXV0b2JpbmQsIGV4dHJhY3RQcm9wc30gZnJvbSAnLi4vaGVscGVycyc7XG5pbXBvcnQge1JlZkhvbGRlclByb3BUeXBlLCBSYW5nZVByb3BUeXBlfSBmcm9tICcuLi9wcm9wLXR5cGVzJztcbmltcG9ydCBSZWZIb2xkZXIgZnJvbSAnLi4vbW9kZWxzL3JlZi1ob2xkZXInO1xuaW1wb3J0IHtUZXh0RWRpdG9yQ29udGV4dH0gZnJvbSAnLi9hdG9tLXRleHQtZWRpdG9yJztcbmltcG9ydCB7TWFya2VyTGF5ZXJDb250ZXh0fSBmcm9tICcuL21hcmtlci1sYXllcic7XG5cbmNvbnN0IE1hcmthYmxlUHJvcFR5cGUgPSBQcm9wVHlwZXMuc2hhcGUoe1xuICBtYXJrQnVmZmVyUmFuZ2U6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG59KTtcblxuY29uc3QgbWFya2VyUHJvcHMgPSB7XG4gIGV4Y2x1c2l2ZTogUHJvcFR5cGVzLmJvb2wsXG4gIHJldmVyc2VkOiBQcm9wVHlwZXMuYm9vbCxcbiAgaW52YWxpZGF0ZTogUHJvcFR5cGVzLm9uZU9mKFsnbmV2ZXInLCAnc3Vycm91bmQnLCAnb3ZlcmxhcCcsICdpbnNpZGUnLCAndG91Y2gnXSksXG59O1xuXG5leHBvcnQgY29uc3QgTWFya2VyQ29udGV4dCA9IFJlYWN0LmNyZWF0ZUNvbnRleHQoKTtcblxuZXhwb3J0IGNvbnN0IERlY29yYWJsZUNvbnRleHQgPSBSZWFjdC5jcmVhdGVDb250ZXh0KCk7XG5cbmNsYXNzIEJhcmVNYXJrZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC4uLm1hcmtlclByb3BzLFxuICAgIGlkOiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIGJ1ZmZlclJhbmdlOiBSYW5nZVByb3BUeXBlLFxuICAgIG1hcmthYmxlSG9sZGVyOiBSZWZIb2xkZXJQcm9wVHlwZSxcbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUsXG4gICAgb25EaWRDaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICAgIGhhbmRsZUlEOiBQcm9wVHlwZXMuZnVuYyxcbiAgICBoYW5kbGVNYXJrZXI6IFByb3BUeXBlcy5mdW5jLFxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBvbkRpZENoYW5nZTogKCkgPT4ge30sXG4gICAgaGFuZGxlSUQ6ICgpID0+IHt9LFxuICAgIGhhbmRsZU1hcmtlcjogKCkgPT4ge30sXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIGF1dG9iaW5kKHRoaXMsICdjcmVhdGVNYXJrZXInLCAnZGlkQ2hhbmdlJyk7XG5cbiAgICB0aGlzLm1hcmtlclN1YnMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICAgIHRoaXMuc3VicyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG5cbiAgICB0aGlzLm1hcmtlckhvbGRlciA9IG5ldyBSZWZIb2xkZXIoKTtcbiAgICB0aGlzLm1hcmtlckhvbGRlci5vYnNlcnZlKG1hcmtlciA9PiB7XG4gICAgICB0aGlzLnByb3BzLmhhbmRsZU1hcmtlcihtYXJrZXIpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5kZWNvcmFibGUgPSB7XG4gICAgICBob2xkZXI6IHRoaXMubWFya2VySG9sZGVyLFxuICAgICAgZGVjb3JhdGVNZXRob2Q6ICdkZWNvcmF0ZU1hcmtlcicsXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMub2JzZXJ2ZU1hcmthYmxlKCk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNYXJrZXJDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt0aGlzLm1hcmtlckhvbGRlcn0+XG4gICAgICAgIDxEZWNvcmFibGVDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt0aGlzLmRlY29yYWJsZX0+XG4gICAgICAgICAge3RoaXMucHJvcHMuY2hpbGRyZW59XG4gICAgICAgIDwvRGVjb3JhYmxlQ29udGV4dC5Qcm92aWRlcj5cbiAgICAgIDwvTWFya2VyQ29udGV4dC5Qcm92aWRlcj5cbiAgICApO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKHByZXZQcm9wcykge1xuICAgIGlmIChwcmV2UHJvcHMubWFya2FibGVIb2xkZXIgIT09IHRoaXMucHJvcHMubWFya2FibGVIb2xkZXIpIHtcbiAgICAgIHRoaXMub2JzZXJ2ZU1hcmthYmxlKCk7XG4gICAgfVxuXG4gICAgaWYgKE9iamVjdC5rZXlzKG1hcmtlclByb3BzKS5zb21lKGtleSA9PiBwcmV2UHJvcHNba2V5XSAhPT0gdGhpcy5wcm9wc1trZXldKSkge1xuICAgICAgdGhpcy5tYXJrZXJIb2xkZXIubWFwKG1hcmtlciA9PiBtYXJrZXIuc2V0UHJvcGVydGllcyhleHRyYWN0UHJvcHModGhpcy5wcm9wcywgbWFya2VyUHJvcHMpKSk7XG4gICAgfVxuXG4gICAgdGhpcy51cGRhdGVNYXJrZXJQb3NpdGlvbigpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5zdWJzLmRpc3Bvc2UoKTtcbiAgfVxuXG4gIG9ic2VydmVNYXJrYWJsZSgpIHtcbiAgICB0aGlzLnN1YnMuZGlzcG9zZSgpO1xuICAgIHRoaXMuc3VicyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgdGhpcy5zdWJzLmFkZCh0aGlzLnByb3BzLm1hcmthYmxlSG9sZGVyLm9ic2VydmUodGhpcy5jcmVhdGVNYXJrZXIpKTtcbiAgfVxuXG4gIGNyZWF0ZU1hcmtlcigpIHtcbiAgICB0aGlzLm1hcmtlclN1YnMuZGlzcG9zZSgpO1xuICAgIHRoaXMubWFya2VyU3VicyA9IG5ldyBDb21wb3NpdGVEaXNwb3NhYmxlKCk7XG4gICAgdGhpcy5zdWJzLmFkZCh0aGlzLm1hcmtlclN1YnMpO1xuXG4gICAgY29uc3Qgb3B0aW9ucyA9IGV4dHJhY3RQcm9wcyh0aGlzLnByb3BzLCBtYXJrZXJQcm9wcyk7XG5cbiAgICB0aGlzLnByb3BzLm1hcmthYmxlSG9sZGVyLm1hcChtYXJrYWJsZSA9PiB7XG4gICAgICBsZXQgbWFya2VyO1xuXG4gICAgICBpZiAodGhpcy5wcm9wcy5pZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIG1hcmtlciA9IG1hcmthYmxlLmdldE1hcmtlcih0aGlzLnByb3BzLmlkKTtcbiAgICAgICAgaWYgKCFtYXJrZXIpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgbWFya2VyIElEOiAke3RoaXMucHJvcHMuaWR9YCk7XG4gICAgICAgIH1cbiAgICAgICAgbWFya2VyLnNldFByb3BlcnRpZXMob3B0aW9ucyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtYXJrZXIgPSBtYXJrYWJsZS5tYXJrQnVmZmVyUmFuZ2UodGhpcy5wcm9wcy5idWZmZXJSYW5nZSwgb3B0aW9ucyk7XG4gICAgICAgIHRoaXMubWFya2VyU3Vicy5hZGQobmV3IERpc3Bvc2FibGUoKCkgPT4gbWFya2VyLmRlc3Ryb3koKSkpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm1hcmtlclN1YnMuYWRkKG1hcmtlci5vbkRpZENoYW5nZSh0aGlzLmRpZENoYW5nZSkpO1xuICAgICAgdGhpcy5tYXJrZXJIb2xkZXIuc2V0dGVyKG1hcmtlcik7XG4gICAgICB0aGlzLnByb3BzLmhhbmRsZUlEKG1hcmtlci5pZCk7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZU1hcmtlclBvc2l0aW9uKCkge1xuICAgIHRoaXMubWFya2VySG9sZGVyLm1hcChtYXJrZXIgPT4gbWFya2VyLnNldEJ1ZmZlclJhbmdlKHRoaXMucHJvcHMuYnVmZmVyUmFuZ2UpKTtcbiAgfVxuXG4gIGRpZENoYW5nZShldmVudCkge1xuICAgIGNvbnN0IHJldmVyc2VkID0gdGhpcy5tYXJrZXJIb2xkZXIubWFwKG1hcmtlciA9PiBtYXJrZXIuaXNSZXZlcnNlZCgpKS5nZXRPcihmYWxzZSk7XG5cbiAgICBjb25zdCBvbGRCdWZmZXJTdGFydFBvc2l0aW9uID0gcmV2ZXJzZWQgPyBldmVudC5vbGRIZWFkQnVmZmVyUG9zaXRpb24gOiBldmVudC5vbGRUYWlsQnVmZmVyUG9zaXRpb247XG4gICAgY29uc3Qgb2xkQnVmZmVyRW5kUG9zaXRpb24gPSByZXZlcnNlZCA/IGV2ZW50Lm9sZFRhaWxCdWZmZXJQb3NpdGlvbiA6IGV2ZW50Lm9sZEhlYWRCdWZmZXJQb3NpdGlvbjtcblxuICAgIGNvbnN0IG5ld0J1ZmZlclN0YXJ0UG9zaXRpb24gPSByZXZlcnNlZCA/IGV2ZW50Lm5ld0hlYWRCdWZmZXJQb3NpdGlvbiA6IGV2ZW50Lm5ld1RhaWxCdWZmZXJQb3NpdGlvbjtcbiAgICBjb25zdCBuZXdCdWZmZXJFbmRQb3NpdGlvbiA9IHJldmVyc2VkID8gZXZlbnQubmV3VGFpbEJ1ZmZlclBvc2l0aW9uIDogZXZlbnQubmV3SGVhZEJ1ZmZlclBvc2l0aW9uO1xuXG4gICAgdGhpcy5wcm9wcy5vbkRpZENoYW5nZSh7XG4gICAgICBvbGRSYW5nZTogbmV3IFJhbmdlKG9sZEJ1ZmZlclN0YXJ0UG9zaXRpb24sIG9sZEJ1ZmZlckVuZFBvc2l0aW9uKSxcbiAgICAgIG5ld1JhbmdlOiBuZXcgUmFuZ2UobmV3QnVmZmVyU3RhcnRQb3NpdGlvbiwgbmV3QnVmZmVyRW5kUG9zaXRpb24pLFxuICAgICAgLi4uZXZlbnQsXG4gICAgfSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWFya2VyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICBlZGl0b3I6IE1hcmthYmxlUHJvcFR5cGUsXG4gICAgbGF5ZXI6IE1hcmthYmxlUHJvcFR5cGUsXG4gIH1cblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBtYXJrYWJsZUhvbGRlcjogUmVmSG9sZGVyLm9uKHByb3BzLmxheWVyIHx8IHByb3BzLmVkaXRvciksXG4gICAgfTtcbiAgfVxuXG4gIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMocHJvcHMsIHN0YXRlKSB7XG4gICAgY29uc3QgbWFya2FibGUgPSBwcm9wcy5sYXllciB8fCBwcm9wcy5lZGl0b3I7XG5cbiAgICBpZiAoc3RhdGUubWFya2FibGVIb2xkZXIubWFwKG0gPT4gbSA9PT0gbWFya2FibGUpLmdldE9yKG1hcmthYmxlID09PSB1bmRlZmluZWQpKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIG1hcmthYmxlSG9sZGVyOiBSZWZIb2xkZXIub24obWFya2FibGUpLFxuICAgIH07XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgaWYgKCF0aGlzLnN0YXRlLm1hcmthYmxlSG9sZGVyLmlzRW1wdHkoKSkge1xuICAgICAgcmV0dXJuIDxCYXJlTWFya2VyIHsuLi50aGlzLnByb3BzfSBtYXJrYWJsZUhvbGRlcj17dGhpcy5zdGF0ZS5tYXJrYWJsZUhvbGRlcn0gLz47XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxNYXJrZXJMYXllckNvbnRleHQuQ29uc3VtZXI+XG4gICAgICAgIHtsYXllckhvbGRlciA9PiB7XG4gICAgICAgICAgaWYgKGxheWVySG9sZGVyKSB7XG4gICAgICAgICAgICByZXR1cm4gPEJhcmVNYXJrZXIgey4uLnRoaXMucHJvcHN9IG1hcmthYmxlSG9sZGVyPXtsYXllckhvbGRlcn0gLz47XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgIDxUZXh0RWRpdG9yQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgICAgICAgICB7ZWRpdG9ySG9sZGVyID0+IDxCYXJlTWFya2VyIHsuLi50aGlzLnByb3BzfSBtYXJrYWJsZUhvbGRlcj17ZWRpdG9ySG9sZGVyfSAvPn1cbiAgICAgICAgICAgICAgPC9UZXh0RWRpdG9yQ29udGV4dC5Db25zdW1lcj5cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9fVxuICAgICAgPC9NYXJrZXJMYXllckNvbnRleHQuQ29uc3VtZXI+XG4gICAgKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFGLE9BQUE7QUFFQSxJQUFBRyxRQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxXQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxVQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxlQUFBLEdBQUFOLE9BQUE7QUFDQSxJQUFBTyxZQUFBLEdBQUFQLE9BQUE7QUFBa0QsU0FBQUQsdUJBQUFTLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFBQSxTQUFBRyxTQUFBLElBQUFBLFFBQUEsR0FBQUMsTUFBQSxDQUFBQyxNQUFBLEdBQUFELE1BQUEsQ0FBQUMsTUFBQSxDQUFBQyxJQUFB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