"use strict";

/* eslint comma-dangle: ["error", {
    "arrays": "never",
    "objects": "never",
    "imports": "never",
    "exports": "never",
    "functions": "never"
  }] */

const {
  execFile
} = require('child_process');
const fs = require('fs');
if (typeof atom === 'undefined') {
  global.atom = {
    inSpecMode() {
      return !!process.env.ATOM_GITHUB_SPEC_MODE;
    },
    inDevMode() {
      return false;
    }
  };
}

// No token available in your OS keychain.
const UNAUTHENTICATED = Symbol('UNAUTHENTICATED');

// The token in your keychain isn't granted all of the required OAuth scopes.
const INSUFFICIENT = Symbol('INSUFFICIENT');

// The token in your keychain is not accepted by GitHub.
const UNAUTHORIZED = Symbol('UNAUTHORIZED');
class KeytarStrategy {
  static get keytar() {
    return require('keytar');
  }
  static async isValid() {
    // Allow for disabling Keytar on problematic CI environments
    if (process.env.ATOM_GITHUB_DISABLE_KEYTAR) {
      return false;
    }
    const keytar = this.keytar;
    try {
      const rand = Math.floor(Math.random() * 10e20).toString(16);
      await keytar.setPassword('atom-test-service', rand, rand);
      const pass = await keytar.getPassword('atom-test-service', rand);
      const success = pass === rand;
      keytar.deletePassword('atom-test-service', rand);
      return success;
    } catch (err) {
      return false;
    }
  }
  async getPassword(service, account) {
    const password = await this.constructor.keytar.getPassword(service, account);
    return password !== null ? password : UNAUTHENTICATED;
  }
  replacePassword(service, account, password) {
    return this.constructor.keytar.setPassword(service, account, password);
  }
  deletePassword(service, account) {
    return this.constructor.keytar.deletePassword(service, account);
  }
}
class SecurityBinaryStrategy {
  static isValid() {
    return process.platform === 'darwin';
  }
  async getPassword(service, account) {
    try {
      const password = await this.exec(['find-generic-password', '-s', service, '-a', account, '-w']);
      return password.trim() || UNAUTHENTICATED;
    } catch (err) {
      return UNAUTHENTICATED;
    }
  }
  replacePassword(service, account, newPassword) {
    return this.exec(['add-generic-password', '-s', service, '-a', account, '-w', newPassword, '-U']);
  }
  deletePassword(service, account) {
    return this.exec(['delete-generic-password', '-s', service, '-a', account]);
  }
  exec(securityArgs, {
    binary
  } = {
    binary: 'security'
  }) {
    return new Promise((resolve, reject) => {
      execFile(binary, securityArgs, (error, stdout) => {
        if (error) {
          return reject(error);
        }
        return resolve(stdout);
      });
    });
  }
}
class InMemoryStrategy {
  static isValid() {
    return true;
  }
  constructor() {
    if (!atom.inSpecMode()) {
      // eslint-disable-next-line no-console
      console.warn('Using an InMemoryStrategy strategy for storing tokens. ' + 'The tokens will only be stored for the current window.');
    }
    this.passwordsByService = new Map();
  }
  getPassword(service, account) {
    const passwords = this.passwordsByService.get(service) || new Map();
    const password = passwords.get(account);
    return password || UNAUTHENTICATED;
  }
  replacePassword(service, account, newPassword) {
    const passwords = this.passwordsByService.get(service) || new Map();
    passwords.set(account, newPassword);
    this.passwordsByService.set(service, passwords);
  }
  deletePassword(service, account) {
    const passwords = this.passwordsByService.get(service);
    if (passwords) {
      passwords.delete(account);
    }
  }
}
class FileStrategy {
  static isValid() {
    if (!atom.inSpecMode() && !atom.inDevMode()) {
      return false;
    }
    return Boolean(process.env.ATOM_GITHUB_KEYTAR_FILE);
  }
  constructor() {
    this.filePath = process.env.ATOM_GITHUB_KEYTAR_FILE;
    if (!atom.inSpecMode()) {
      // eslint-disable-next-line no-console
      console.warn('Using a FileStrategy strategy for storing tokens. ' + 'The tokens will be stored %cin the clear%c in a file at %s. ' + "You probably shouldn't use real credentials while this strategy is in use. " + 'Unset ATOM_GITHUB_KEYTAR_FILE_STRATEGY to disable it.', 'color: red; font-weight: bold; font-style: italic', 'color: black; font-weight: normal; font-style: normal', this.filePath);
    }
  }
  async getPassword(service, account) {
    const payload = await this.load();
    const forService = payload[service];
    if (forService === undefined) {
      return UNAUTHENTICATED;
    }
    const passwd = forService[account];
    if (passwd === undefined) {
      return UNAUTHENTICATED;
    }
    return passwd;
  }
  replacePassword(service, account, password) {
    return this.modify(payload => {
      let forService = payload[service];
      if (forService === undefined) {
        forService = {};
        payload[service] = forService;
      }
      forService[account] = password;
    });
  }
  deletePassword(service, account) {
    return this.modify(payload => {
      const forService = payload[service];
      if (forService === undefined) {
        return;
      }
      delete forService[account];
      if (Object.keys(forService).length === 0) {
        delete payload[service];
      }
    });
  }
  load() {
    return new Promise((resolve, reject) => {
      fs.readFile(this.filePath, 'utf8', (err, content) => {
        if (err && err.code === 'ENOENT') {
          return resolve({});
        }
        if (err) {
          return reject(err);
        }
        return resolve(JSON.parse(content));
      });
    });
  }
  save(payload) {
    return new Promise((resolve, reject) => {
      fs.writeFile(this.filePath, JSON.stringify(payload), 'utf8', err => {
        if (err) {
          reject(err);
        } else {
          resolve();
        }
      });
    });
  }
  async modify(callback) {
    const payload = await this.load();
    callback(payload);
    await this.save(payload);
  }
}
const strategies = [FileStrategy, KeytarStrategy, SecurityBinaryStrategy, InMemoryStrategy];
let ValidStrategy = null;
async function createStrategy() {
  if (ValidStrategy) {
    return new ValidStrategy();
  }
  for (let i = 0; i < strategies.length; i++) {
    const strat = strategies[i];
    const isValid = await strat.isValid();
    if (isValid) {
      ValidStrategy = strat;
      break;
    }
  }
  if (!ValidStrategy) {
    throw new Error('None of the listed keytar strategies returned true for `isValid`');
  }
  return new ValidStrategy();
}
module.exports = {
  UNAUTHENTICATED,
  INSUFFICIENT,
  UNAUTHORIZED,
  KeytarStrategy,
  SecurityBinaryStrategy,
  InMemoryStrategy,
  FileStrategy,
  createStrategy
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJleGVjRmlsZSIsInJlcXVpcmUiLCJmcyIsImF0b20iLCJnbG9iYWwiLCJpblNwZWNNb2RlIiwicHJvY2VzcyIsImVudiIsIkFUT01fR0lUSFVCX1NQRUNfTU9ERSIsImluRGV2TW9kZSIsIlVOQVVUSEVOVElDQVRFRCIsIlN5bWJvbCIsIklOU1VGRklDSUVOVCIsIlVOQVVUSE9SSVpFRCIsIktleXRhclN0cmF0ZWd5Iiwia2V5dGFyIiwiaXNWYWxpZCIsIkFUT01fR0lUSFVCX0RJU0FCTEVfS0VZVEFSIiwicmFuZCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInRvU3RyaW5nIiwic2V0UGFzc3dvcmQiLCJwYXNzIiwiZ2V0UGFzc3dvcmQiLCJzdWNjZXNzIiwiZGVsZXRlUGFzc3dvcmQiLCJlcnIiLCJzZXJ2aWNlIiwiYWNjb3VudCIsInBhc3N3b3JkIiwiY29uc3RydWN0b3IiLCJyZXBsYWNlUGFzc3dvcmQiLCJTZWN1cml0eUJpbmFyeVN0cmF0ZWd5IiwicGxhdGZvcm0iLCJleGVjIiwidHJpbSIsIm5ld1Bhc3N3b3JkIiwic2VjdXJpdHlBcmdzIiwiYmluYXJ5IiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJlcnJvciIsInN0ZG91dCIsIkluTWVtb3J5U3RyYXRlZ3kiLCJjb25zb2xlIiwid2FybiIsInBhc3N3b3Jkc0J5U2VydmljZSIsIk1hcCIsInBhc3N3b3JkcyIsImdldCIsInNldCIsImRlbGV0ZSIsIkZpbGVTdHJhdGVneSIsIkJvb2xlYW4iLCJBVE9NX0dJVEhVQl9LRVlUQVJfRklMRSIsImZpbGVQYXRoIiwicGF5bG9hZCIsImxvYWQiLCJmb3JTZXJ2aWNlIiwidW5kZWZpbmVkIiwicGFzc3dkIiwibW9kaWZ5IiwiT2JqZWN0Iiwia2V5cyIsImxlbmd0aCIsInJlYWRGaWxlIiwiY29udGVudCIsImNvZGUiLCJKU09OIiwicGFyc2UiLCJzYXZlIiwid3JpdGVGaWxlIiwic3RyaW5naWZ5IiwiY2FsbGJhY2siLCJzdHJhdGVnaWVzIiwiVmFsaWRTdHJhdGVneSIsImNyZWF0ZVN0cmF0ZWd5IiwiaSIsInN0cmF0IiwiRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsia2V5dGFyLXN0cmF0ZWd5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludCBjb21tYS1kYW5nbGU6IFtcImVycm9yXCIsIHtcbiAgICBcImFycmF5c1wiOiBcIm5ldmVyXCIsXG4gICAgXCJvYmplY3RzXCI6IFwibmV2ZXJcIixcbiAgICBcImltcG9ydHNcIjogXCJuZXZlclwiLFxuICAgIFwiZXhwb3J0c1wiOiBcIm5ldmVyXCIsXG4gICAgXCJmdW5jdGlvbnNcIjogXCJuZXZlclwiXG4gIH1dICovXG5cbmNvbnN0IHtleGVjRmlsZX0gPSByZXF1aXJlKCdjaGlsZF9wcm9jZXNzJyk7XG5jb25zdCBmcyA9IHJlcXVpcmUoJ2ZzJyk7XG5cbmlmICh0eXBlb2YgYXRvbSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgZ2xvYmFsLmF0b20gPSB7XG4gICAgaW5TcGVjTW9kZSgpIHsgcmV0dXJuICEhcHJvY2Vzcy5lbnYuQVRPTV9HSVRIVUJfU1BFQ19NT0RFOyB9LFxuICAgIGluRGV2TW9kZSgpIHsgcmV0dXJuIGZhbHNlOyB9XG4gIH07XG59XG5cbi8vIE5vIHRva2VuIGF2YWlsYWJsZSBpbiB5b3VyIE9TIGtleWNoYWluLlxuY29uc3QgVU5BVVRIRU5USUNBVEVEID0gU3ltYm9sKCdVTkFVVEhFTlRJQ0FURUQnKTtcblxuLy8gVGhlIHRva2VuIGluIHlvdXIga2V5Y2hhaW4gaXNuJ3QgZ3JhbnRlZCBhbGwgb2YgdGhlIHJlcXVpcmVkIE9BdXRoIHNjb3Blcy5cbmNvbnN0IElOU1VGRklDSUVOVCA9IFN5bWJvbCgnSU5TVUZGSUNJRU5UJyk7XG5cbi8vIFRoZSB0b2tlbiBpbiB5b3VyIGtleWNoYWluIGlzIG5vdCBhY2NlcHRlZCBieSBHaXRIdWIuXG5jb25zdCBVTkFVVEhPUklaRUQgPSBTeW1ib2woJ1VOQVVUSE9SSVpFRCcpO1xuXG5jbGFzcyBLZXl0YXJTdHJhdGVneSB7XG4gIHN0YXRpYyBnZXQga2V5dGFyKCkge1xuICAgIHJldHVybiByZXF1aXJlKCdrZXl0YXInKTtcbiAgfVxuXG4gIHN0YXRpYyBhc3luYyBpc1ZhbGlkKCkge1xuICAgIC8vIEFsbG93IGZvciBkaXNhYmxpbmcgS2V5dGFyIG9uIHByb2JsZW1hdGljIENJIGVudmlyb25tZW50c1xuICAgIGlmIChwcm9jZXNzLmVudi5BVE9NX0dJVEhVQl9ESVNBQkxFX0tFWVRBUikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIGNvbnN0IGtleXRhciA9IHRoaXMua2V5dGFyO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJhbmQgPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxMGUyMCkudG9TdHJpbmcoMTYpO1xuICAgICAgYXdhaXQga2V5dGFyLnNldFBhc3N3b3JkKCdhdG9tLXRlc3Qtc2VydmljZScsIHJhbmQsIHJhbmQpO1xuICAgICAgY29uc3QgcGFzcyA9IGF3YWl0IGtleXRhci5nZXRQYXNzd29yZCgnYXRvbS10ZXN0LXNlcnZpY2UnLCByYW5kKTtcbiAgICAgIGNvbnN0IHN1Y2Nlc3MgPSBwYXNzID09PSByYW5kO1xuICAgICAga2V5dGFyLmRlbGV0ZVBhc3N3b3JkKCdhdG9tLXRlc3Qtc2VydmljZScsIHJhbmQpO1xuICAgICAgcmV0dXJuIHN1Y2Nlc3M7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCkge1xuICAgIGNvbnN0IHBhc3N3b3JkID0gYXdhaXQgdGhpcy5jb25zdHJ1Y3Rvci5rZXl0YXIuZ2V0UGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCk7XG4gICAgcmV0dXJuIHBhc3N3b3JkICE9PSBudWxsID8gcGFzc3dvcmQgOiBVTkFVVEhFTlRJQ0FURUQ7XG4gIH1cblxuICByZXBsYWNlUGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCwgcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5rZXl0YXIuc2V0UGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCwgcGFzc3dvcmQpO1xuICB9XG5cbiAgZGVsZXRlUGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCkge1xuICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLmtleXRhci5kZWxldGVQYXNzd29yZChzZXJ2aWNlLCBhY2NvdW50KTtcbiAgfVxufVxuXG5jbGFzcyBTZWN1cml0eUJpbmFyeVN0cmF0ZWd5IHtcbiAgc3RhdGljIGlzVmFsaWQoKSB7XG4gICAgcmV0dXJuIHByb2Nlc3MucGxhdGZvcm0gPT09ICdkYXJ3aW4nO1xuICB9XG5cbiAgYXN5bmMgZ2V0UGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwYXNzd29yZCA9IGF3YWl0IHRoaXMuZXhlYyhbJ2ZpbmQtZ2VuZXJpYy1wYXNzd29yZCcsICctcycsIHNlcnZpY2UsICctYScsIGFjY291bnQsICctdyddKTtcbiAgICAgIHJldHVybiBwYXNzd29yZC50cmltKCkgfHwgVU5BVVRIRU5USUNBVEVEO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIFVOQVVUSEVOVElDQVRFRDtcbiAgICB9XG4gIH1cblxuICByZXBsYWNlUGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCwgbmV3UGFzc3dvcmQpIHtcbiAgICByZXR1cm4gdGhpcy5leGVjKFsnYWRkLWdlbmVyaWMtcGFzc3dvcmQnLCAnLXMnLCBzZXJ2aWNlLCAnLWEnLCBhY2NvdW50LCAnLXcnLCBuZXdQYXNzd29yZCwgJy1VJ10pO1xuICB9XG5cbiAgZGVsZXRlUGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCkge1xuICAgIHJldHVybiB0aGlzLmV4ZWMoWydkZWxldGUtZ2VuZXJpYy1wYXNzd29yZCcsICctcycsIHNlcnZpY2UsICctYScsIGFjY291bnRdKTtcbiAgfVxuXG4gIGV4ZWMoc2VjdXJpdHlBcmdzLCB7YmluYXJ5fSA9IHtiaW5hcnk6ICdzZWN1cml0eSd9KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGV4ZWNGaWxlKGJpbmFyeSwgc2VjdXJpdHlBcmdzLCAoZXJyb3IsIHN0ZG91dCkgPT4ge1xuICAgICAgICBpZiAoZXJyb3IpIHsgcmV0dXJuIHJlamVjdChlcnJvcik7IH1cbiAgICAgICAgcmV0dXJuIHJlc29sdmUoc3Rkb3V0KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbmNsYXNzIEluTWVtb3J5U3RyYXRlZ3kge1xuICBzdGF0aWMgaXNWYWxpZCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIGlmICghYXRvbS5pblNwZWNNb2RlKCkpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdVc2luZyBhbiBJbk1lbW9yeVN0cmF0ZWd5IHN0cmF0ZWd5IGZvciBzdG9yaW5nIHRva2Vucy4gJyArXG4gICAgICAgICdUaGUgdG9rZW5zIHdpbGwgb25seSBiZSBzdG9yZWQgZm9yIHRoZSBjdXJyZW50IHdpbmRvdy4nXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLnBhc3N3b3Jkc0J5U2VydmljZSA9IG5ldyBNYXAoKTtcbiAgfVxuXG4gIGdldFBhc3N3b3JkKHNlcnZpY2UsIGFjY291bnQpIHtcbiAgICBjb25zdCBwYXNzd29yZHMgPSB0aGlzLnBhc3N3b3Jkc0J5U2VydmljZS5nZXQoc2VydmljZSkgfHwgbmV3IE1hcCgpO1xuICAgIGNvbnN0IHBhc3N3b3JkID0gcGFzc3dvcmRzLmdldChhY2NvdW50KTtcbiAgICByZXR1cm4gcGFzc3dvcmQgfHwgVU5BVVRIRU5USUNBVEVEO1xuICB9XG5cbiAgcmVwbGFjZVBhc3N3b3JkKHNlcnZpY2UsIGFjY291bnQsIG5ld1Bhc3N3b3JkKSB7XG4gICAgY29uc3QgcGFzc3dvcmRzID0gdGhpcy5wYXNzd29yZHNCeVNlcnZpY2UuZ2V0KHNlcnZpY2UpIHx8IG5ldyBNYXAoKTtcbiAgICBwYXNzd29yZHMuc2V0KGFjY291bnQsIG5ld1Bhc3N3b3JkKTtcbiAgICB0aGlzLnBhc3N3b3Jkc0J5U2VydmljZS5zZXQoc2VydmljZSwgcGFzc3dvcmRzKTtcbiAgfVxuXG4gIGRlbGV0ZVBhc3N3b3JkKHNlcnZpY2UsIGFjY291bnQpIHtcbiAgICBjb25zdCBwYXNzd29yZHMgPSB0aGlzLnBhc3N3b3Jkc0J5U2VydmljZS5nZXQoc2VydmljZSk7XG4gICAgaWYgKHBhc3N3b3Jkcykge1xuICAgICAgcGFzc3dvcmRzLmRlbGV0ZShhY2NvdW50KTtcbiAgICB9XG4gIH1cbn1cblxuY2xhc3MgRmlsZVN0cmF0ZWd5IHtcbiAgc3RhdGljIGlzVmFsaWQoKSB7XG4gICAgaWYgKCFhdG9tLmluU3BlY01vZGUoKSAmJiAhYXRvbS5pbkRldk1vZGUoKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiBCb29sZWFuKHByb2Nlc3MuZW52LkFUT01fR0lUSFVCX0tFWVRBUl9GSUxFKTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuZmlsZVBhdGggPSBwcm9jZXNzLmVudi5BVE9NX0dJVEhVQl9LRVlUQVJfRklMRTtcblxuICAgIGlmICghYXRvbS5pblNwZWNNb2RlKCkpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICdVc2luZyBhIEZpbGVTdHJhdGVneSBzdHJhdGVneSBmb3Igc3RvcmluZyB0b2tlbnMuICcgK1xuICAgICAgICAnVGhlIHRva2VucyB3aWxsIGJlIHN0b3JlZCAlY2luIHRoZSBjbGVhciVjIGluIGEgZmlsZSBhdCAlcy4gJyArXG4gICAgICAgIFwiWW91IHByb2JhYmx5IHNob3VsZG4ndCB1c2UgcmVhbCBjcmVkZW50aWFscyB3aGlsZSB0aGlzIHN0cmF0ZWd5IGlzIGluIHVzZS4gXCIgK1xuICAgICAgICAnVW5zZXQgQVRPTV9HSVRIVUJfS0VZVEFSX0ZJTEVfU1RSQVRFR1kgdG8gZGlzYWJsZSBpdC4nLFxuICAgICAgICAnY29sb3I6IHJlZDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGZvbnQtc3R5bGU6IGl0YWxpYycsXG4gICAgICAgICdjb2xvcjogYmxhY2s7IGZvbnQtd2VpZ2h0OiBub3JtYWw7IGZvbnQtc3R5bGU6IG5vcm1hbCcsXG4gICAgICAgIHRoaXMuZmlsZVBhdGhcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgYXN5bmMgZ2V0UGFzc3dvcmQoc2VydmljZSwgYWNjb3VudCkge1xuICAgIGNvbnN0IHBheWxvYWQgPSBhd2FpdCB0aGlzLmxvYWQoKTtcbiAgICBjb25zdCBmb3JTZXJ2aWNlID0gcGF5bG9hZFtzZXJ2aWNlXTtcbiAgICBpZiAoZm9yU2VydmljZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gVU5BVVRIRU5USUNBVEVEO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd2QgPSBmb3JTZXJ2aWNlW2FjY291bnRdO1xuICAgIGlmIChwYXNzd2QgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmV0dXJuIFVOQVVUSEVOVElDQVRFRDtcbiAgICB9XG4gICAgcmV0dXJuIHBhc3N3ZDtcbiAgfVxuXG4gIHJlcGxhY2VQYXNzd29yZChzZXJ2aWNlLCBhY2NvdW50LCBwYXNzd29yZCkge1xuICAgIHJldHVybiB0aGlzLm1vZGlmeShwYXlsb2FkID0+IHtcbiAgICAgIGxldCBmb3JTZXJ2aWNlID0gcGF5bG9hZFtzZXJ2aWNlXTtcbiAgICAgIGlmIChmb3JTZXJ2aWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZm9yU2VydmljZSA9IHt9O1xuICAgICAgICBwYXlsb2FkW3NlcnZpY2VdID0gZm9yU2VydmljZTtcbiAgICAgIH1cbiAgICAgIGZvclNlcnZpY2VbYWNjb3VudF0gPSBwYXNzd29yZDtcbiAgICB9KTtcbiAgfVxuXG4gIGRlbGV0ZVBhc3N3b3JkKHNlcnZpY2UsIGFjY291bnQpIHtcbiAgICByZXR1cm4gdGhpcy5tb2RpZnkocGF5bG9hZCA9PiB7XG4gICAgICBjb25zdCBmb3JTZXJ2aWNlID0gcGF5bG9hZFtzZXJ2aWNlXTtcbiAgICAgIGlmIChmb3JTZXJ2aWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgZGVsZXRlIGZvclNlcnZpY2VbYWNjb3VudF07XG4gICAgICBpZiAoT2JqZWN0LmtleXMoZm9yU2VydmljZSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIGRlbGV0ZSBwYXlsb2FkW3NlcnZpY2VdO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgbG9hZCgpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgZnMucmVhZEZpbGUodGhpcy5maWxlUGF0aCwgJ3V0ZjgnLCAoZXJyLCBjb250ZW50KSA9PiB7XG4gICAgICAgIGlmIChlcnIgJiYgZXJyLmNvZGUgPT09ICdFTk9FTlQnKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc29sdmUoe30pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgICByZXR1cm4gcmVqZWN0KGVycik7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc29sdmUoSlNPTi5wYXJzZShjb250ZW50KSk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIHNhdmUocGF5bG9hZCkge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBmcy53cml0ZUZpbGUodGhpcy5maWxlUGF0aCwgSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksICd1dGY4JywgZXJyID0+IHtcbiAgICAgICAgaWYgKGVycikge1xuICAgICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBhc3luYyBtb2RpZnkoY2FsbGJhY2spIHtcbiAgICBjb25zdCBwYXlsb2FkID0gYXdhaXQgdGhpcy5sb2FkKCk7XG4gICAgY2FsbGJhY2socGF5bG9hZCk7XG4gICAgYXdhaXQgdGhpcy5zYXZlKHBheWxvYWQpO1xuICB9XG59XG5cbmNvbnN0IHN0cmF0ZWdpZXMgPSBbRmlsZVN0cmF0ZWd5LCBLZXl0YXJTdHJhdGVneSwgU2VjdXJpdHlCaW5hcnlTdHJhdGVneSwgSW5NZW1vcnlTdHJhdGVneV07XG5sZXQgVmFsaWRTdHJhdGVneSA9IG51bGw7XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZVN0cmF0ZWd5KCkge1xuICBpZiAoVmFsaWRTdHJhdGVneSkge1xuICAgIHJldHVybiBuZXcgVmFsaWRTdHJhdGVneSgpO1xuICB9XG5cbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHJhdGVnaWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgY29uc3Qgc3RyYXQgPSBzdHJhdGVnaWVzW2ldO1xuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBzdHJhdC5pc1ZhbGlkKCk7XG4gICAgaWYgKGlzVmFsaWQpIHtcbiAgICAgIFZhbGlkU3RyYXRlZ3kgPSBzdHJhdDtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBpZiAoIVZhbGlkU3RyYXRlZ3kpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vbmUgb2YgdGhlIGxpc3RlZCBrZXl0YXIgc3RyYXRlZ2llcyByZXR1cm5lZCB0cnVlIGZvciBgaXNWYWxpZGAnKTtcbiAgfVxuICByZXR1cm4gbmV3IFZhbGlkU3RyYXRlZ3koKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIFVOQVVUSEVOVElDQVRFRCxcbiAgSU5TVUZGSUNJRU5ULFxuICBVTkFVVEhPUklaRUQsXG4gIEtleXRhclN0cmF0ZWd5LFxuICBTZWN1cml0eUJpbmFyeVN0cmF0ZWd5LFxu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