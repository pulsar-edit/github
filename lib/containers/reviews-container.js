"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _yubikiri = _interopRequireDefault(require("yubikiri"));
var _reactRelay = require("react-relay");
var _helpers = require("../helpers");
var _propTypes2 = require("../prop-types");
var _keytarStrategy = require("../shared/keytar-strategy");
var _prPatchContainer = _interopRequireDefault(require("./pr-patch-container"));
var _observeModel = _interopRequireDefault(require("../views/observe-model"));
var _loadingView = _interopRequireDefault(require("../views/loading-view"));
var _githubLoginView = _interopRequireDefault(require("../views/github-login-view"));
var _errorView = _interopRequireDefault(require("../views/error-view"));
var _queryErrorView = _interopRequireDefault(require("../views/query-error-view"));
var _relayNetworkLayerManager = _interopRequireDefault(require("../relay-network-layer-manager"));
var _relayEnvironment = _interopRequireDefault(require("../views/relay-environment"));
var _reviewsController = _interopRequireDefault(require("../controllers/reviews-controller"));
var _aggregatedReviewsContainer = _interopRequireDefault(require("./aggregated-reviews-container"));
var _commentPositioningContainer = _interopRequireDefault(require("./comment-positioning-container"));
var _graphql;
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class ReviewsContainer extends _react.default.Component {
  constructor(...args) {
    super(...args);
    _defineProperty(this, "renderWithToken", token => {
      if (!token) {
        return _react.default.createElement(_loadingView.default, null);
      }
      if (token instanceof Error) {
        return _react.default.createElement(_queryErrorView.default, {
          error: token,
          retry: this.handleTokenRetry,
          login: this.handleLogin,
          logout: this.handleLogout
        });
      }
      if (token === _keytarStrategy.UNAUTHENTICATED) {
        return _react.default.createElement(_githubLoginView.default, {
          onLogin: this.handleLogin
        });
      }
      if (token === _keytarStrategy.INSUFFICIENT) {
        return _react.default.createElement(_githubLoginView.default, {
          onLogin: this.handleLogin
        }, _react.default.createElement("p", null, "Your token no longer has sufficient authorizations. Please re-authenticate and generate a new one."));
      }
      return _react.default.createElement(_prPatchContainer.default, {
        owner: this.props.owner,
        repo: this.props.repo,
        number: this.props.number,
        endpoint: this.props.endpoint,
        token: token,
        largeDiffThreshold: Infinity
      }, (error, patch) => this.renderWithPatch(error, {
        token,
        patch
      }));
    });
    _defineProperty(this, "fetchToken", loginModel => loginModel.getToken(this.props.endpoint.getLoginAccount()));
    _defineProperty(this, "fetchRepositoryData", repository => {
      return (0, _yubikiri.default)({
        branches: repository.getBranches(),
        remotes: repository.getRemotes(),
        isAbsent: repository.isAbsent(),
        isLoading: repository.isLoading(),
        isPresent: repository.isPresent(),
        isMerging: repository.isMerging(),
        isRebasing: repository.isRebasing()
      });
    });
    _defineProperty(this, "handleLogin", token => this.props.loginModel.setToken(this.props.endpoint.getLoginAccount(), token));
    _defineProperty(this, "handleLogout", () => this.props.loginModel.removeToken(this.props.endpoint.getLoginAccount()));
    _defineProperty(this, "handleTokenRetry", () => this.props.loginModel.didUpdate());
  }
  render() {
    return _react.default.createElement(_observeModel.default, {
      model: this.props.loginModel,
      fetchData: this.fetchToken
    }, this.renderWithToken);
  }
  renderWithPatch(error, {
    token,
    patch
  }) {
    if (error) {
      return _react.default.createElement(_errorView.default, {
        descriptions: [error]
      });
    }
    return _react.default.createElement(_observeModel.default, {
      model: this.props.repository,
      fetchData: this.fetchRepositoryData
    }, repoData => this.renderWithRepositoryData(repoData, {
      token,
      patch
    }));
  }
  renderWithRepositoryData(repoData, {
    token,
    patch
  }) {
    const environment = _relayNetworkLayerManager.default.getEnvironmentForHost(this.props.endpoint, token);
    const query = _graphql || (_graphql = function () {
      const node = require("./__generated__/reviewsContainerQuery.graphql");
      if (node.hash && node.hash !== "b05cc30cb078003afba9bd8c2de989fa") {
        console.error("The definition of 'reviewsContainerQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
      }
      return require("./__generated__/reviewsContainerQuery.graphql");
    });
    const variables = {
      repoOwner: this.props.owner,
      repoName: this.props.repo,
      prNumber: this.props.number,
      reviewCount: _helpers.PAGE_SIZE,
      reviewCursor: null,
      threadCount: _helpers.PAGE_SIZE,
      threadCursor: null,
      commentCount: _helpers.PAGE_SIZE,
      commentCursor: null
    };
    return _react.default.createElement(_relayEnvironment.default.Provider, {
      value: environment
    }, _react.default.createElement(_reactRelay.QueryRenderer, {
      environment: environment,
      query: query,
      variables: variables,
      render: queryResult => this.renderWithQuery(queryResult, {
        repoData,
        patch
      })
    }));
  }
  renderWithQuery({
    error,
    props,
    retry
  }, {
    repoData,
    patch
  }) {
    if (error) {
      return _react.default.createElement(_queryErrorView.default, {
        error: error,
        login: this.handleLogin,
        retry: retry,
        logout: this.handleLogout
      });
    }
    if (!props || !repoData || !patch) {
      return _react.default.createElement(_loadingView.default, null);
    }
    return _react.default.createElement(_aggregatedReviewsContainer.default, {
      pullRequest: props.repository.pullRequest,
      reportRelayError: this.props.reportRelayError
    }, ({
      errors,
      summaries,
      commentThreads,
      refetch
    }) => {
      if (errors && errors.length > 0) {
        return errors.map((err, i) => _react.default.createElement(_errorView.default, {
          key: `error-${i}`,
          title: "Pagination error",
          descriptions: [err.stack]
        }));
      }
      const aggregationResult = {
        summaries,
        commentThreads,
        refetch
      };
      return this.renderWithResult({
        aggregationResult,
        queryProps: props,
        repoData,
        patch,
        refetch
      });
    });
  }
  renderWithResult({
    aggregationResult,
    queryProps,
    repoData,
    patch
  }) {
    return _react.default.createElement(_commentPositioningContainer.default, _extends({
      multiFilePatch: patch
    }, aggregationResult, {
      prCommitSha: queryProps.repository.pullRequest.headRefOid,
      localRepository: this.props.repository
    }), commentTranslations => {
      return _react.default.createElement(_reviewsController.default, _extends({}, this.props, aggregationResult, {
        commentTranslations: commentTranslations,
        localRepository: this.props.repository,
        multiFilePatch: patch,
        repository: queryProps.repository,
        pullRequest: queryProps.repository.pullRequest,
        viewer: queryProps.viewer
      }, repoData));
    });
  }
}
exports.default = ReviewsContainer;
_defineProperty(ReviewsContainer, "propTypes", {
  // Connection
  endpoint: _propTypes2.EndpointPropType.isRequired,
  // Pull request selection criteria
  owner: _propTypes.default.string.isRequired,
  repo: _propTypes.default.string.isRequired,
  number: _propTypes.default.number.isRequired,
  workdir: _propTypes.default.string.isRequired,
  // Package models
  repository: _propTypes.default.object.isRequired,
  loginModel: _propTypes2.GithubLoginModelPropType.isRequired,
  workdirContextPool: _propTypes2.WorkdirContextPoolPropType.isRequired,
  initThreadID: _propTypes.default.string,
  // Atom environment
  workspace: _propTypes.default.object.isRequired,
  config: _propTypes.default.object.isRequired,
  commands: _propTypes.default.object.isRequired,
  tooltips: _propTypes.default.object.isRequired,
  confirm: _propTypes.default.func.isRequired,
  // Action methods
  reportRelayError: _propTypes.default.func.isRequired
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfeXViaWtpcmkiLCJfcmVhY3RSZWxheSIsIl9oZWxwZXJzIiwiX3Byb3BUeXBlczIiLCJfa2V5dGFyU3RyYXRlZ3kiLCJfcHJQYXRjaENvbnRhaW5lciIsIl9vYnNlcnZlTW9kZWwiLCJfbG9hZGluZ1ZpZXciLCJfZ2l0aHViTG9naW5WaWV3IiwiX2Vycm9yVmlldyIsIl9xdWVyeUVycm9yVmlldyIsIl9yZWxheU5ldHdvcmtMYXllck1hbmFnZXIiLCJfcmVsYXlFbnZpcm9ubWVudCIsIl9yZXZpZXdzQ29udHJvbGxlciIsIl9hZ2dyZWdhdGVkUmV2aWV3c0NvbnRhaW5lciIsIl9jb21tZW50UG9zaXRpb25pbmdDb250YWluZXIiLCJfZ3JhcGhxbCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJiaW5kIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImFwcGx5IiwiX2RlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfdG9Qcm9wZXJ0eUtleSIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiYXJnIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiaW5wdXQiLCJoaW50IiwicHJpbSIsIlN5bWJvbCIsInRvUHJpbWl0aXZlIiwidW5kZWZpbmVkIiwicmVzIiwiVHlwZUVycm9yIiwiTnVtYmVyIiwiUmV2aWV3c0NvbnRhaW5lciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJhcmdzIiwidG9rZW4iLCJjcmVhdGVFbGVtZW50IiwiRXJyb3IiLCJlcnJvciIsInJldHJ5IiwiaGFuZGxlVG9rZW5SZXRyeSIsImxvZ2luIiwiaGFuZGxlTG9naW4iLCJsb2dvdXQiLCJoYW5kbGVMb2dvdXQiLCJVTkFVVEhFTlRJQ0FURUQiLCJvbkxvZ2luIiwiSU5TVUZGSUNJRU5UIiwib3duZXIiLCJwcm9wcyIsInJlcG8iLCJudW1iZXIiLCJlbmRwb2ludCIsImxhcmdlRGlmZlRocmVzaG9sZCIsIkluZmluaXR5IiwicGF0Y2giLCJyZW5kZXJXaXRoUGF0Y2giLCJsb2dpbk1vZGVsIiwiZ2V0VG9rZW4iLCJnZXRMb2dpbkFjY291bnQiLCJyZXBvc2l0b3J5IiwieXViaWtpcmkiLCJicmFuY2hlcyIsImdldEJyYW5jaGVzIiwicmVtb3RlcyIsImdldFJlbW90ZXMiLCJpc0Fic2VudCIsImlzTG9hZGluZyIsImlzUHJlc2VudCIsImlzTWVyZ2luZyIsImlzUmViYXNpbmciLCJzZXRUb2tlbiIsInJlbW92ZVRva2VuIiwiZGlkVXBkYXRlIiwicmVuZGVyIiwibW9kZWwiLCJmZXRjaERhdGEiLCJmZXRjaFRva2VuIiwicmVuZGVyV2l0aFRva2VuIiwiZGVzY3JpcHRpb25zIiwiZmV0Y2hSZXBvc2l0b3J5RGF0YSIsInJlcG9EYXRhIiwicmVuZGVyV2l0aFJlcG9zaXRvcnlEYXRhIiwiZW52aXJvbm1lbnQiLCJSZWxheU5ldHdvcmtMYXllck1hbmFnZXIiLCJnZXRFbnZpcm9ubWVudEZvckhvc3QiLCJxdWVyeSIsIm5vZGUiLCJoYXNoIiwiY29uc29sZSIsInZhcmlhYmxlcyIsInJlcG9Pd25lciIsInJlcG9OYW1lIiwicHJOdW1iZXIiLCJyZXZpZXdDb3VudCIsIlBBR0VfU0laRSIsInJldmlld0N1cnNvciIsInRocmVhZENvdW50IiwidGhyZWFkQ3Vyc29yIiwiY29tbWVudENvdW50IiwiY29tbWVudEN1cnNvciIsIlByb3ZpZGVyIiwiUXVlcnlSZW5kZXJlciIsInF1ZXJ5UmVzdWx0IiwicmVuZGVyV2l0aFF1ZXJ5IiwicHVsbFJlcXVlc3QiLCJyZXBvcnRSZWxheUVycm9yIiwiZXJyb3JzIiwic3VtbWFyaWVzIiwiY29tbWVudFRocmVhZHMiLCJyZWZldGNoIiwibWFwIiwiZXJyIiwidGl0bGUiLCJzdGFjayIsImFnZ3JlZ2F0aW9uUmVzdWx0IiwicmVuZGVyV2l0aFJlc3VsdCIsInF1ZXJ5UHJvcHMiLCJtdWx0aUZpbGVQYXRjaCIsInByQ29tbWl0U2hhIiwiaGVhZFJlZk9pZCIsImxvY2FsUmVwb3NpdG9yeSIsImNvbW1lbnRUcmFuc2xhdGlvbnMiLCJ2aWV3ZXIiLCJleHBvcnRzIiwiRW5kcG9pbnRQcm9wVHlwZSIsImlzUmVxdWlyZWQiLCJQcm9wVHlwZXMiLCJzdHJpbmciLCJ3b3JrZGlyIiwib2JqZWN0IiwiR2l0aHViTG9naW5Nb2RlbFByb3BUeXBlIiwid29ya2RpckNvbnRleHRQb29sIiwiV29ya2RpckNvbnRleHRQb29sUHJvcFR5cGUiLCJpbml0VGhyZWFkSUQiLCJ3b3Jrc3BhY2UiLCJjb25maWciLCJjb21tYW5kcyIsInRvb2x0aXBzIiwiY29uZmlybSIsImZ1bmMiXSwic291cmNlcyI6WyJyZXZpZXdzLWNvbnRhaW5lci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB5dWJpa2lyaSBmcm9tICd5dWJpa2lyaSc7XG5pbXBvcnQge1F1ZXJ5UmVuZGVyZXIsIGdyYXBocWx9IGZyb20gJ3JlYWN0LXJlbGF5JztcblxuaW1wb3J0IHtQQUdFX1NJWkV9IGZyb20gJy4uL2hlbHBlcnMnO1xuaW1wb3J0IHtHaXRodWJMb2dpbk1vZGVsUHJvcFR5cGUsIEVuZHBvaW50UHJvcFR5cGUsIFdvcmtkaXJDb250ZXh0UG9vbFByb3BUeXBlfSBmcm9tICcuLi9wcm9wLXR5cGVzJztcbmltcG9ydCB7VU5BVVRIRU5USUNBVEVELCBJTlNVRkZJQ0lFTlR9IGZyb20gJy4uL3NoYXJlZC9rZXl0YXItc3RyYXRlZ3knO1xuaW1wb3J0IFB1bGxSZXF1ZXN0UGF0Y2hDb250YWluZXIgZnJvbSAnLi9wci1wYXRjaC1jb250YWluZXInO1xuaW1wb3J0IE9ic2VydmVNb2RlbCBmcm9tICcuLi92aWV3cy9vYnNlcnZlLW1vZGVsJztcbmltcG9ydCBMb2FkaW5nVmlldyBmcm9tICcuLi92aWV3cy9sb2FkaW5nLXZpZXcnO1xuaW1wb3J0IEdpdGh1YkxvZ2luVmlldyBmcm9tICcuLi92aWV3cy9naXRodWItbG9naW4tdmlldyc7XG5pbXBvcnQgRXJyb3JWaWV3IGZyb20gJy4uL3ZpZXdzL2Vycm9yLXZpZXcnO1xuaW1wb3J0IFF1ZXJ5RXJyb3JWaWV3IGZyb20gJy4uL3ZpZXdzL3F1ZXJ5LWVycm9yLXZpZXcnO1xuaW1wb3J0IFJlbGF5TmV0d29ya0xheWVyTWFuYWdlciBmcm9tICcuLi9yZWxheS1uZXR3b3JrLWxheWVyLW1hbmFnZXInO1xuaW1wb3J0IFJlbGF5RW52aXJvbm1lbnQgZnJvbSAnLi4vdmlld3MvcmVsYXktZW52aXJvbm1lbnQnO1xuaW1wb3J0IFJldmlld3NDb250cm9sbGVyIGZyb20gJy4uL2NvbnRyb2xsZXJzL3Jldmlld3MtY29udHJvbGxlcic7XG5pbXBvcnQgQWdncmVnYXRlZFJldmlld3NDb250YWluZXIgZnJvbSAnLi9hZ2dyZWdhdGVkLXJldmlld3MtY29udGFpbmVyJztcbmltcG9ydCBDb21tZW50UG9zaXRpb25pbmdDb250YWluZXIgZnJvbSAnLi9jb21tZW50LXBvc2l0aW9uaW5nLWNvbnRhaW5lcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJldmlld3NDb250YWluZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8vIENvbm5lY3Rpb25cbiAgICBlbmRwb2ludDogRW5kcG9pbnRQcm9wVHlwZS5pc1JlcXVpcmVkLFxuXG4gICAgLy8gUHVsbCByZXF1ZXN0IHNlbGVjdGlvbiBjcml0ZXJpYVxuICAgIG93bmVyOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgcmVwbzogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIG51bWJlcjogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICAgIHdvcmtkaXI6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblxuICAgIC8vIFBhY2thZ2UgbW9kZWxzXG4gICAgcmVwb3NpdG9yeTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGxvZ2luTW9kZWw6IEdpdGh1YkxvZ2luTW9kZWxQcm9wVHlwZS5pc1JlcXVpcmVkLFxuICAgIHdvcmtkaXJDb250ZXh0UG9vbDogV29ya2RpckNvbnRleHRQb29sUHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBpbml0VGhyZWFkSUQ6IFByb3BUeXBlcy5zdHJpbmcsXG5cbiAgICAvLyBBdG9tIGVudmlyb25tZW50XG4gICAgd29ya3NwYWNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgY29uZmlnOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgY29tbWFuZHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICB0b29sdGlwczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGNvbmZpcm06IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG5cbiAgICAvLyBBY3Rpb24gbWV0aG9kc1xuICAgIHJlcG9ydFJlbGF5RXJyb3I6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxPYnNlcnZlTW9kZWwgbW9kZWw9e3RoaXMucHJvcHMubG9naW5Nb2RlbH0gZmV0Y2hEYXRhPXt0aGlzLmZldGNoVG9rZW59PlxuICAgICAgICB7dGhpcy5yZW5kZXJXaXRoVG9rZW59XG4gICAgICA8L09ic2VydmVNb2RlbD5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyV2l0aFRva2VuID0gdG9rZW4gPT4ge1xuICAgIGlmICghdG9rZW4pIHtcbiAgICAgIHJldHVybiA8TG9hZGluZ1ZpZXcgLz47XG4gICAgfVxuXG4gICAgaWYgKHRva2VuIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxRdWVyeUVycm9yVmlld1xuICAgICAgICAgIGVycm9yPXt0b2tlbn1cbiAgICAgICAgICByZXRyeT17dGhpcy5oYW5kbGVUb2tlblJldHJ5fVxuICAgICAgICAgIGxvZ2luPXt0aGlzLmhhbmRsZUxvZ2lufVxuICAgICAgICAgIGxvZ291dD17dGhpcy5oYW5kbGVMb2dvdXR9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICh0b2tlbiA9PT0gVU5BVVRIRU5USUNBVEVEKSB7XG4gICAgICByZXR1cm4gPEdpdGh1YkxvZ2luVmlldyBvbkxvZ2luPXt0aGlzLmhhbmRsZUxvZ2lufSAvPjtcbiAgICB9XG5cbiAgICBpZiAodG9rZW4gPT09IElOU1VGRklDSUVOVCkge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPEdpdGh1YkxvZ2luVmlldyBvbkxvZ2luPXt0aGlzLmhhbmRsZUxvZ2lufT5cbiAgICAgICAgICA8cD5cbiAgICAgICAgICAgIFlvdXIgdG9rZW4gbm8gbG9uZ2VyIGhhcyBzdWZmaWNpZW50IGF1dGhvcml6YXRpb25zLiBQbGVhc2UgcmUtYXV0aGVudGljYXRlIGFuZCBnZW5lcmF0ZSBhIG5ldyBvbmUuXG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L0dpdGh1YkxvZ2luVmlldz5cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxQdWxsUmVxdWVzdFBhdGNoQ29udGFpbmVyXG4gICAgICAgIG93bmVyPXt0aGlzLnByb3BzLm93bmVyfVxuICAgICAgICByZXBvPXt0aGlzLnByb3BzLnJlcG99XG4gICAgICAgIG51bWJlcj17dGhpcy5wcm9wcy5udW1iZXJ9XG4gICAgICAgIGVuZHBvaW50PXt0aGlzLnByb3BzLmVuZHBvaW50fVxuICAgICAgICB0b2tlbj17dG9rZW59XG4gICAgICAgIGxhcmdlRGlmZlRocmVzaG9sZD17SW5maW5pdHl9PlxuICAgICAgICB7KGVycm9yLCBwYXRjaCkgPT4gdGhpcy5yZW5kZXJXaXRoUGF0Y2goZXJyb3IsIHt0b2tlbiwgcGF0Y2h9KX1cbiAgICAgIDwvUHVsbFJlcXVlc3RQYXRjaENvbnRhaW5lcj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyV2l0aFBhdGNoKGVycm9yLCB7dG9rZW4sIHBhdGNofSkge1xuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIDxFcnJvclZpZXcgZGVzY3JpcHRpb25zPXtbZXJyb3JdfSAvPjtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPE9ic2VydmVNb2RlbCBtb2RlbD17dGhpcy5wcm9wcy5yZXBvc2l0b3J5fSBmZXRjaERhdGE9e3RoaXMuZmV0Y2hSZXBvc2l0b3J5RGF0YX0+XG4gICAgICAgIHtyZXBvRGF0YSA9PiB0aGlzLnJlbmRlcldpdGhSZXBvc2l0b3J5RGF0YShyZXBvRGF0YSwge3Rva2VuLCBwYXRjaH0pfVxuICAgICAgPC9PYnNlcnZlTW9kZWw+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcldpdGhSZXBvc2l0b3J5RGF0YShyZXBvRGF0YSwge3Rva2VuLCBwYXRjaH0pIHtcbiAgICBjb25zdCBlbnZpcm9ubWVudCA9IFJlbGF5TmV0d29ya0xheWVyTWFuYWdlci5nZXRFbnZpcm9ubWVudEZvckhvc3QodGhpcy5wcm9wcy5lbmRwb2ludCwgdG9rZW4pO1xuICAgIGNvbnN0IHF1ZXJ5ID0gZ3JhcGhxbGBcbiAgICAgIHF1ZXJ5IHJldmlld3NDb250YWluZXJRdWVyeVxuICAgICAgKFxuICAgICAgICAkcmVwb093bmVyOiBTdHJpbmchXG4gICAgICAgICRyZXBvTmFtZTogU3RyaW5nIVxuICAgICAgICAkcHJOdW1iZXI6IEludCFcbiAgICAgICAgJHJldmlld0NvdW50OiBJbnQhXG4gICAgICAgICRyZXZpZXdDdXJzb3I6IFN0cmluZ1xuICAgICAgICAkdGhyZWFkQ291bnQ6IEludCFcbiAgICAgICAgJHRocmVhZEN1cnNvcjogU3RyaW5nXG4gICAgICAgICRjb21tZW50Q291bnQ6IEludCFcbiAgICAgICAgJGNvbW1lbnRDdXJzb3I6IFN0cmluZ1xuICAgICAgKSB7XG4gICAgICAgIHJlcG9zaXRvcnkob3duZXI6ICRyZXBvT3duZXIsIG5hbWU6ICRyZXBvTmFtZSkge1xuICAgICAgICAgIC4uLnJldmlld3NDb250cm9sbGVyX3JlcG9zaXRvcnlcbiAgICAgICAgICBwdWxsUmVxdWVzdChudW1iZXI6ICRwck51bWJlcikge1xuICAgICAgICAgICAgaGVhZFJlZk9pZFxuICAgICAgICAgICAgLi4uYWdncmVnYXRlZFJldmlld3NDb250YWluZXJfcHVsbFJlcXVlc3QgQGFyZ3VtZW50cyhcbiAgICAgICAgICAgICAgcmV2aWV3Q291bnQ6ICRyZXZpZXdDb3VudFxuICAgICAgICAgICAgICByZXZpZXdDdXJzb3I6ICRyZXZpZXdDdXJzb3JcbiAgICAgICAgICAgICAgdGhyZWFkQ291bnQ6ICR0aHJlYWRDb3VudFxuICAgICAgICAgICAgICB0aHJlYWRDdXJzb3I6ICR0aHJlYWRDdXJzb3JcbiAgICAgICAgICAgICAgY29tbWVudENvdW50OiAkY29tbWVudENvdW50XG4gICAgICAgICAgICAgIGNvbW1lbnRDdXJzb3I6ICRjb21tZW50Q3Vyc29yXG4gICAgICAgICAgICApXG4gICAgICAgICAgICAuLi5yZXZpZXdzQ29udHJvbGxlcl9wdWxsUmVxdWVzdFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHZpZXdlciB7XG4gICAgICAgICAgLi4ucmV2aWV3c0NvbnRyb2xsZXJfdmlld2VyXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgO1xuICAgIGNvbnN0IHZhcmlhYmxlcyA9IHtcbiAgICAgIHJlcG9Pd25lcjogdGhpcy5wcm9wcy5vd25lcixcbiAgICAgIHJlcG9OYW1lOiB0aGlzLnByb3BzLnJlcG8sXG4gICAgICBwck51bWJlcjogdGhpcy5wcm9wcy5udW1iZXIsXG4gICAgICByZXZpZXdDb3VudDogUEFHRV9TSVpFLFxuICAgICAgcmV2aWV3Q3Vyc29yOiBudWxsLFxuICAgICAgdGhyZWFkQ291bnQ6IFBBR0VfU0laRSxcbiAgICAgIHRocmVhZEN1cnNvcjogbnVsbCxcbiAgICAgIGNvbW1lbnRDb3VudDogUEFHRV9TSVpFLFxuICAgICAgY29tbWVudEN1cnNvcjogbnVsbCxcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxSZWxheUVudmlyb25tZW50LlByb3ZpZGVyIHZhbHVlPXtlbnZpcm9ubWVudH0+XG4gICAgICAgIDxRdWVyeVJlbmRlcmVyXG4gICAgICAgICAgZW52aXJvbm1lbnQ9e2Vudmlyb25tZW50fVxuICAgICAgICAgIHF1ZXJ5PXtxdWVyeX1cbiAgICAgICAgICB2YXJpYWJsZXM9e3ZhcmlhYmxlc31cbiAgICAgICAgICByZW5kZXI9e3F1ZXJ5UmVzdWx0ID0+IHRoaXMucmVuZGVyV2l0aFF1ZXJ5KHF1ZXJ5UmVzdWx0LCB7cmVwb0RhdGEsIHBhdGNofSl9XG4gICAgICAgIC8+XG4gICAgICA8L1JlbGF5RW52aXJvbm1lbnQuUHJvdmlkZXI+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcldpdGhRdWVyeSh7ZXJyb3IsIHByb3BzLCByZXRyeX0sIHtyZXBvRGF0YSwgcGF0Y2h9KSB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICA8UXVlcnlFcnJvclZpZXdcbiAgICAgICAgICBlcnJvcj17ZXJyb3J9XG4gICAgICAgICAgbG9naW49e3RoaXMuaGFuZGxlTG9naW59XG4gICAgICAgICAgcmV0cnk9e3JldHJ5fVxuICAgICAgICAgIGxvZ291dD17dGhpcy5oYW5kbGVMb2dvdXR9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghcHJvcHMgfHwgIXJlcG9EYXRhIHx8ICFwYXRjaCkge1xuICAgICAgcmV0dXJuIDxMb2FkaW5nVmlldyAvPjtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPEFnZ3JlZ2F0ZWRSZXZpZXdzQ29udGFpbmVyXG4gICAgICAgIHB1bGxSZXF1ZXN0PXtwcm9wcy5yZXBvc2l0b3J5LnB1bGxSZXF1ZXN0fVxuICAgICAgICByZXBvcnRSZWxheUVycm9yPXt0aGlzLnByb3BzLnJlcG9ydFJlbGF5RXJyb3J9PlxuICAgICAgICB7KHtlcnJvcnMsIHN1bW1hcmllcywgY29tbWVudFRocmVhZHMsIHJlZmV0Y2h9KSA9PiB7XG4gICAgICAgICAgaWYgKGVycm9ycyAmJiBlcnJvcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgcmV0dXJuIGVycm9ycy5tYXAoKGVyciwgaSkgPT4gKFxuICAgICAgICAgICAgICA8RXJyb3JWaWV3XG4gICAgICAgICAgICAgICAga2V5PXtgZXJyb3ItJHtpfWB9XG4gICAgICAgICAgICAgICAgdGl0bGU9XCJQYWdpbmF0aW9uIGVycm9yXCJcbiAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbnM9e1tlcnIuc3RhY2tdfVxuICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgKSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IGFnZ3JlZ2F0aW9uUmVzdWx0ID0ge3N1bW1hcmllcywgY29tbWVudFRocmVhZHMsIHJlZmV0Y2h9O1xuXG4gICAgICAgICAgcmV0dXJuIHRoaXMucmVuZGVyV2l0aFJlc3VsdCh7XG4gICAgICAgICAgICBhZ2dyZWdhdGlvblJlc3VsdCxcbiAgICAgICAgICAgIHF1ZXJ5UHJvcHM6IHByb3BzLFxuICAgICAgICAgICAgcmVwb0RhdGEsXG4gICAgICAgICAgICBwYXRjaCxcbiAgICAgICAgICAgIHJlZmV0Y2gsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH19XG4gICAgICA8L0FnZ3JlZ2F0ZWRSZXZpZXdzQ29udGFpbmVyPlxuICAgICk7XG4gIH1cblxuICByZW5kZXJXaXRoUmVzdWx0KHthZ2dyZWdhdGlvblJlc3VsdCwgcXVlcnlQcm9wcywgcmVwb0RhdGEsIHBhdGNofSkge1xuICAgIHJldHVybiAoXG4gICAgICA8Q29tbWVudFBvc2l0aW9uaW5nQ29udGFpbmVyXG4gICAgICAgIG11bHRpRmlsZVBhdGNoPXtwYXRjaH1cbiAgICAgICAgey4uLmFnZ3JlZ2F0aW9uUmVzdWx0fVxuICAgICAgICBwckNvbW1pdFNoYT17cXVlcnlQcm9wcy5yZXBvc2l0b3J5LnB1bGxSZXF1ZXN0LmhlYWRSZWZPaWR9XG4gICAgICAgIGxvY2FsUmVwb3NpdG9yeT17dGhpcy5wcm9wcy5yZXBvc2l0b3J5fT5cbiAgICAgICAge2NvbW1lbnRUcmFuc2xhdGlvbnMgPT4ge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8UmV2aWV3c0NvbnRyb2xsZXJcbiAgICAgICAgICAgICAgey4uLnRoaXMucHJvcHN9XG4gICAgICAgICAgICAgIHsuLi5hZ2dyZWdhdGlvblJlc3VsdH1cbiAgICAgICAgICAgICAgY29tbWVudFRyYW5zbGF0aW9ucz17Y29tbWVudFRyYW5zbGF0aW9uc31cbiAgICAgICAgICAgICAgbG9jYWxSZXBvc2l0b3J5PXt0aGlzLnByb3BzLnJlcG9zaXRvcnl9XG4gICAgICAgICAgICAgIG11bHRpRmlsZVBhdGNoPXtwYXRjaH1cbiAgICAgICAgICAgICAgcmVwb3NpdG9yeT17cXVlcnlQcm9wcy5yZXBvc2l0b3J5fVxuICAgICAgICAgICAgICBwdWxsUmVxdWVzdD17cXVlcnlQcm9wcy5yZXBvc2l0b3J5LnB1bGxSZXF1ZXN0fVxuICAgICAgICAgICAgICB2aWV3ZXI9e3F1ZXJ5UHJvcHMudmlld2VyfVxuICAgICAgICAgICAgICB7Li4ucmVwb0RhdGF9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICk7XG4gICAgICAgIH19XG4gICAgICA8L0NvbW1lbnRQb3NpdGlvbmluZ0NvbnRhaW5lcj5cbiAgICApO1xuICB9XG5cbiAgZmV0Y2hUb2tlbiA9IGxvZ2luTW9kZWwgPT4gbG9naW5Nb2RlbC5nZXRUb2tlbih0aGlzLnByb3BzLmVuZHBvaW50LmdldExvZ2luQWNjb3VudCgpKTtcblxuICBmZXRjaFJlcG9zaXRvcnlEYXRhID0gcmVwb3NpdG9yeSA9PiB7XG4gICAgcmV0dXJuIHl1YmlraXJpKHtcbiAgICAgIGJyYW5jaGVzOiByZXBvc2l0b3J5LmdldEJyYW5jaGVzKCksXG4gICAgICByZW1vdGVzOiByZXBvc2l0b3J5LmdldFJlbW90ZXMoKSxcbiAgICAgIGlzQWJzZW50OiByZXBvc2l0b3J5LmlzQWJzZW50KCksXG4gICAgICBpc0xvYWRpbmc6IHJlcG9zaXRvcnkuaXNMb2FkaW5nKCksXG4gICAgICBpc1ByZXNlbnQ6IHJlcG9zaXRvcnkuaXNQcmVzZW50KCksXG4gICAgICBpc01lcmdpbmc6IHJlcG9zaXRvcnkuaXNNZXJnaW5nKCksXG4gICAgICBpc1JlYmFzaW5nOiByZXBvc2l0b3J5LmlzUmViYXNpbmcoKSxcbiAgICB9KTtcbiAgfVxuXG4gIGhhbmRsZUxvZ2luID0gdG9rZW4gPT4gdGhpcy5wcm9wcy5sb2dpbk1vZGVsLnNldFRva2VuKHRoaXMucHJvcHMuZW5kcG9pbnQuZ2V0TG9naW5BY2NvdW50KCksIHRva2VuKTtcblxuICBoYW5kbGVMb2dvdXQgPSAoKSA9PiB0aGlzLnByb3BzLmxvZ2luTW9kZWwucmVtb3ZlVG9rZW4odGhpcy5wcm9wcy5lbmRwb2ludC5nZXRMb2dpbkFjY291bnQoKSk7XG5cbiAgaGFuZGxlVG9rZW5SZXRyeSA9ICgpID0+IHRoaXMucHJvcHMubG9naW5Nb2RlbC5kaWRVcGRhdGUoKTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsV0FBQSxHQUFBSCxPQUFBO0FBRUEsSUFBQUksUUFBQSxHQUFBSixPQUFBO0FBQ0EsSUFBQUssV0FBQSxHQUFBTCxPQUFBO0FBQ0EsSUFBQU0sZUFBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8saUJBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtB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