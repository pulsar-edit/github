"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _yubikiri = _interopRequireDefault(require("yubikiri"));
var _commit = require("../models/commit");
var _branch = require("../models/branch");
var _observeModel = _interopRequireDefault(require("../views/observe-model"));
var _gitTabController = _interopRequireDefault(require("../controllers/git-tab-controller"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
const DEFAULT_REPO_DATA = {
  repository: null,
  username: '',
  email: '',
  lastCommit: _commit.nullCommit,
  recentCommits: [],
  isMerging: false,
  isRebasing: false,
  hasUndoHistory: false,
  currentBranch: _branch.nullBranch,
  unstagedChanges: [],
  stagedChanges: [],
  mergeConflicts: [],
  workingDirectoryPath: null,
  mergeMessage: null,
  fetchInProgress: true
};
class GitTabContainer extends _react.default.Component {
  constructor(...args) {
    super(...args);
    _defineProperty(this, "fetchData", repository => {
      return (0, _yubikiri.default)({
        repository,
        username: repository.getConfig('user.name').then(n => n || ''),
        email: repository.getConfig('user.email').then(n => n || ''),
        lastCommit: repository.getLastCommit(),
        recentCommits: repository.getRecentCommits({
          max: 10
        }),
        isMerging: repository.isMerging(),
        isRebasing: repository.isRebasing(),
        hasUndoHistory: repository.hasDiscardHistory(),
        currentBranch: repository.getCurrentBranch(),
        unstagedChanges: repository.getUnstagedChanges(),
        stagedChanges: repository.getStagedChanges(),
        mergeConflicts: repository.getMergeConflicts(),
        workingDirectoryPath: repository.getWorkingDirectoryPath(),
        mergeMessage: async query => {
          const isMerging = await query.isMerging;
          return isMerging ? repository.getMergeMessage() : null;
        },
        fetchInProgress: false
      });
    });
  }
  render() {
    return _react.default.createElement(_observeModel.default, {
      model: this.props.repository,
      fetchData: this.fetchData
    }, data => {
      const dataProps = data || DEFAULT_REPO_DATA;
      return _react.default.createElement(_gitTabController.default, _extends({}, dataProps, this.props, {
        repositoryDrift: this.props.repository !== dataProps.repository
      }));
    });
  }
}
exports.default = GitTabContainer;
_defineProperty(GitTabContainer, "propTypes", {
  repository: _propTypes.default.object.isRequired
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfeXViaWtpcmkiLCJfY29tbWl0IiwiX2JyYW5jaCIsIl9vYnNlcnZlTW9kZWwiLCJfZ2l0VGFiQ29udHJvbGxlciIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJiaW5kIiwidGFyZ2V0IiwiaSIsImFyZ3VtZW50cyIsImxlbmd0aCIsInNvdXJjZSIsImtleSIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImFwcGx5IiwiX2RlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfdG9Qcm9wZXJ0eUtleSIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwidCIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsInIiLCJlIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJERUZBVUxUX1JFUE9fREFUQSIsInJlcG9zaXRvcnkiLCJ1c2VybmFtZSIsImVtYWlsIiwibGFzdENvbW1pdCIsIm51bGxDb21taXQiLCJyZWNlbnRDb21taXRzIiwiaXNNZXJnaW5nIiwiaXNSZWJhc2luZyIsImhhc1VuZG9IaXN0b3J5IiwiY3VycmVudEJyYW5jaCIsIm51bGxCcmFuY2giLCJ1bnN0YWdlZENoYW5nZXMiLCJzdGFnZWRDaGFuZ2VzIiwibWVyZ2VDb25mbGljdHMiLCJ3b3JraW5nRGlyZWN0b3J5UGF0aCIsIm1lcmdlTWVzc2FnZSIsImZldGNoSW5Qcm9ncmVzcyIsIkdpdFRhYkNvbnRhaW5lciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJhcmdzIiwieXViaWtpcmkiLCJnZXRDb25maWciLCJ0aGVuIiwibiIsImdldExhc3RDb21taXQiLCJnZXRSZWNlbnRDb21taXRzIiwibWF4IiwiaGFzRGlzY2FyZEhpc3RvcnkiLCJnZXRDdXJyZW50QnJhbmNoIiwiZ2V0VW5zdGFnZWRDaGFuZ2VzIiwiZ2V0U3RhZ2VkQ2hhbmdlcyIsImdldE1lcmdlQ29uZmxpY3RzIiwiZ2V0V29ya2luZ0RpcmVjdG9yeVBhdGgiLCJxdWVyeSIsImdldE1lcmdlTWVzc2FnZSIsInJlbmRlciIsImNyZWF0ZUVsZW1lbnQiLCJtb2RlbCIsInByb3BzIiwiZmV0Y2hEYXRhIiwiZGF0YSIsImRhdGFQcm9wcyIsInJlcG9zaXRvcnlEcmlmdCIsImV4cG9ydHMiLCJQcm9wVHlwZXMiLCJvYmplY3QiLCJpc1JlcXVpcmVkIl0sInNvdXJjZXMiOlsiZ2l0LXRhYi1jb250YWluZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeXViaWtpcmkgZnJvbSAneXViaWtpcmknO1xuXG5pbXBvcnQge251bGxDb21taXR9IGZyb20gJy4uL21vZGVscy9jb21taXQnO1xuaW1wb3J0IHtudWxsQnJhbmNofSBmcm9tICcuLi9tb2RlbHMvYnJhbmNoJztcbmltcG9ydCBPYnNlcnZlTW9kZWwgZnJvbSAnLi4vdmlld3Mvb2JzZXJ2ZS1tb2RlbCc7XG5pbXBvcnQgR2l0VGFiQ29udHJvbGxlciBmcm9tICcuLi9jb250cm9sbGVycy9naXQtdGFiLWNvbnRyb2xsZXInO1xuXG5jb25zdCBERUZBVUxUX1JFUE9fREFUQSA9IHtcbiAgcmVwb3NpdG9yeTogbnVsbCxcbiAgdXNlcm5hbWU6ICcnLFxuICBlbWFpbDogJycsXG4gIGxhc3RDb21taXQ6IG51bGxDb21taXQsXG4gIHJlY2VudENvbW1pdHM6IFtdLFxuICBpc01lcmdpbmc6IGZhbHNlLFxuICBpc1JlYmFzaW5nOiBmYWxzZSxcbiAgaGFzVW5kb0hpc3Rvcnk6IGZhbHNlLFxuICBjdXJyZW50QnJhbmNoOiBudWxsQnJhbmNoLFxuICB1bnN0YWdlZENoYW5nZXM6IFtdLFxuICBzdGFnZWRDaGFuZ2VzOiBbXSxcbiAgbWVyZ2VDb25mbGljdHM6IFtdLFxuICB3b3JraW5nRGlyZWN0b3J5UGF0aDogbnVsbCxcbiAgbWVyZ2VNZXNzYWdlOiBudWxsLFxuICBmZXRjaEluUHJvZ3Jlc3M6IHRydWUsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHaXRUYWJDb250YWluZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIHJlcG9zaXRvcnk6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgfVxuXG4gIGZldGNoRGF0YSA9IHJlcG9zaXRvcnkgPT4ge1xuICAgIHJldHVybiB5dWJpa2lyaSh7XG4gICAgICByZXBvc2l0b3J5LFxuICAgICAgdXNlcm5hbWU6IHJlcG9zaXRvcnkuZ2V0Q29uZmlnKCd1c2VyLm5hbWUnKS50aGVuKG4gPT4gbiB8fCAnJyksXG4gICAgICBlbWFpbDogcmVwb3NpdG9yeS5nZXRDb25maWcoJ3VzZXIuZW1haWwnKS50aGVuKG4gPT4gbiB8fCAnJyksXG4gICAgICBsYXN0Q29tbWl0OiByZXBvc2l0b3J5LmdldExhc3RDb21taXQoKSxcbiAgICAgIHJlY2VudENvbW1pdHM6IHJlcG9zaXRvcnkuZ2V0UmVjZW50Q29tbWl0cyh7bWF4OiAxMH0pLFxuICAgICAgaXNNZXJnaW5nOiByZXBvc2l0b3J5LmlzTWVyZ2luZygpLFxuICAgICAgaXNSZWJhc2luZzogcmVwb3NpdG9yeS5pc1JlYmFzaW5nKCksXG4gICAgICBoYXNVbmRvSGlzdG9yeTogcmVwb3NpdG9yeS5oYXNEaXNjYXJkSGlzdG9yeSgpLFxuICAgICAgY3VycmVudEJyYW5jaDogcmVwb3NpdG9yeS5nZXRDdXJyZW50QnJhbmNoKCksXG4gICAgICB1bnN0YWdlZENoYW5nZXM6IHJlcG9zaXRvcnkuZ2V0VW5zdGFnZWRDaGFuZ2VzKCksXG4gICAgICBzdGFnZWRDaGFuZ2VzOiByZXBvc2l0b3J5LmdldFN0YWdlZENoYW5nZXMoKSxcbiAgICAgIG1lcmdlQ29uZmxpY3RzOiByZXBvc2l0b3J5LmdldE1lcmdlQ29uZmxpY3RzKCksXG4gICAgICB3b3JraW5nRGlyZWN0b3J5UGF0aDogcmVwb3NpdG9yeS5nZXRXb3JraW5nRGlyZWN0b3J5UGF0aCgpLFxuICAgICAgbWVyZ2VNZXNzYWdlOiBhc3luYyBxdWVyeSA9PiB7XG4gICAgICAgIGNvbnN0IGlzTWVyZ2luZyA9IGF3YWl0IHF1ZXJ5LmlzTWVyZ2luZztcbiAgICAgICAgcmV0dXJuIGlzTWVyZ2luZyA/IHJlcG9zaXRvcnkuZ2V0TWVyZ2VNZXNzYWdlKCkgOiBudWxsO1xuICAgICAgfSxcbiAgICAgIGZldGNoSW5Qcm9ncmVzczogZmFsc2UsXG4gICAgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxPYnNlcnZlTW9kZWwgbW9kZWw9e3RoaXMucHJvcHMucmVwb3NpdG9yeX0gZmV0Y2hEYXRhPXt0aGlzLmZldGNoRGF0YX0+XG4gICAgICAgIHtkYXRhID0+IHtcbiAgICAgICAgICBjb25zdCBkYXRhUHJvcHMgPSBkYXRhIHx8IERFRkFVTFRfUkVQT19EQVRBO1xuXG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIDxHaXRUYWJDb250cm9sbGVyXG4gICAgICAgICAgICAgIHsuLi5kYXRhUHJvcHN9XG4gICAgICAgICAgICAgIHsuLi50aGlzLnByb3BzfVxuICAgICAgICAgICAgICByZXBvc2l0b3J5RHJpZnQ9e3RoaXMucHJvcHMucmVwb3NpdG9yeSAhPT0gZGF0YVByb3BzLnJlcG9zaXRvcnl9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICk7XG4gICAgICAgIH19XG4gICAgICA8L09ic2VydmVNb2RlbD5cbiAgICApO1xuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFVBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFNBQUEs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