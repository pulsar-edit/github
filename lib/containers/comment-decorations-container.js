"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _yubikiri = _interopRequireDefault(require("yubikiri"));
var _reactRelay = require("react-relay");
var _commentDecorationsController = _interopRequireDefault(require("../controllers/comment-decorations-controller"));
var _observeModel = _interopRequireDefault(require("../views/observe-model"));
var _relayEnvironment = _interopRequireDefault(require("../views/relay-environment"));
var _propTypes2 = require("../prop-types");
var _keytarStrategy = require("../shared/keytar-strategy");
var _relayNetworkLayerManager = _interopRequireDefault(require("../relay-network-layer-manager"));
var _helpers = require("../helpers");
var _aggregatedReviewsContainer = _interopRequireDefault(require("./aggregated-reviews-container"));
var _commentPositioningContainer = _interopRequireDefault(require("./comment-positioning-container"));
var _prPatchContainer = _interopRequireDefault(require("./pr-patch-container"));
var _graphql;
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class CommentDecorationsContainer extends _react.default.Component {
  constructor(...args) {
    super(...args);
    _defineProperty(this, "renderWithLocalRepositoryData", repoData => {
      if (!repoData) {
        return null;
      }
      return _react.default.createElement(_observeModel.default, {
        model: this.props.loginModel,
        fetchParams: [repoData],
        fetchData: this.fetchToken
      }, token => this.renderWithToken(token, {
        repoData
      }));
    });
    _defineProperty(this, "fetchRepositoryData", repository => {
      return (0, _yubikiri.default)({
        branches: repository.getBranches(),
        remotes: repository.getRemotes(),
        currentRemote: repository.getCurrentGitHubRemote(),
        workingDirectoryPath: repository.getWorkingDirectoryPath()
      });
    });
    _defineProperty(this, "fetchToken", (loginModel, repoData) => {
      const endpoint = repoData.currentRemote.getEndpoint();
      if (!endpoint) {
        return null;
      }
      return loginModel.getToken(endpoint.getLoginAccount());
    });
  }
  render() {
    return _react.default.createElement(_observeModel.default, {
      model: this.props.localRepository,
      fetchData: this.fetchRepositoryData
    }, this.renderWithLocalRepositoryData);
  }
  renderWithToken(token, {
    repoData
  }) {
    if (!token || token === _keytarStrategy.UNAUTHENTICATED || token === _keytarStrategy.INSUFFICIENT || token instanceof Error) {
      // we're not going to prompt users to log in to render decorations for comments
      // just let it go and move on with our lives.
      return null;
    }
    const head = repoData.branches.getHeadBranch();
    if (!head.isPresent()) {
      return null;
    }
    const push = head.getPush();
    if (!push.isPresent() || !push.isRemoteTracking()) {
      return null;
    }
    const pushRemote = repoData.remotes.withName(push.getRemoteName());
    if (!pushRemote.isPresent() || !pushRemote.isGithubRepo()) {
      return null;
    }
    const endpoint = repoData.currentRemote.getEndpoint();
    const environment = _relayNetworkLayerManager.default.getEnvironmentForHost(endpoint, token);
    const query = _graphql || (_graphql = function () {
      const node = require("./__generated__/commentDecorationsContainerQuery.graphql");
      if (node.hash && node.hash !== "8154acbf4c24d190f6fdf0254ae73817") {
        console.error("The definition of 'commentDecorationsContainerQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
      }
      return require("./__generated__/commentDecorationsContainerQuery.graphql");
    });
    const variables = {
      headOwner: pushRemote.getOwner(),
      headName: pushRemote.getRepo(),
      headRef: push.getRemoteRef(),
      first: 1,
      reviewCount: _helpers.PAGE_SIZE,
      reviewCursor: null,
      threadCount: _helpers.PAGE_SIZE,
      threadCursor: null,
      commentCount: _helpers.PAGE_SIZE,
      commentCursor: null
    };
    return _react.default.createElement(_relayEnvironment.default.Provider, {
      value: environment
    }, _react.default.createElement(_reactRelay.QueryRenderer, {
      environment: environment,
      query: query,
      variables: variables,
      render: queryResult => this.renderWithPullRequest(_objectSpread({
        endpoint,
        owner: variables.headOwner,
        repo: variables.headName
      }, queryResult), {
        repoData,
        token
      })
    }));
  }
  renderWithPullRequest({
    error,
    props,
    endpoint,
    owner,
    repo
  }, {
    repoData,
    token
  }) {
    if (error) {
      // eslint-disable-next-line no-console
      console.warn(`error fetching CommentDecorationsContainer data: ${error}`);
      return null;
    }
    if (!props || !props.repository || !props.repository.ref || !props.repository.ref.associatedPullRequests || props.repository.ref.associatedPullRequests.totalCount === 0) {
      // no loading spinner for you
      // just fetch silently behind the scenes like a good little container
      return null;
    }
    const currentPullRequest = props.repository.ref.associatedPullRequests.nodes[0];
    return _react.default.createElement(_aggregatedReviewsContainer.default, {
      pullRequest: currentPullRequest,
      reportRelayError: this.props.reportRelayError
    }, ({
      errors,
      summaries,
      commentThreads
    }) => {
      return this.renderWithReviews({
        errors,
        summaries,
        commentThreads
      }, {
        currentPullRequest,
        repoResult: props,
        endpoint,
        owner,
        repo,
        repoData,
        token
      });
    });
  }
  renderWithReviews({
    errors,
    summaries,
    commentThreads
  }, {
    currentPullRequest,
    repoResult,
    endpoint,
    owner,
    repo,
    repoData,
    token
  }) {
    if (errors && errors.length > 0) {
      // eslint-disable-next-line no-console
      console.warn('Errors aggregating reviews and comments for current pull request', ...errors);
      return null;
    }
    if (commentThreads.length === 0) {
      return null;
    }
    return _react.default.createElement(_prPatchContainer.default, {
      owner: owner,
      repo: repo,
      number: currentPullRequest.number,
      endpoint: endpoint,
      token: token,
      largeDiffThreshold: Infinity
    }, (patchError, patch) => this.renderWithPatch({
      error: patchError,
      patch
    }, {
      summaries,
      commentThreads,
      currentPullRequest,
      repoResult,
      endpoint,
      owner,
      repo,
      repoData,
      token
    }));
  }
  renderWithPatch({
    error,
    patch
  }, {
    summaries,
    commentThreads,
    currentPullRequest,
    repoResult,
    endpoint,
    owner,
    repo,
    repoData,
    token
  }) {
    if (error) {
      // eslint-disable-next-line no-console
      console.warn('Error fetching patch for current pull request', error);
      return null;
    }
    if (!patch) {
      return null;
    }
    return _react.default.createElement(_commentPositioningContainer.default, {
      multiFilePatch: patch,
      commentThreads: commentThreads,
      prCommitSha: currentPullRequest.headRefOid,
      localRepository: this.props.localRepository,
      workdir: repoData.workingDirectoryPath
    }, commentTranslations => {
      if (!commentTranslations) {
        return null;
      }
      return _react.default.createElement(_commentDecorationsController.default, {
        endpoint: endpoint,
        owner: owner,
        repo: repo,
        workspace: this.props.workspace,
        commands: this.props.commands,
        repoData: repoData,
        commentThreads: commentThreads,
        commentTranslations: commentTranslations,
        pullRequests: repoResult.repository.ref.associatedPullRequests.nodes
      });
    });
  }
}
exports.default = CommentDecorationsContainer;
_defineProperty(CommentDecorationsContainer, "propTypes", {
  workspace: _propTypes.default.object.isRequired,
  commands: _propTypes.default.object.isRequired,
  localRepository: _propTypes.default.object.isRequired,
  loginModel: _propTypes2.GithubLoginModelPropType.isRequired,
  reportRelayError: _propTypes.default.func.isRequired
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfeXViaWtpcmkiLCJfcmVhY3RSZWxheSIsIl9jb21tZW50RGVjb3JhdGlvbnNDb250cm9sbGVyIiwiX29ic2VydmVNb2RlbCIsIl9yZWxheUVudmlyb25tZW50IiwiX3Byb3BUeXBlczIiLCJfa2V5dGFyU3RyYXRlZ3kiLCJfcmVsYXlOZXR3b3JrTGF5ZXJNYW5hZ2VyIiwiX2hlbHBlcnMiLCJfYWdncmVnYXRlZFJldmlld3NDb250YWluZXIiLCJfY29tbWVudFBvc2l0aW9uaW5nQ29udGFpbmVyIiwiX3ByUGF0Y2hDb250YWluZXIiLCJfZ3JhcGhxbCIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0Iiwib3duS2V5cyIsImUiLCJyIiwidCIsIk9iamVjdCIsImtleXMiLCJnZXRPd25Qcm9wZXJ0eVN5bWJvbHMiLCJvIiwiZmlsdGVyIiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZW51bWVyYWJsZSIsInB1c2giLCJhcHBseSIsIl9vYmplY3RTcHJlYWQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJmb3JFYWNoIiwiX2RlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyIsImRlZmluZVByb3BlcnRpZXMiLCJkZWZpbmVQcm9wZXJ0eSIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImFyZyIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsImlucHV0IiwiaGludCIsInByaW0iLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsInVuZGVmaW5lZCIsInJlcyIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJDb21tZW50RGVjb3JhdGlvbnNDb250YWluZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwiYXJncyIsInJlcG9EYXRhIiwiY3JlYXRlRWxlbWVudCIsIm1vZGVsIiwicHJvcHMiLCJsb2dpbk1vZGVsIiwiZmV0Y2hQYXJhbXMiLCJmZXRjaERhdGEiLCJmZXRjaFRva2VuIiwidG9rZW4iLCJyZW5kZXJXaXRoVG9rZW4iLCJyZXBvc2l0b3J5IiwieXViaWtpcmkiLCJicmFuY2hlcyIsImdldEJyYW5jaGVzIiwicmVtb3RlcyIsImdldFJlbW90ZXMiLCJjdXJyZW50UmVtb3RlIiwiZ2V0Q3VycmVudEdpdEh1YlJlbW90ZSIsIndvcmtpbmdEaXJlY3RvcnlQYXRoIiwiZ2V0V29ya2luZ0RpcmVjdG9yeVBhdGgiLCJlbmRwb2ludCIsImdldEVuZHBvaW50IiwiZ2V0VG9rZW4iLCJnZXRMb2dpbkFjY291bnQiLCJyZW5kZXIiLCJsb2NhbFJlcG9zaXRvcnkiLCJmZXRjaFJlcG9zaXRvcnlEYXRhIiwicmVuZGVyV2l0aExvY2FsUmVwb3NpdG9yeURhdGEiLCJVTkFVVEhFTlRJQ0FURUQiLCJJTlNVRkZJQ0lFTlQiLCJFcnJvciIsImhlYWQiLCJnZXRIZWFkQnJhbmNoIiwiaXNQcmVzZW50IiwiZ2V0UHVzaCIsImlzUmVtb3RlVHJhY2tpbmciLCJwdXNoUmVtb3RlIiwid2l0aE5hbWUiLCJnZXRSZW1vdGVOYW1lIiwiaXNHaXRodWJSZXBvIiwiZW52aXJvbm1lbnQiLCJSZWxheU5ldHdvcmtMYXllck1hbmFnZXIiLCJnZXRFbnZpcm9ubWVudEZvckhvc3QiLCJxdWVyeSIsIm5vZGUiLCJoYXNoIiwiY29uc29sZSIsImVycm9yIiwidmFyaWFibGVzIiwiaGVhZE93bmVyIiwiZ2V0T3duZXIiLCJoZWFkTmFtZSIsImdldFJlcG8iLCJoZWFkUmVmIiwiZ2V0UmVtb3RlUmVmIiwiZmlyc3QiLCJyZXZpZXdDb3VudCIsIlBBR0VfU0laRSIsInJldmlld0N1cnNvciIsInRocmVhZENvdW50IiwidGhyZWFkQ3Vyc29yIiwiY29tbWVudENvdW50IiwiY29tbWVudEN1cnNvciIsIlByb3ZpZGVyIiwiUXVlcnlSZW5kZXJlciIsInF1ZXJ5UmVzdWx0IiwicmVuZGVyV2l0aFB1bGxSZXF1ZXN0Iiwib3duZXIiLCJyZXBvIiwid2FybiIsInJlZiIsImFzc29jaWF0ZWRQdWxsUmVxdWVzdHMiLCJ0b3RhbENvdW50IiwiY3VycmVudFB1bGxSZXF1ZXN0Iiwibm9kZXMiLCJwdWxsUmVxdWVzdCIsInJlcG9ydFJlbGF5RXJyb3IiLCJlcnJvcnMiLCJzdW1tYXJpZXMiLCJjb21tZW50VGhyZWFkcyIsInJlbmRlcldpdGhSZXZpZXdzIiwicmVwb1Jlc3VsdCIsIm51bWJlciIsImxhcmdlRGlmZlRocmVzaG9sZCIsIkluZmluaXR5IiwicGF0Y2hFcnJvciIsInBhdGNoIiwicmVuZGVyV2l0aFBhdGNoIiwibXVsdGlGaWxlUGF0Y2giLCJwckNvbW1pdFNoYSIsImhlYWRSZWZPaWQiLCJ3b3JrZGlyIiwiY29tbWVudFRyYW5zbGF0aW9ucyIsIndvcmtzcGFjZSIsImNvbW1hbmRzIiwicHVsbFJlcXVlc3RzIiwiZXhwb3J0cyIsIlByb3BUeXBlcyIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJHaXRodWJMb2dpbk1vZGVsUHJvcFR5cGUiLCJmdW5jIl0sInNvdXJjZXMiOlsiY29tbWVudC1kZWNvcmF0aW9ucy1jb250YWluZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgeXViaWtpcmkgZnJvbSAneXViaWtpcmknO1xuaW1wb3J0IHtRdWVyeVJlbmRlcmVyLCBncmFwaHFsfSBmcm9tICdyZWFjdC1yZWxheSc7XG5cbmltcG9ydCBDb21tZW50RGVjb3JhdGlvbnNDb250cm9sbGVyIGZyb20gJy4uL2NvbnRyb2xsZXJzL2NvbW1lbnQtZGVjb3JhdGlvbnMtY29udHJvbGxlcic7XG5pbXBvcnQgT2JzZXJ2ZU1vZGVsIGZyb20gJy4uL3ZpZXdzL29ic2VydmUtbW9kZWwnO1xuaW1wb3J0IFJlbGF5RW52aXJvbm1lbnQgZnJvbSAnLi4vdmlld3MvcmVsYXktZW52aXJvbm1lbnQnO1xuaW1wb3J0IHtHaXRodWJMb2dpbk1vZGVsUHJvcFR5cGV9IGZyb20gJy4uL3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtVTkFVVEhFTlRJQ0FURUQsIElOU1VGRklDSUVOVH0gZnJvbSAnLi4vc2hhcmVkL2tleXRhci1zdHJhdGVneSc7XG5pbXBvcnQgUmVsYXlOZXR3b3JrTGF5ZXJNYW5hZ2VyIGZyb20gJy4uL3JlbGF5LW5ldHdvcmstbGF5ZXItbWFuYWdlcic7XG5pbXBvcnQge1BBR0VfU0laRX0gZnJvbSAnLi4vaGVscGVycyc7XG5pbXBvcnQgQWdncmVnYXRlZFJldmlld3NDb250YWluZXIgZnJvbSAnLi9hZ2dyZWdhdGVkLXJldmlld3MtY29udGFpbmVyJztcbmltcG9ydCBDb21tZW50UG9zaXRpb25pbmdDb250YWluZXIgZnJvbSAnLi9jb21tZW50LXBvc2l0aW9uaW5nLWNvbnRhaW5lcic7XG5pbXBvcnQgUHVsbFJlcXVlc3RQYXRjaENvbnRhaW5lciBmcm9tICcuL3ByLXBhdGNoLWNvbnRhaW5lcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbW1lbnREZWNvcmF0aW9uc0NvbnRhaW5lciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgd29ya3NwYWNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgY29tbWFuZHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBsb2NhbFJlcG9zaXRvcnk6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBsb2dpbk1vZGVsOiBHaXRodWJMb2dpbk1vZGVsUHJvcFR5cGUuaXNSZXF1aXJlZCxcblxuICAgIHJlcG9ydFJlbGF5RXJyb3I6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIH07XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8T2JzZXJ2ZU1vZGVsIG1vZGVsPXt0aGlzLnByb3BzLmxvY2FsUmVwb3NpdG9yeX0gZmV0Y2hEYXRhPXt0aGlzLmZldGNoUmVwb3NpdG9yeURhdGF9PlxuICAgICAgICB7dGhpcy5yZW5kZXJXaXRoTG9jYWxSZXBvc2l0b3J5RGF0YX1cbiAgICAgIDwvT2JzZXJ2ZU1vZGVsPlxuICAgICk7XG4gIH1cblxuICByZW5kZXJXaXRoTG9jYWxSZXBvc2l0b3J5RGF0YSA9IHJlcG9EYXRhID0+IHtcbiAgICBpZiAoIXJlcG9EYXRhKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPE9ic2VydmVNb2RlbFxuICAgICAgICBtb2RlbD17dGhpcy5wcm9wcy5sb2dpbk1vZGVsfVxuICAgICAgICBmZXRjaFBhcmFtcz17W3JlcG9EYXRhXX1cbiAgICAgICAgZmV0Y2hEYXRhPXt0aGlzLmZldGNoVG9rZW59PlxuICAgICAgICB7dG9rZW4gPT4gdGhpcy5yZW5kZXJXaXRoVG9rZW4odG9rZW4sIHtyZXBvRGF0YX0pfVxuICAgICAgPC9PYnNlcnZlTW9kZWw+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcldpdGhUb2tlbih0b2tlbiwge3JlcG9EYXRhfSkge1xuICAgIGlmICghdG9rZW4gfHwgdG9rZW4gPT09IFVOQVVUSEVOVElDQVRFRCB8fCB0b2tlbiA9PT0gSU5TVUZGSUNJRU5UIHx8IHRva2VuIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICAgIC8vIHdlJ3JlIG5vdCBnb2luZyB0byBwcm9tcHQgdXNlcnMgdG8gbG9nIGluIHRvIHJlbmRlciBkZWNvcmF0aW9ucyBmb3IgY29tbWVudHNcbiAgICAgIC8vIGp1c3QgbGV0IGl0IGdvIGFuZCBtb3ZlIG9uIHdpdGggb3VyIGxpdmVzLlxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgaGVhZCA9IHJlcG9EYXRhLmJyYW5jaGVzLmdldEhlYWRCcmFuY2goKTtcbiAgICBpZiAoIWhlYWQuaXNQcmVzZW50KCkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGNvbnN0IHB1c2ggPSBoZWFkLmdldFB1c2goKTtcbiAgICBpZiAoIXB1c2guaXNQcmVzZW50KCkgfHwgIXB1c2guaXNSZW1vdGVUcmFja2luZygpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBwdXNoUmVtb3RlID0gcmVwb0RhdGEucmVtb3Rlcy53aXRoTmFtZShwdXNoLmdldFJlbW90ZU5hbWUoKSk7XG4gICAgaWYgKCFwdXNoUmVtb3RlLmlzUHJlc2VudCgpIHx8ICFwdXNoUmVtb3RlLmlzR2l0aHViUmVwbygpKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IHJlcG9EYXRhLmN1cnJlbnRSZW1vdGUuZ2V0RW5kcG9pbnQoKTtcbiAgICBjb25zdCBlbnZpcm9ubWVudCA9IFJlbGF5TmV0d29ya0xheWVyTWFuYWdlci5nZXRFbnZpcm9ubWVudEZvckhvc3QoZW5kcG9pbnQsIHRva2VuKTtcbiAgICBjb25zdCBxdWVyeSA9IGdyYXBocWxgXG4gICAgICBxdWVyeSBjb21tZW50RGVjb3JhdGlvbnNDb250YWluZXJRdWVyeShcbiAgICAgICAgJGhlYWRPd25lcjogU3RyaW5nIVxuICAgICAgICAkaGVhZE5hbWU6IFN0cmluZyFcbiAgICAgICAgJGhlYWRSZWY6IFN0cmluZyFcbiAgICAgICAgJHJldmlld0NvdW50OiBJbnQhXG4gICAgICAgICRyZXZpZXdDdXJzb3I6IFN0cmluZ1xuICAgICAgICAkdGhyZWFkQ291bnQ6IEludCFcbiAgICAgICAgJHRocmVhZEN1cnNvcjogU3RyaW5nXG4gICAgICAgICRjb21tZW50Q291bnQ6IEludCFcbiAgICAgICAgJGNvbW1lbnRDdXJzb3I6IFN0cmluZ1xuICAgICAgICAkZmlyc3Q6IEludCFcbiAgICAgICkge1xuICAgICAgICByZXBvc2l0b3J5KG93bmVyOiAkaGVhZE93bmVyLCBuYW1lOiAkaGVhZE5hbWUpIHtcbiAgICAgICAgICByZWYocXVhbGlmaWVkTmFtZTogJGhlYWRSZWYpIHtcbiAgICAgICAgICAgIGFzc29jaWF0ZWRQdWxsUmVxdWVzdHMoZmlyc3Q6ICRmaXJzdCwgc3RhdGVzOiBbT1BFTl0pIHtcbiAgICAgICAgICAgICAgdG90YWxDb3VudFxuICAgICAgICAgICAgICBub2RlcyB7XG4gICAgICAgICAgICAgICAgbnVtYmVyXG4gICAgICAgICAgICAgICAgaGVhZFJlZk9pZFxuXG4gICAgICAgICAgICAgICAgLi4uY29tbWVudERlY29yYXRpb25zQ29udHJvbGxlcl9wdWxsUmVxdWVzdHNcbiAgICAgICAgICAgICAgICAuLi5hZ2dyZWdhdGVkUmV2aWV3c0NvbnRhaW5lcl9wdWxsUmVxdWVzdCBAYXJndW1lbnRzKFxuICAgICAgICAgICAgICAgICAgcmV2aWV3Q291bnQ6ICRyZXZpZXdDb3VudFxuICAgICAgICAgICAgICAgICAgcmV2aWV3Q3Vyc29yOiAkcmV2aWV3Q3Vyc29yXG4gICAgICAgICAgICAgICAgICB0aHJlYWRDb3VudDogJHRocmVhZENvdW50XG4gICAgICAgICAgICAgICAgICB0aHJlYWRDdXJzb3I6ICR0aHJlYWRDdXJzb3JcbiAgICAgICAgICAgICAgICAgIGNvbW1lbnRDb3VudDogJGNvbW1lbnRDb3VudFxuICAgICAgICAgICAgICAgICAgY29tbWVudEN1cnNvcjogJGNvbW1lbnRDdXJzb3JcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICBgO1xuICAgIGNvbnN0IHZhcmlhYmxlcyA9IHtcbiAgICAgIGhlYWRPd25lcjogcHVzaFJlbW90ZS5nZXRPd25lcigpLFxuICAgICAgaGVhZE5hbWU6IHB1c2hSZW1vdGUuZ2V0UmVwbygpLFxuICAgICAgaGVhZFJlZjogcHVzaC5nZXRSZW1vdGVSZWYoKSxcbiAgICAgIGZpcnN0OiAxLFxuICAgICAgcmV2aWV3Q291bnQ6IFBBR0VfU0laRSxcbiAgICAgIHJldmlld0N1cnNvcjogbnVsbCxcbiAgICAgIHRocmVhZENvdW50OiBQQUdFX1NJWkUsXG4gICAgICB0aHJlYWRDdXJzb3I6IG51bGwsXG4gICAgICBjb21tZW50Q291bnQ6IFBBR0VfU0laRSxcbiAgICAgIGNvbW1lbnRDdXJzb3I6IG51bGwsXG4gICAgfTtcblxuICAgIHJldHVybiAoXG4gICAgICA8UmVsYXlFbnZpcm9ubWVudC5Qcm92aWRlciB2YWx1ZT17ZW52aXJvbm1lbnR9PlxuICAgICAgICA8UXVlcnlSZW5kZXJlclxuICAgICAgICAgIGVudmlyb25tZW50PXtlbnZpcm9ubWVudH1cbiAgICAgICAgICBxdWVyeT17cXVlcnl9XG4gICAgICAgICAgdmFyaWFibGVzPXt2YXJpYWJsZXN9XG4gICAgICAgICAgcmVuZGVyPXtxdWVyeVJlc3VsdCA9PiB0aGlzLnJlbmRlcldpdGhQdWxsUmVxdWVzdCh7XG4gICAgICAgICAgICBlbmRwb2ludCxcbiAgICAgICAgICAgIG93bmVyOiB2YXJpYWJsZXMuaGVhZE93bmVyLFxuICAgICAgICAgICAgcmVwbzogdmFyaWFibGVzLmhlYWROYW1lLFxuICAgICAgICAgICAgLi4ucXVlcnlSZXN1bHQsXG4gICAgICAgICAgfSwge3JlcG9EYXRhLCB0b2tlbn0pfVxuICAgICAgICAvPlxuICAgICAgPC9SZWxheUVudmlyb25tZW50LlByb3ZpZGVyPlxuICAgICk7XG4gIH1cblxuICByZW5kZXJXaXRoUHVsbFJlcXVlc3Qoe2Vycm9yLCBwcm9wcywgZW5kcG9pbnQsIG93bmVyLCByZXBvfSwge3JlcG9EYXRhLCB0b2tlbn0pIHtcbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oYGVycm9yIGZldGNoaW5nIENvbW1lbnREZWNvcmF0aW9uc0NvbnRhaW5lciBkYXRhOiAke2Vycm9yfWApO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKFxuICAgICAgIXByb3BzIHx8ICFwcm9wcy5yZXBvc2l0b3J5IHx8ICFwcm9wcy5yZXBvc2l0b3J5LnJlZiB8fFxuICAgICAgIXByb3BzLnJlcG9zaXRvcnkucmVmLmFzc29jaWF0ZWRQdWxsUmVxdWVzdHMgfHxcbiAgICAgIHByb3BzLnJlcG9zaXRvcnkucmVmLmFzc29jaWF0ZWRQdWxsUmVxdWVzdHMudG90YWxDb3VudCA9PT0gMFxuICAgICkge1xuICAgICAgLy8gbm8gbG9hZGluZyBzcGlubmVyIGZvciB5b3VcbiAgICAgIC8vIGp1c3QgZmV0Y2ggc2lsZW50bHkgYmVoaW5kIHRoZSBzY2VuZXMgbGlrZSBhIGdvb2QgbGl0dGxlIGNvbnRhaW5lclxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgY29uc3QgY3VycmVudFB1bGxSZXF1ZXN0ID0gcHJvcHMucmVwb3NpdG9yeS5yZWYuYXNzb2NpYXRlZFB1bGxSZXF1ZXN0cy5ub2Rlc1swXTtcblxuICAgIHJldHVybiAoXG4gICAgICA8QWdncmVnYXRlZFJldmlld3NDb250YWluZXJcbiAgICAgICAgcHVsbFJlcXVlc3Q9e2N1cnJlbnRQdWxsUmVxdWVzdH1cbiAgICAgICAgcmVwb3J0UmVsYXlFcnJvcj17dGhpcy5wcm9wcy5yZXBvcnRSZWxheUVycm9yfT5cbiAgICAgICAgeyh7ZXJyb3JzLCBzdW1tYXJpZXMsIGNvbW1lbnRUaHJlYWRzfSkgPT4ge1xuICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlcldpdGhSZXZpZXdzKFxuICAgICAgICAgICAge2Vycm9ycywgc3VtbWFyaWVzLCBjb21tZW50VGhyZWFkc30sXG4gICAgICAgICAgICB7Y3VycmVudFB1bGxSZXF1ZXN0LCByZXBvUmVzdWx0OiBwcm9wcywgZW5kcG9pbnQsIG93bmVyLCByZXBvLCByZXBvRGF0YSwgdG9rZW59LFxuICAgICAgICAgICk7XG4gICAgICAgIH19XG4gICAgICA8L0FnZ3JlZ2F0ZWRSZXZpZXdzQ29udGFpbmVyPlxuICAgICk7XG4gIH1cblxuICByZW5kZXJXaXRoUmV2aWV3cyhcbiAgICB7ZXJyb3JzLCBzdW1tYXJpZXMsIGNvbW1lbnRUaHJlYWRzfSxcbiAgICB7Y3VycmVudFB1bGxSZXF1ZXN0LCByZXBvUmVzdWx0LCBlbmRwb2ludCwgb3duZXIsIHJlcG8sIHJlcG9EYXRhLCB0b2tlbn0sXG4gICkge1xuICAgIGlmIChlcnJvcnMgJiYgZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLndhcm4oJ0Vycm9ycyBhZ2dyZWdhdGluZyByZXZpZXdzIGFuZCBjb21tZW50cyBmb3IgY3VycmVudCBwdWxsIHJlcXVlc3QnLCAuLi5lcnJvcnMpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgaWYgKGNvbW1lbnRUaHJlYWRzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxQdWxsUmVxdWVzdFBhdGNoQ29udGFpbmVyXG4gICAgICAgIG93bmVyPXtvd25lcn1cbiAgICAgICAgcmVwbz17cmVwb31cbiAgICAgICAgbnVtYmVyPXtjdXJyZW50UHVsbFJlcXVlc3QubnVtYmVyfVxuICAgICAgICBlbmRwb2ludD17ZW5kcG9pbnR9XG4gICAgICAgIHRva2VuPXt0b2tlbn1cbiAgICAgICAgbGFyZ2VEaWZmVGhyZXNob2xkPXtJbmZpbml0eX0+XG4gICAgICAgIHsocGF0Y2hFcnJvciwgcGF0Y2gpID0+IHRoaXMucmVuZGVyV2l0aFBhdGNoKFxuICAgICAgICAgIHtlcnJvcjogcGF0Y2hFcnJvciwgcGF0Y2h9LFxuICAgICAgICAgIHtzdW1tYXJpZXMsIGNvbW1lbnRUaHJlYWRzLCBjdXJyZW50UHVsbFJlcXVlc3QsIHJlcG9SZXN1bHQsIGVuZHBvaW50LCBvd25lciwgcmVwbywgcmVwb0RhdGEsIHRva2VufSxcbiAgICAgICAgKX1cbiAgICAgIDwvUHVsbFJlcXVlc3RQYXRjaENvbnRhaW5lcj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyV2l0aFBhdGNoKFxuICAgIHtlcnJvciwgcGF0Y2h9LFxuICAgIHtzdW1tYXJpZXMsIGNvbW1lbnRUaHJlYWRzLCBjdXJyZW50UHVsbFJlcXVlc3QsIHJlcG9SZXN1bHQsIGVuZHBvaW50LCBvd25lciwgcmVwbywgcmVwb0RhdGEsIHRva2VufSxcbiAgKSB7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgY29uc29sZS53YXJuKCdFcnJvciBmZXRjaGluZyBwYXRjaCBmb3IgY3VycmVudCBwdWxsIHJlcXVlc3QnLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAoIXBhdGNoKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gKFxuICAgICAgPENvbW1lbnRQb3NpdGlvbmluZ0NvbnRhaW5lclxuICAgICAgICBtdWx0aUZpbGVQYXRjaD17cGF0Y2h9XG4gICAgICAgIGNvbW1lbnRUaHJlYWRzPXtjb21tZW50VGhyZWFkc31cbiAgICAgICAgcHJDb21taXRTaGE9e2N1cnJlbnRQdWxsUmVxdWVzdC5oZWFkUmVmT2lkfVxuICAgICAgICBsb2NhbFJlcG9zaXRvcnk9e3RoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5fVxuICAgICAgICB3b3JrZGlyPXtyZXBvRGF0YS53b3JraW5nRGlyZWN0b3J5UGF0aH0+XG4gICAgICAgIHtjb21tZW50VHJhbnNsYXRpb25zID0+IHtcbiAgICAgICAgICBpZiAoIWNvbW1lbnRUcmFuc2xhdGlvbnMpIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8Q29tbWVudERlY29yYXRpb25zQ29udHJvbGxlclxuICAgICAgICAgICAgICBlbmRwb2ludD17ZW5kcG9pbnR9XG4gICAgICAgICAgICAgIG93bmVyPXtvd25lcn1cbiAgICAgICAgICAgICAgcmVwbz17cmVwb31cbiAgICAgICAgICAgICAgd29ya3NwYWNlPXt0aGlzLnByb3BzLndvcmtzcGFjZX1cbiAgICAgICAgICAgICAgY29tbWFuZHM9e3RoaXMucHJvcHMuY29tbWFuZHN9XG4gICAgICAgICAgICAgIHJlcG9EYXRhPXtyZXBvRGF0YX1cbiAgICAgICAgICAgICAgY29tbWVudFRocmVhZHM9e2NvbW1lbnRUaHJlYWRzfVxuICAgICAgICAgICAgICBjb21tZW50VHJhbnNsYXRpb25zPXtjb21tZW50VHJhbnNsYXRpb25zfVxuICAgICAgICAgICAgICBwdWxsUmVxdWVzdHM9e3JlcG9SZXN1bHQucmVwb3NpdG9yeS5yZWYuYXNzb2NpYXRlZFB1bGxSZXF1ZXN0cy5ub2Rlc31cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKTtcbiAgICAgICAgfX1cbiAgICAgIDwvQ29tbWVudFBvc2l0aW9uaW5nQ29udGFpbmVyPlxuICAgICk7XG4gIH1cblxuICBmZXRjaFJlcG9zaXRvcnlEYXRhID0gcmVwb3NpdG9yeSA9PiB7XG4gICAgcmV0dXJuIHl1YmlraXJpKHtcbiAgICAgIGJyYW5jaGVzOiByZXBvc2l0b3J5LmdldEJyYW5jaGVzKCksXG4gICAgICByZW1vdGVzOiByZXBvc2l0b3J5LmdldFJlbW90ZXMoKSxcbiAgICAgIGN1cnJlbnRSZW1vdGU6IHJlcG9zaXRvcnkuZ2V0Q3VycmVudEdpdEh1YlJlbW90ZSgpLFxuICAgICAgd29ya2luZ0RpcmVjdG9yeVBhdGg6IHJlcG9zaXRvcnkuZ2V0V29ya2luZ0RpcmVjdG9yeVBhdGgoKSxcbiAgICB9KTtcbiAgfVxuXG4gIGZldGNoVG9rZW4gPSAobG9naW5Nb2RlbCwgcmVwb0RhdGEpID0+IHtcbiAgICBjb25zdCBlbmRwb2ludCA9IHJlcG9EYXRhLmN1cnJlbnRSZW1vdGUuZ2V0RW5kcG9pbnQoKTtcbiAgICBpZiAoIWVuZHBvaW50KSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gbG9naW5Nb2RlbC5nZXRUb2tl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