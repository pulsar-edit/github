"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _crypto = _interopRequireDefault(require("crypto"));
var _eventKit = require("event-kit");
var _yubikiri = _interopRequireDefault(require("yubikiri"));
var _whatsMyLine = require("whats-my-line");
var _file = _interopRequireDefault(require("../models/patch/file"));
var _observeModel = _interopRequireDefault(require("../views/observe-model"));
var _helpers = require("../helpers");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
class CommentPositioningContainer extends _react.default.Component {
  constructor(props) {
    super(props);
    _defineProperty(this, "fetchData", (localRepository, commentPaths, prCommitSha) => {
      const promises = {};
      for (const commentPath of commentPaths) {
        promises[commentPath] = localRepository.getDiffsForFilePath(commentPath, prCommitSha).catch(() => []);
      }
      return (0, _yubikiri.default)(promises);
    });
    this.state = {
      translationsByFile: new Map()
    };
    this.subs = new _eventKit.CompositeDisposable();
  }
  static getDerivedStateFromProps(props, state) {
    const prevPaths = new Set(state.translationsByFile.keys());
    let changed = false;
    for (const thread of props.commentThreads) {
      const relPath = thread.comments[0].path;
      const commentPath = (0, _helpers.toNativePathSep)(relPath);
      let existing = state.translationsByFile.get(commentPath);
      if (!existing) {
        existing = new FileTranslation(relPath);
        state.translationsByFile.set(commentPath, existing);
        changed = true;
      }
      existing.addCommentThread(thread);
      prevPaths.delete(commentPath);
    }
    for (const oldPath of prevPaths) {
      state.translationsByFile.deleted(oldPath);
      changed = true;
    }
    if (changed) {
      return {
        translationsByFile: state.translationsByFile
      };
    } else {
      return null;
    }
  }
  componentWillUnmount() {
    this.subs.dispose();
  }
  render() {
    const commentPaths = [...this.state.translationsByFile.keys()];
    return _react.default.createElement(_observeModel.default, {
      model: this.props.localRepository,
      fetchData: this.fetchData,
      fetchParams: [commentPaths, this.props.prCommitSha]
    }, diffsByPath => {
      if (diffsByPath === null) {
        return this.props.children(null);
      }
      for (const commentPath of commentPaths) {
        this.state.translationsByFile.get(commentPath).updateIfNecessary({
          multiFilePatch: this.props.multiFilePatch,
          diffs: diffsByPath[commentPath] || [],
          diffPositionFn: this.props.diffPositionToFilePosition,
          translatePositionFn: this.props.translateLinesGivenDiff
        });
      }
      return this.props.children(this.state.translationsByFile);
    });
  }
}
exports.default = CommentPositioningContainer;
_defineProperty(CommentPositioningContainer, "propTypes", {
  localRepository: _propTypes.default.object.isRequired,
  multiFilePatch: _propTypes.default.object.isRequired,
  commentThreads: _propTypes.default.arrayOf(_propTypes.default.shape({
    comments: _propTypes.default.arrayOf(_propTypes.default.shape({
      position: _propTypes.default.number,
      path: _propTypes.default.string.isRequired
    })).isRequired
  })),
  prCommitSha: _propTypes.default.string.isRequired,
  children: _propTypes.default.func.isRequired,
  // For unit test injection
  translateLinesGivenDiff: _propTypes.default.func,
  diffPositionToFilePosition: _propTypes.default.func
});
_defineProperty(CommentPositioningContainer, "defaultProps", {
  translateLinesGivenDiff: _whatsMyLine.translateLinesGivenDiff,
  diffPositionToFilePosition: _whatsMyLine.diffPositionToFilePosition,
  didTranslate: /* istanbul ignore next */() => {}
});
class FileTranslation {
  constructor(relPath) {
    this.relPath = relPath;
    this.nativeRelPath = (0, _helpers.toNativePathSep)(relPath);
    this.rawPositions = new Set();
    this.diffToFilePosition = new Map();
    this.removed = false;
    this.fileTranslations = null;
    this.digest = null;
    this.last = {
      multiFilePatch: null,
      diffs: null
    };
  }
  addCommentThread(thread) {
    this.rawPositions.add(thread.comments[0].position);
  }
  updateIfNecessary({
    multiFilePatch,
    diffs,
    diffPositionFn,
    translatePositionFn
  }) {
    if (this.last.multiFilePatch === multiFilePatch && this.last.diffs === diffs) {
      return false;
    }
    this.last.multiFilePatch = multiFilePatch;
    this.last.diffs = diffs;
    return this.update({
      multiFilePatch,
      diffs,
      diffPositionFn,
      translatePositionFn
    });
  }
  update({
    multiFilePatch,
    diffs,
    diffPositionFn,
    translatePositionFn
  }) {
    const filePatch = multiFilePatch.getPatchForPath(this.nativeRelPath);
    // Comment on a file that used to exist in a PR but no longer does. Skip silently.
    if (!filePatch) {
      this.diffToFilePosition = new Map();
      this.removed = false;
      this.fileTranslations = null;
      return;
    }

    // This comment was left on a file that was too large to parse.
    if (!filePatch.getRenderStatus().isVisible()) {
      this.diffToFilePosition = new Map();
      this.removed = true;
      this.fileTranslations = null;
      return;
    }
    this.diffToFilePosition = diffPositionFn(this.rawPositions, filePatch.getRawContentPatch());
    this.removed = false;
    let contentChangeDiff;
    if (diffs.length === 1) {
      contentChangeDiff = diffs[0];
    } else if (diffs.length === 2) {
      const [diff1, diff2] = diffs;
      if (diff1.oldMode === _file.default.modes.SYMLINK || diff1.newMode === _file.default.modes.SYMLINK) {
        contentChangeDiff = diff2;
      } else {
        contentChangeDiff = diff1;
      }
    }
    if (contentChangeDiff) {
      const filePositions = [...this.diffToFilePosition.values()];
      this.fileTranslations = translatePositionFn(filePositions, contentChangeDiff);
      const hash = _crypto.default.createHash('sha256');
      hash.update(JSON.stringify(Array.from(this.fileTranslations.entries())));
      this.digest = hash.digest('hex');
    } else {
      this.fileTranslations = null;
      this.digest = null;
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfY3J5cHRvIiwiX2V2ZW50S2l0IiwiX3l1YmlraXJpIiwiX3doYXRzTXlMaW5lIiwiX2ZpbGUiLCJfb2JzZXJ2ZU1vZGVsIiwiX2hlbHBlcnMiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZpbmVQcm9wZXJ0eSIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsInQiLCJpIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiciIsImUiLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJDb21tZW50UG9zaXRpb25pbmdDb250YWluZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJsb2NhbFJlcG9zaXRvcnkiLCJjb21tZW50UGF0aHMiLCJwckNvbW1pdFNoYSIsInByb21pc2VzIiwiY29tbWVudFBhdGgiLCJnZXREaWZmc0ZvckZpbGVQYXRoIiwiY2F0Y2giLCJ5dWJpa2lyaSIsInN0YXRlIiwidHJhbnNsYXRpb25zQnlGaWxlIiwiTWFwIiwic3VicyIsIkNvbXBvc2l0ZURpc3Bvc2FibGUiLCJnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMiLCJwcmV2UGF0aHMiLCJTZXQiLCJrZXlzIiwiY2hhbmdlZCIsInRocmVhZCIsImNvbW1lbnRUaHJlYWRzIiwicmVsUGF0aCIsImNvbW1lbnRzIiwicGF0aCIsInRvTmF0aXZlUGF0aFNlcCIsImV4aXN0aW5nIiwiZ2V0IiwiRmlsZVRyYW5zbGF0aW9uIiwic2V0IiwiYWRkQ29tbWVudFRocmVhZCIsImRlbGV0ZSIsIm9sZFBhdGgiLCJkZWxldGVkIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJkaXNwb3NlIiwicmVuZGVyIiwiY3JlYXRlRWxlbWVudCIsIm1vZGVsIiwiZmV0Y2hEYXRhIiwiZmV0Y2hQYXJhbXMiLCJkaWZmc0J5UGF0aCIsImNoaWxkcmVuIiwidXBkYXRlSWZOZWNlc3NhcnkiLCJtdWx0aUZpbGVQYXRjaCIsImRpZmZzIiwiZGlmZlBvc2l0aW9uRm4iLCJkaWZmUG9zaXRpb25Ub0ZpbGVQb3NpdGlvbiIsInRyYW5zbGF0ZVBvc2l0aW9uRm4iLCJ0cmFuc2xhdGVMaW5lc0dpdmVuRGlmZiIsImV4cG9ydHMiLCJQcm9wVHlwZXMiLCJvYmplY3QiLCJpc1JlcXVpcmVkIiwiYXJyYXlPZiIsInNoYXBlIiwicG9zaXRpb24iLCJudW1iZXIiLCJzdHJpbmciLCJmdW5jIiwiZGlkVHJhbnNsYXRlIiwibmF0aXZlUmVsUGF0aCIsInJhd1Bvc2l0aW9ucyIsImRpZmZUb0ZpbGVQb3NpdGlvbiIsInJlbW92ZWQiLCJmaWxlVHJhbnNsYXRpb25zIiwiZGlnZXN0IiwibGFzdCIsImFkZCIsInVwZGF0ZSIsImZpbGVQYXRjaCIsImdldFBhdGNoRm9yUGF0aCIsImdldFJlbmRlclN0YXR1cyIsImlzVmlzaWJsZSIsImdldFJhd0NvbnRlbnRQYXRjaCIsImNvbnRlbnRDaGFuZ2VEaWZmIiwibGVuZ3RoIiwiZGlmZjEiLCJkaWZmMiIsIm9sZE1vZGUiLCJGaWxlIiwibW9kZXMiLCJTWU1MSU5LIiwibmV3TW9kZSIsImZpbGVQb3NpdGlvbnMiLCJ2YWx1ZXMiLCJoYXNoIiwiY3J5cHRvIiwiY3JlYXRlSGFzaCIsIkpTT04iLCJzdHJpbmdpZnkiLCJBcnJheSIsImZyb20iLCJlbnRyaWVzIl0sInNvdXJjZXMiOlsiY29tbWVudC1wb3NpdGlvbmluZy1jb250YWluZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5pbXBvcnQge0NvbXBvc2l0ZURpc3Bvc2FibGV9IGZyb20gJ2V2ZW50LWtpdCc7XG5pbXBvcnQgeXViaWtpcmkgZnJvbSAneXViaWtpcmknO1xuaW1wb3J0IHt0cmFuc2xhdGVMaW5lc0dpdmVuRGlmZiwgZGlmZlBvc2l0aW9uVG9GaWxlUG9zaXRpb259IGZyb20gJ3doYXRzLW15LWxpbmUnO1xuXG5pbXBvcnQgRmlsZSBmcm9tICcuLi9tb2RlbHMvcGF0Y2gvZmlsZSc7XG5pbXBvcnQgT2JzZXJ2ZU1vZGVsIGZyb20gJy4uL3ZpZXdzL29ic2VydmUtbW9kZWwnO1xuaW1wb3J0IHt0b05hdGl2ZVBhdGhTZXB9IGZyb20gJy4uL2hlbHBlcnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tZW50UG9zaXRpb25pbmdDb250YWluZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGxvY2FsUmVwb3NpdG9yeTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIG11bHRpRmlsZVBhdGNoOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgY29tbWVudFRocmVhZHM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBjb21tZW50czogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgcG9zaXRpb246IFByb3BUeXBlcy5udW1iZXIsXG4gICAgICAgIHBhdGg6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgIH0pKS5pc1JlcXVpcmVkLFxuICAgIH0pKSxcbiAgICBwckNvbW1pdFNoYTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXG4gICAgLy8gRm9yIHVuaXQgdGVzdCBpbmplY3Rpb25cbiAgICB0cmFuc2xhdGVMaW5lc0dpdmVuRGlmZjogUHJvcFR5cGVzLmZ1bmMsXG4gICAgZGlmZlBvc2l0aW9uVG9GaWxlUG9zaXRpb246IFByb3BUeXBlcy5mdW5jLFxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICB0cmFuc2xhdGVMaW5lc0dpdmVuRGlmZixcbiAgICBkaWZmUG9zaXRpb25Ub0ZpbGVQb3NpdGlvbixcbiAgICBkaWRUcmFuc2xhdGU6IC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovICgpID0+IHt9LFxuICB9XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge3RyYW5zbGF0aW9uc0J5RmlsZTogbmV3IE1hcCgpfTtcbiAgICB0aGlzLnN1YnMgPSBuZXcgQ29tcG9zaXRlRGlzcG9zYWJsZSgpO1xuICB9XG5cbiAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhwcm9wcywgc3RhdGUpIHtcbiAgICBjb25zdCBwcmV2UGF0aHMgPSBuZXcgU2V0KHN0YXRlLnRyYW5zbGF0aW9uc0J5RmlsZS5rZXlzKCkpO1xuICAgIGxldCBjaGFuZ2VkID0gZmFsc2U7XG5cbiAgICBmb3IgKGNvbnN0IHRocmVhZCBvZiBwcm9wcy5jb21tZW50VGhyZWFkcykge1xuICAgICAgY29uc3QgcmVsUGF0aCA9IHRocmVhZC5jb21tZW50c1swXS5wYXRoO1xuICAgICAgY29uc3QgY29tbWVudFBhdGggPSB0b05hdGl2ZVBhdGhTZXAocmVsUGF0aCk7XG5cbiAgICAgIGxldCBleGlzdGluZyA9IHN0YXRlLnRyYW5zbGF0aW9uc0J5RmlsZS5nZXQoY29tbWVudFBhdGgpO1xuICAgICAgaWYgKCFleGlzdGluZykge1xuICAgICAgICBleGlzdGluZyA9IG5ldyBGaWxlVHJhbnNsYXRpb24ocmVsUGF0aCk7XG4gICAgICAgIHN0YXRlLnRyYW5zbGF0aW9uc0J5RmlsZS5zZXQoY29tbWVudFBhdGgsIGV4aXN0aW5nKTtcbiAgICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgICB9XG4gICAgICBleGlzdGluZy5hZGRDb21tZW50VGhyZWFkKHRocmVhZCk7XG5cbiAgICAgIHByZXZQYXRocy5kZWxldGUoY29tbWVudFBhdGgpO1xuICAgIH1cblxuICAgIGZvciAoY29uc3Qgb2xkUGF0aCBvZiBwcmV2UGF0aHMpIHtcbiAgICAgIHN0YXRlLnRyYW5zbGF0aW9uc0J5RmlsZS5kZWxldGVkKG9sZFBhdGgpO1xuICAgICAgY2hhbmdlZCA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGNoYW5nZWQpIHtcbiAgICAgIHJldHVybiB7dHJhbnNsYXRpb25zQnlGaWxlOiBzdGF0ZS50cmFuc2xhdGlvbnNCeUZpbGV9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICB0aGlzLnN1YnMuZGlzcG9zZSgpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNvbW1lbnRQYXRocyA9IFsuLi50aGlzLnN0YXRlLnRyYW5zbGF0aW9uc0J5RmlsZS5rZXlzKCldO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxPYnNlcnZlTW9kZWxcbiAgICAgICAgbW9kZWw9e3RoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5fVxuICAgICAgICBmZXRjaERhdGE9e3RoaXMuZmV0Y2hEYXRhfVxuICAgICAgICBmZXRjaFBhcmFtcz17W2NvbW1lbnRQYXRocywgdGhpcy5wcm9wcy5wckNvbW1pdFNoYV19PlxuXG4gICAgICAgIHtkaWZmc0J5UGF0aCA9PiB7XG4gICAgICAgICAgaWYgKGRpZmZzQnlQYXRoID09PSBudWxsKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5wcm9wcy5jaGlsZHJlbihudWxsKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBmb3IgKGNvbnN0IGNvbW1lbnRQYXRoIG9mIGNvbW1lbnRQYXRocykge1xuICAgICAgICAgICAgdGhpcy5zdGF0ZS50cmFuc2xhdGlvbnNCeUZpbGUuZ2V0KGNvbW1lbnRQYXRoKS51cGRhdGVJZk5lY2Vzc2FyeSh7XG4gICAgICAgICAgICAgIG11bHRpRmlsZVBhdGNoOiB0aGlzLnByb3BzLm11bHRpRmlsZVBhdGNoLFxuICAgICAgICAgICAgICBkaWZmczogZGlmZnNCeVBhdGhbY29tbWVudFBhdGhdIHx8IFtdLFxuICAgICAgICAgICAgICBkaWZmUG9zaXRpb25GbjogdGhpcy5wcm9wcy5kaWZmUG9zaXRpb25Ub0ZpbGVQb3NpdGlvbixcbiAgICAgICAgICAgICAgdHJhbnNsYXRlUG9zaXRpb25GbjogdGhpcy5wcm9wcy50cmFuc2xhdGVMaW5lc0dpdmVuRGlmZixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNoaWxkcmVuKHRoaXMuc3RhdGUudHJhbnNsYXRpb25zQnlGaWxlKTtcbiAgICAgICAgfX1cblxuICAgICAgPC9PYnNlcnZlTW9kZWw+XG4gICAgKTtcbiAgfVxuXG4gIGZldGNoRGF0YSA9IChsb2NhbFJlcG9zaXRvcnksIGNvbW1lbnRQYXRocywgcHJDb21taXRTaGEpID0+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IHt9O1xuICAgIGZvciAoY29uc3QgY29tbWVudFBhdGggb2YgY29tbWVudFBhdGhzKSB7XG4gICAgICBwcm9taXNlc1tjb21tZW50UGF0aF0gPSBsb2NhbFJlcG9zaXRvcnkuZ2V0RGlmZnNGb3JGaWxlUGF0aChjb21tZW50UGF0aCwgcHJDb21taXRTaGEpLmNhdGNoKCgpID0+IFtdKTtcbiAgICB9XG4gICAgcmV0dXJuIHl1YmlraXJpKHByb21pc2VzKTtcbiAgfVxufVxuXG5jbGFzcyBGaWxlVHJhbnNsYXRpb24ge1xuICBjb25zdHJ1Y3RvcihyZWxQYXRoKSB7XG4gICAgdGhpcy5yZWxQYXRoID0gcmVsUGF0aDtcbiAgICB0aGlzLm5hdGl2ZVJlbFBhdGggPSB0b05hdGl2ZVBhdGhTZXAocmVsUGF0aCk7XG5cbiAgICB0aGlzLnJhd1Bvc2l0aW9ucyA9IG5ldyBTZXQoKTtcbiAgICB0aGlzLmRpZmZUb0ZpbGVQb3NpdGlvbiA9IG5ldyBNYXAoKTtcbiAgICB0aGlzLnJlbW92ZWQgPSBmYWxzZTtcbiAgICB0aGlzLmZpbGVUcmFuc2xhdGlvbnMgPSBudWxsO1xuICAgIHRoaXMuZGlnZXN0ID0gbnVsbDtcblxuICAgIHRoaXMubGFzdCA9IHttdWx0aUZpbGVQYXRjaDogbnVsbCwgZGlmZnM6IG51bGx9O1xuICB9XG5cbiAgYWRkQ29tbWVudFRocmVhZCh0aHJlYWQpIHtcbiAgICB0aGlzLnJhd1Bvc2l0aW9ucy5hZGQodGhyZWFkLmNvbW1lbnRzWzBdLnBvc2l0aW9uKTtcbiAgfVxuXG4gIHVwZGF0ZUlmTmVjZXNzYXJ5KHttdWx0aUZpbGVQYXRjaCwgZGlmZnMsIGRpZmZQb3NpdGlvbkZuLCB0cmFuc2xhdGVQb3NpdGlvbkZufSkge1xuICAgIGlmIChcbiAgICAgIHRoaXMubGFzdC5tdWx0aUZpbGVQYXRjaCA9PT0gbXVsdGlGaWxlUGF0Y2ggJiZcbiAgICAgIHRoaXMubGFzdC5kaWZmcyA9PT0gZGlmZnNcbiAgICApIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICB0aGlzLmxhc3QubXVsdGlGaWxlUGF0Y2ggPSBtdWx0aUZpbGVQYXRjaDtcbiAgICB0aGlzLmxhc3QuZGlmZnMgPSBkaWZmcztcblxuICAgIHJldHVybiB0aGlzLnVwZGF0ZSh7bXVsdGlGaWxlUGF0Y2gsIGRpZmZzLCBkaWZmUG9zaXRpb25GbiwgdHJhbnNsYXRlUG9zaXRpb25Gbn0pO1xuICB9XG5cbiAgdXBkYXRlKHttdWx0aUZpbGVQYXRjaCwgZGlmZnMsIGRpZmZQb3NpdGlvbkZuLCB0cmFuc2xhdGVQb3NpdGlvbkZufSkge1xuICAgIGNvbnN0IGZpbGVQYXRjaCA9IG11bHRpRmlsZVBhdGNoLmdldFBhdGNoRm9yUGF0aCh0aGlzLm5hdGl2ZVJlbFBhdGgpO1xuICAgIC8vIENvbW1lbnQgb24gYSBmaWxlIHRoYXQgdXNlZCB0byBleGlzdCBpbiBhIFBSIGJ1dCBubyBsb25nZXIgZG9lcy4gU2tpcCBzaWxlbnRseS5cbiAgICBpZiAoIWZpbGVQYXRjaCkge1xuICAgICAgdGhpcy5kaWZmVG9GaWxlUG9zaXRpb24gPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLnJlbW92ZWQgPSBmYWxzZTtcbiAgICAgIHRoaXMuZmlsZVRyYW5zbGF0aW9ucyA9IG51bGw7XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBUaGlzIGNvbW1lbnQgd2FzIGxlZnQgb24gYSBmaWxlIHRoYXQgd2FzIHRvbyBsYXJnZSB0byBwYXJzZS5cbiAgICBpZiAoIWZpbGVQYXRjaC5nZXRSZW5kZXJTdGF0dXMoKS5pc1Zpc2libGUoKSkge1xuICAgICAgdGhpcy5kaWZmVG9GaWxlUG9zaXRpb24gPSBuZXcgTWFwKCk7XG4gICAgICB0aGlzLnJlbW92ZWQgPSB0cnVlO1xuICAgICAgdGhpcy5maWxlVHJhbnNsYXRpb25zID0gbnVsbDtcblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuZGlmZlRvRmlsZVBvc2l0aW9uID0gZGlmZlBvc2l0aW9uRm4odGhpcy5yYXdQb3NpdGlvbnMsIGZpbGVQYXRjaC5nZXRSYXdDb250ZW50UGF0Y2goKSk7XG4gICAgdGhpcy5yZW1vdmVkID0gZmFsc2U7XG5cbiAgICBsZXQgY29udGVudENoYW5nZURpZmY7XG4gICAgaWYgKGRpZmZzLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29udGVudENoYW5nZURpZmYgPSBkaWZmc1swXTtcbiAgICB9IGVsc2UgaWYgKGRpZmZzLmxlbmd0aCA9PT0gMikge1xuICAgICAgY29uc3QgW2RpZmYxLCBkaWZmMl0gPSBkaWZmcztcbiAgICAgIGlmIChkaWZmMS5vbGRNb2RlID09PSBGaWxlLm1vZGVzLlNZTUxJTksgfHwgZGlmZjEubmV3TW9kZSA9PT0gRmlsZS5tb2Rlcy5TWU1MSU5LKSB7XG4gICAgICAgIGNvbnRlbnRDaGFuZ2VEaWZmID0gZGlmZjI7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb250ZW50Q2hhbmdlRGlmZiA9IGRpZmYxO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChjb250ZW50Q2hhbmdlRGlmZikge1xuICAgICAgY29uc3QgZmlsZVBvc2l0aW9ucyA9IFsuLi50aGlzLmRpZmZUb0ZpbGVQb3NpdGlvbi52YWx1ZXMoKV07XG4gICAgICB0aGlzLmZpbGVUcmFuc2xhdGlvbnMgPSB0cmFuc2xhdGVQb3NpdGlvbkZuKGZpbGVQb3NpdGlvbnMsIGNvbnRlbnRDaGFuZ2VEaWZmKTtcblxuICAgICAgY29uc3QgaGFzaCA9IGNyeXB0by5jcmVhdGVIYXNoKCdzaGEyNTYnKTtcbiAgICAgIGhhc2gudXBkYXRlKEpTT04uc3RyaW5naWZ5KEFycmF5LmZyb20odGhpcy5maWxlVHJhbnNsYXRpb25zLmVudHJpZXMoKSkpKTtcbiAgICAgIHRoaXMuZGlnZXN0ID0gaGFzaC5kaWdlc3QoJ2hleCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmZpbGVUcmFuc2xhdGlvbnMgPSBudWxsO1xuICAgICAgdGhpcy5kaWdlc3QgPSBudWxsO1xuICAgIH1cbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxZQUFBLEdBQUFMLE9BQUE7QUFFQSxJQUFBTSxLQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTyxhQUFBLEdBQUFSLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBUSxRQUFBLEdBQUFSLE9BQUE7QUFBMkMsU0FBQUQsdUJBQUFVLEdBQUEsV0FBQUEsR0FBQSxJQUFBQSxHQUFBLENBQUFDLFVBQUEsR0FBQUQsR0FBQSxLQUFBRSxPQUFBLEVBQUFGLEdBQUE7QUFBQSxTQUFBRyxnQkFBQUgs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