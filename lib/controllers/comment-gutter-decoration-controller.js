"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _atom = require("atom");
var _propTypes = _interopRequireDefault(require("prop-types"));
var _propTypes2 = require("../prop-types");
var _decoration = _interopRequireDefault(require("../atom/decoration"));
var _marker = _interopRequireDefault(require("../atom/marker"));
var _reviewsItem = _interopRequireDefault(require("../items/reviews-item"));
var _reporterProxy = require("../reporter-proxy");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
class CommentGutterDecorationController extends _react.default.Component {
  render() {
    const range = _atom.Range.fromObject([[this.props.commentRow, 0], [this.props.commentRow, Infinity]]);
    return _react.default.createElement(_marker.default, {
      key: `github-comment-gutter-decoration-${this.props.threadId}`,
      editor: this.props.editor,
      exclusive: true,
      invalidate: "surround",
      bufferRange: range
    }, _react.default.createElement(_decoration.default, {
      editor: this.props.editor,
      type: "gutter",
      gutterName: "github-comment-icon",
      className: `github-editorCommentGutterIcon ${this.props.extraClasses.join(' ')}`,
      omitEmptyLastRow: false
    }, _react.default.createElement("button", {
      className: "icon icon-comment",
      onClick: () => this.openReviewThread(this.props.threadId)
    })));
  }
  async openReviewThread(threadId) {
    const uri = _reviewsItem.default.buildURI({
      host: this.props.endpoint.getHost(),
      owner: this.props.owner,
      repo: this.props.repo,
      number: this.props.number,
      workdir: this.props.workdir
    });
    const reviewsItem = await this.props.workspace.open(uri, {
      searchAllPanes: true
    });
    reviewsItem.jumpToThread(threadId);
    (0, _reporterProxy.addEvent)('open-review-thread', {
      package: 'github',
      from: this.props.parent
    });
  }
}
exports.default = CommentGutterDecorationController;
_defineProperty(CommentGutterDecorationController, "propTypes", {
  commentRow: _propTypes.default.number.isRequired,
  threadId: _propTypes.default.string.isRequired,
  extraClasses: _propTypes.default.array,
  workspace: _propTypes.default.object.isRequired,
  endpoint: _propTypes2.EndpointPropType.isRequired,
  owner: _propTypes.default.string.isRequired,
  repo: _propTypes.default.string.isRequired,
  number: _propTypes.default.number.isRequired,
  workdir: _propTypes.default.string.isRequired,
  editor: _propTypes.default.object,
  // For metric reporting
  parent: _propTypes.default.string.isRequired
});
_defineProperty(CommentGutterDecorationController, "defaultProps", {
  extraClasses: []
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9hdG9tIiwiX3Byb3BUeXBlcyIsIl9wcm9wVHlwZXMyIiwiX2RlY29yYXRpb24iLCJfbWFya2VyIiwiX3Jldmlld3NJdGVtIiwiX3JlcG9ydGVyUHJveHkiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZpbmVQcm9wZXJ0eSIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsInQiLCJpIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiciIsImUiLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJDb21tZW50R3V0dGVyRGVjb3JhdGlvbkNvbnRyb2xsZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsInJlbmRlciIsInJhbmdlIiwiUmFuZ2UiLCJmcm9tT2JqZWN0IiwicHJvcHMiLCJjb21tZW50Um93IiwiSW5maW5pdHkiLCJjcmVhdGVFbGVtZW50IiwidGhyZWFkSWQiLCJlZGl0b3IiLCJleGNsdXNpdmUiLCJpbnZhbGlkYXRlIiwiYnVmZmVyUmFuZ2UiLCJ0eXBlIiwiZ3V0dGVyTmFtZSIsImNsYXNzTmFtZSIsImV4dHJhQ2xhc3NlcyIsImpvaW4iLCJvbWl0RW1wdHlMYXN0Um93Iiwib25DbGljayIsIm9wZW5SZXZpZXdUaHJlYWQiLCJ1cmkiLCJSZXZpZXdzSXRlbSIsImJ1aWxkVVJJIiwiaG9zdCIsImVuZHBvaW50IiwiZ2V0SG9zdCIsIm93bmVyIiwicmVwbyIsIm51bWJlciIsIndvcmtkaXIiLCJyZXZpZXdzSXRlbSIsIndvcmtzcGFjZSIsIm9wZW4iLCJzZWFyY2hBbGxQYW5lcyIsImp1bXBUb1RocmVhZCIsImFkZEV2ZW50IiwicGFja2FnZSIsImZyb20iLCJwYXJlbnQiLCJleHBvcnRzIiwiUHJvcFR5cGVzIiwiaXNSZXF1aXJlZCIsInN0cmluZyIsImFycmF5Iiwib2JqZWN0IiwiRW5kcG9pbnRQcm9wVHlwZSJdLCJzb3VyY2VzIjpbImNvbW1lbnQtZ3V0dGVyLWRlY29yYXRpb24tY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtSYW5nZX0gZnJvbSAnYXRvbSc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtFbmRwb2ludFByb3BUeXBlfSBmcm9tICcuLi9wcm9wLXR5cGVzJztcbmltcG9ydCBEZWNvcmF0aW9uIGZyb20gJy4uL2F0b20vZGVjb3JhdGlvbic7XG5pbXBvcnQgTWFya2VyIGZyb20gJy4uL2F0b20vbWFya2VyJztcbmltcG9ydCBSZXZpZXdzSXRlbSBmcm9tICcuLi9pdGVtcy9yZXZpZXdzLWl0ZW0nO1xuaW1wb3J0IHthZGRFdmVudH0gZnJvbSAnLi4vcmVwb3J0ZXItcHJveHknO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb21tZW50R3V0dGVyRGVjb3JhdGlvbkNvbnRyb2xsZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIGNvbW1lbnRSb3c6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICB0aHJlYWRJZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIGV4dHJhQ2xhc3NlczogUHJvcFR5cGVzLmFycmF5LFxuXG4gICAgd29ya3NwYWNlOiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgZW5kcG9pbnQ6IEVuZHBvaW50UHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBvd25lcjogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgIHJlcG86IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICBudW1iZXI6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICB3b3JrZGlyOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgZWRpdG9yOiBQcm9wVHlwZXMub2JqZWN0LFxuXG4gICAgLy8gRm9yIG1ldHJpYyByZXBvcnRpbmdcbiAgICBwYXJlbnQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgfTtcblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0ge1xuICAgIGV4dHJhQ2xhc3NlczogW10sXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgcmFuZ2UgPSBSYW5nZS5mcm9tT2JqZWN0KFtbdGhpcy5wcm9wcy5jb21tZW50Um93LCAwXSwgW3RoaXMucHJvcHMuY29tbWVudFJvdywgSW5maW5pdHldXSk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxNYXJrZXJcbiAgICAgICAga2V5PXtgZ2l0aHViLWNvbW1lbnQtZ3V0dGVyLWRlY29yYXRpb24tJHt0aGlzLnByb3BzLnRocmVhZElkfWB9XG4gICAgICAgIGVkaXRvcj17dGhpcy5wcm9wcy5lZGl0b3J9XG4gICAgICAgIGV4Y2x1c2l2ZT17dHJ1ZX1cbiAgICAgICAgaW52YWxpZGF0ZT1cInN1cnJvdW5kXCJcbiAgICAgICAgYnVmZmVyUmFuZ2U9e3JhbmdlfT5cbiAgICAgICAgPERlY29yYXRpb25cbiAgICAgICAgICBlZGl0b3I9e3RoaXMucHJvcHMuZWRpdG9yfVxuICAgICAgICAgIHR5cGU9XCJndXR0ZXJcIlxuICAgICAgICAgIGd1dHRlck5hbWU9XCJnaXRodWItY29tbWVudC1pY29uXCJcbiAgICAgICAgICBjbGFzc05hbWU9e2BnaXRodWItZWRpdG9yQ29tbWVudEd1dHRlckljb24gJHt0aGlzLnByb3BzLmV4dHJhQ2xhc3Nlcy5qb2luKCcgJyl9YH1cbiAgICAgICAgICBvbWl0RW1wdHlMYXN0Um93PXtmYWxzZX0+XG4gICAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJpY29uIGljb24tY29tbWVudFwiIG9uQ2xpY2s9eygpID0+IHRoaXMub3BlblJldmlld1RocmVhZCh0aGlzLnByb3BzLnRocmVhZElkKX0gLz5cbiAgICAgICAgPC9EZWNvcmF0aW9uPlxuICAgICAgPC9NYXJrZXI+XG4gICAgKTtcbiAgfVxuXG4gIGFzeW5jIG9wZW5SZXZpZXdUaHJlYWQodGhyZWFkSWQpIHtcbiAgICBjb25zdCB1cmkgPSBSZXZpZXdzSXRlbS5idWlsZFVSSSh7XG4gICAgICBob3N0OiB0aGlzLnByb3BzLmVuZHBvaW50LmdldEhvc3QoKSxcbiAgICAgIG93bmVyOiB0aGlzLnByb3BzLm93bmVyLFxuICAgICAgcmVwbzogdGhpcy5wcm9wcy5yZXBvLFxuICAgICAgbnVtYmVyOiB0aGlzLnByb3BzLm51bWJlcixcbiAgICAgIHdvcmtkaXI6IHRoaXMucHJvcHMud29ya2RpcixcbiAgICB9KTtcbiAgICBjb25zdCByZXZpZXdzSXRlbSA9IGF3YWl0IHRoaXMucHJvcHMud29ya3NwYWNlLm9wZW4odXJpLCB7c2VhcmNoQWxsUGFuZXM6IHRydWV9KTtcbiAgICByZXZpZXdzSXRlbS5qdW1wVG9UaHJlYWQodGhyZWFkSWQpO1xuICAgIGFkZEV2ZW50KCdvcGVuLXJldmlldy10aHJlYWQnLCB7cGFja2FnZTogJ2dpdGh1YicsIGZyb206IHRoaXMucHJvcHMucGFyZW50fSk7XG4gIH1cblxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxVQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxXQUFBLEdBQUFILE9BQUE7QUFDQSxJQUFBSSxXQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxPQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxZQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTyxjQUFBLEdBQUFQLE9BQUE7QUFBMkMsU0FBQUQsdUJBQUFTLEdB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