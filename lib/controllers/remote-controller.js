"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _electron = require("electron");
var _reporterProxy = require("../reporter-proxy");
var _propTypes2 = require("../prop-types");
var _issueishSearchesController = _interopRequireDefault(require("./issueish-searches-controller"));
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class RemoteController extends _react.default.Component {
  constructor(...args) {
    super(...args);
    _defineProperty(this, "onCreatePr", async () => {
      const currentBranch = this.props.branches.getHeadBranch();
      const upstream = currentBranch.getUpstream();
      if (!upstream.isPresent() || this.props.aheadCount > 0) {
        await this.props.onPushBranch();
      }
      let createPrUrl = 'https://github.com/';
      createPrUrl += this.props.remote.getOwner() + '/' + this.props.remote.getRepo();
      createPrUrl += '/compare/' + encodeURIComponent(currentBranch.getName());
      createPrUrl += '?expand=1';
      await _electron.shell.openExternal(createPrUrl);
      (0, _reporterProxy.incrementCounter)('create-pull-request');
    });
  }
  render() {
    return _react.default.createElement(_issueishSearchesController.default, {
      endpoint: this.props.endpoint,
      token: this.props.token,
      workingDirectory: this.props.workingDirectory,
      repository: this.props.repository,
      workspace: this.props.workspace,
      remote: this.props.remote,
      remotes: this.props.remotes,
      branches: this.props.branches,
      aheadCount: this.props.aheadCount,
      pushInProgress: this.props.pushInProgress,
      onCreatePr: this.onCreatePr
    });
  }
}
exports.default = RemoteController;
_defineProperty(RemoteController, "propTypes", {
  // Relay payload
  repository: _propTypes.default.shape({
    id: _propTypes.default.string.isRequired,
    defaultBranchRef: _propTypes.default.shape({
      prefix: _propTypes.default.string.isRequired,
      name: _propTypes.default.string.isRequired
    })
  }),
  // Connection
  endpoint: _propTypes2.EndpointPropType.isRequired,
  token: _propTypes2.TokenPropType.isRequired,
  // Repository derived attributes
  workingDirectory: _propTypes.default.string,
  workspace: _propTypes.default.object.isRequired,
  remote: _propTypes2.RemotePropType.isRequired,
  remotes: _propTypes2.RemoteSetPropType.isRequired,
  branches: _propTypes2.BranchSetPropType.isRequired,
  aheadCount: _propTypes.default.number,
  pushInProgress: _propTypes.default.bool.isRequired,
  // Actions
  onPushBranch: _propTypes.default.func.isRequired
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfZWxlY3Ryb24iLCJfcmVwb3J0ZXJQcm94eSIsIl9wcm9wVHlwZXMyIiwiX2lzc3VlaXNoU2VhcmNoZXNDb250cm9sbGVyIiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJ2YWx1ZSIsIl90b1Byb3BlcnR5S2V5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJhcmciLCJfdG9QcmltaXRpdmUiLCJTdHJpbmciLCJpbnB1dCIsImhpbnQiLCJwcmltIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJ1bmRlZmluZWQiLCJyZXMiLCJjYWxsIiwiVHlwZUVycm9yIiwiTnVtYmVyIiwiUmVtb3RlQ29udHJvbGxlciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJhcmdzIiwiY3VycmVudEJyYW5jaCIsInByb3BzIiwiYnJhbmNoZXMiLCJnZXRIZWFkQnJhbmNoIiwidXBzdHJlYW0iLCJnZXRVcHN0cmVhbSIsImlzUHJlc2VudCIsImFoZWFkQ291bnQiLCJvblB1c2hCcmFuY2giLCJjcmVhdGVQclVybCIsInJlbW90ZSIsImdldE93bmVyIiwiZ2V0UmVwbyIsImVuY29kZVVSSUNvbXBvbmVudCIsImdldE5hbWUiLCJzaGVsbCIsIm9wZW5FeHRlcm5hbCIsImluY3JlbWVudENvdW50ZXIiLCJyZW5kZXIiLCJjcmVhdGVFbGVtZW50IiwiZW5kcG9pbnQiLCJ0b2tlbiIsIndvcmtpbmdEaXJlY3RvcnkiLCJyZXBvc2l0b3J5Iiwid29ya3NwYWNlIiwicmVtb3RlcyIsInB1c2hJblByb2dyZXNzIiwib25DcmVhdGVQciIsImV4cG9ydHMiLCJQcm9wVHlwZXMiLCJzaGFwZSIsImlkIiwic3RyaW5nIiwiaXNSZXF1aXJlZCIsImRlZmF1bHRCcmFuY2hSZWYiLCJwcmVmaXgiLCJuYW1lIiwiRW5kcG9pbnRQcm9wVHlwZSIsIlRva2VuUHJvcFR5cGUiLCJvYmplY3QiLCJSZW1vdGVQcm9wVHlwZSIsIlJlbW90ZVNldFByb3BUeXBlIiwiQnJhbmNoU2V0UHJvcFR5cGUiLCJudW1iZXIiLCJib29sIiwiZnVuYyJdLCJzb3VyY2VzIjpbInJlbW90ZS1jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtzaGVsbH0gZnJvbSAnZWxlY3Ryb24nO1xuXG5pbXBvcnQge2luY3JlbWVudENvdW50ZXJ9IGZyb20gJy4uL3JlcG9ydGVyLXByb3h5JztcbmltcG9ydCB7UmVtb3RlUHJvcFR5cGUsIFJlbW90ZVNldFByb3BUeXBlLCBCcmFuY2hTZXRQcm9wVHlwZSwgRW5kcG9pbnRQcm9wVHlwZSwgVG9rZW5Qcm9wVHlwZX0gZnJvbSAnLi4vcHJvcC10eXBlcyc7XG5pbXBvcnQgSXNzdWVpc2hTZWFyY2hlc0NvbnRyb2xsZXIgZnJvbSAnLi9pc3N1ZWlzaC1zZWFyY2hlcy1jb250cm9sbGVyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUmVtb3RlQ29udHJvbGxlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLy8gUmVsYXkgcGF5bG9hZFxuICAgIHJlcG9zaXRvcnk6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBpZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgZGVmYXVsdEJyYW5jaFJlZjogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgcHJlZml4OiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIG5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgIH0pLFxuICAgIH0pLFxuXG4gICAgLy8gQ29ubmVjdGlvblxuICAgIGVuZHBvaW50OiBFbmRwb2ludFByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgdG9rZW46IFRva2VuUHJvcFR5cGUuaXNSZXF1aXJlZCxcblxuICAgIC8vIFJlcG9zaXRvcnkgZGVyaXZlZCBhdHRyaWJ1dGVzXG4gICAgd29ya2luZ0RpcmVjdG9yeTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICB3b3Jrc3BhY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICByZW1vdGU6IFJlbW90ZVByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgcmVtb3RlczogUmVtb3RlU2V0UHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBicmFuY2hlczogQnJhbmNoU2V0UHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBhaGVhZENvdW50OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIHB1c2hJblByb2dyZXNzOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuXG4gICAgLy8gQWN0aW9uc1xuICAgIG9uUHVzaEJyYW5jaDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPElzc3VlaXNoU2VhcmNoZXNDb250cm9sbGVyXG4gICAgICAgIGVuZHBvaW50PXt0aGlzLnByb3BzLmVuZHBvaW50fVxuICAgICAgICB0b2tlbj17dGhpcy5wcm9wcy50b2tlbn1cblxuICAgICAgICB3b3JraW5nRGlyZWN0b3J5PXt0aGlzLnByb3BzLndvcmtpbmdEaXJlY3Rvcnl9XG4gICAgICAgIHJlcG9zaXRvcnk9e3RoaXMucHJvcHMucmVwb3NpdG9yeX1cblxuICAgICAgICB3b3Jrc3BhY2U9e3RoaXMucHJvcHMud29ya3NwYWNlfVxuICAgICAgICByZW1vdGU9e3RoaXMucHJvcHMucmVtb3RlfVxuICAgICAgICByZW1vdGVzPXt0aGlzLnByb3BzLnJlbW90ZXN9XG4gICAgICAgIGJyYW5jaGVzPXt0aGlzLnByb3BzLmJyYW5jaGVzfVxuICAgICAgICBhaGVhZENvdW50PXt0aGlzLnByb3BzLmFoZWFkQ291bnR9XG4gICAgICAgIHB1c2hJblByb2dyZXNzPXt0aGlzLnByb3BzLnB1c2hJblByb2dyZXNzfVxuXG4gICAgICAgIG9uQ3JlYXRlUHI9e3RoaXMub25DcmVhdGVQcn1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIG9uQ3JlYXRlUHIgPSBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY3VycmVudEJyYW5jaCA9IHRoaXMucHJvcHMuYnJhbmNoZXMuZ2V0SGVhZEJyYW5jaCgpO1xuICAgIGNvbnN0IHVwc3RyZWFtID0gY3VycmVudEJyYW5jaC5nZXRVcHN0cmVhbSgpO1xuICAgIGlmICghdXBzdHJlYW0uaXNQcmVzZW50KCkgfHwgdGhpcy5wcm9wcy5haGVhZENvdW50ID4gMCkge1xuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5vblB1c2hCcmFuY2goKTtcbiAgICB9XG5cbiAgICBsZXQgY3JlYXRlUHJVcmwgPSAnaHR0cHM6Ly9naXRodWIuY29tLyc7XG4gICAgY3JlYXRlUHJVcmwgKz0gdGhpcy5wcm9wcy5yZW1vdGUuZ2V0T3duZXIoKSArICcvJyArIHRoaXMucHJvcHMucmVtb3RlLmdldFJlcG8oKTtcbiAgICBjcmVhdGVQclVybCArPSAnL2NvbXBhcmUvJyArIGVuY29kZVVSSUNvbXBvbmVudChjdXJyZW50QnJhbmNoLmdldE5hbWUoKSk7XG4gICAgY3JlYXRlUHJVcmwgKz0gJz9leHBhbmQ9MSc7XG5cbiAgICBhd2FpdCBzaGVsbC5vcGVuRXh0ZXJuYWwoY3JlYXRlUHJVcmwpO1xuICAgIGluY3JlbWVudENvdW50ZXIoJ2NyZWF0ZS1wdWxsLXJlcXVlc3QnKTtcbiAgfVxufVxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFGLE9BQUE7QUFFQSxJQUFB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