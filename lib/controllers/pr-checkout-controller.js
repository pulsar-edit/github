"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BarePullRequestCheckoutController = exports.checkoutStates = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _reactRelay = require("react-relay");
var _enableableOperation = _interopRequireDefault(require("../models/enableable-operation"));
var _gitShellOutStrategy = require("../git-shell-out-strategy");
var _propTypes2 = require("../prop-types");
var _reporterProxy = require("../reporter-proxy");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
class CheckoutState {
  constructor(name) {
    this.name = name;
  }
  when(cases) {
    return cases[this.name] || cases.default;
  }
}
const checkoutStates = {
  HIDDEN: new CheckoutState('hidden'),
  DISABLED: new CheckoutState('disabled'),
  BUSY: new CheckoutState('busy'),
  CURRENT: new CheckoutState('current')
};
exports.checkoutStates = checkoutStates;
class BarePullRequestCheckoutController extends _react.default.Component {
  constructor(props) {
    super(props);
    this.state = {
      checkoutInProgress: false
    };
    this.checkoutOp = new _enableableOperation.default(() => this.checkout().catch(e => {
      if (!(e instanceof _gitShellOutStrategy.GitError)) {
        throw e;
      }
    }));
    this.checkoutOp.toggleState(this, 'checkoutInProgress');
  }
  render() {
    return this.props.children(this.nextCheckoutOp());
  }
  nextCheckoutOp() {
    const {
      repository,
      pullRequest
    } = this.props;
    if (this.props.isAbsent) {
      return this.checkoutOp.disable(checkoutStates.HIDDEN, 'No repository found');
    }
    if (this.props.isLoading) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Loading');
    }
    if (!this.props.isPresent) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'No repository found');
    }
    if (this.props.isMerging) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Merge in progress');
    }
    if (this.props.isRebasing) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Rebase in progress');
    }
    if (this.state.checkoutInProgress) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Checking out...');
    }

    // determine if pullRequest.headRepository is null
    // this can happen if a repository has been deleted.
    if (!pullRequest.headRepository) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Pull request head repository does not exist');
    }

    // Determine if we already have this PR checked out.

    const headPush = this.props.branches.getHeadBranch().getPush();
    const headRemote = this.props.remotes.withName(headPush.getRemoteName());

    // (detect checkout from pull/### refspec)
    const fromPullRefspec = headRemote.getOwner() === repository.owner.login && headRemote.getRepo() === repository.name && headPush.getShortRemoteRef() === `pull/${pullRequest.number}/head`;

    // (detect checkout from head repository)
    const fromHeadRepo = headRemote.getOwner() === pullRequest.headRepository.owner.login && headRemote.getRepo() === pullRequest.headRepository.name && headPush.getShortRemoteRef() === pullRequest.headRefName;
    if (fromPullRefspec || fromHeadRepo) {
      return this.checkoutOp.disable(checkoutStates.CURRENT, 'Current');
    }
    return this.checkoutOp.enable();
  }
  async checkout() {
    const {
      pullRequest
    } = this.props;
    const {
      headRepository
    } = pullRequest;
    const fullHeadRef = `refs/heads/${pullRequest.headRefName}`;
    let sourceRemoteName, localRefName;

    // Discover or create a remote pointing to the repo containing the pull request's head ref.
    // If the local repository already has the head repository specified as a remote, that remote will be used, so
    // that any related configuration is picked up for the fetch. Otherwise, the head repository fetch URL is used
    // directly.
    const headRemotes = this.props.remotes.matchingGitHubRepository(headRepository.owner.login, headRepository.name);
    if (headRemotes.length > 0) {
      sourceRemoteName = headRemotes[0].getName();
    } else {
      const url = {
        https: headRepository.url + '.git',
        ssh: headRepository.sshUrl
      }[this.props.remotes.mostUsedProtocol(['https', 'ssh'])];

      // This will throw if a remote with this name already exists (and points somewhere else, or we would have found
      // it above). ¯\_(ツ)_/¯
      const remote = await this.props.localRepository.addRemote(headRepository.owner.login, url);
      sourceRemoteName = remote.getName();
    }

    // Identify an existing local ref that already corresponds to the pull request, if one exists. Otherwise, generate
    // a new local ref name.
    const pullTargets = this.props.branches.getPullTargets(sourceRemoteName, fullHeadRef);
    if (pullTargets.length > 0) {
      localRefName = pullTargets[0].getName();

      // Check out the existing local ref.
      await this.props.localRepository.checkout(localRefName);
      try {
        await this.props.localRepository.pull(fullHeadRef, {
          remoteName: sourceRemoteName,
          ffOnly: true
        });
      } finally {
        (0, _reporterProxy.incrementCounter)('checkout-pr');
      }
      return;
    }
    await this.props.localRepository.fetch(fullHeadRef, {
      remoteName: sourceRemoteName
    });

    // Check out the local ref and set it up to track the head ref.
    await this.props.localRepository.checkout(`pr-${pullRequest.number}/${headRepository.owner.login}/${pullRequest.headRefName}`, {
      createNew: true,
      track: true,
      startPoint: `refs/remotes/${sourceRemoteName}/${pullRequest.headRefName}`
    });
    (0, _reporterProxy.incrementCounter)('checkout-pr');
  }
}
exports.BarePullRequestCheckoutController = BarePullRequestCheckoutController;
_defineProperty(BarePullRequestCheckoutController, "propTypes", {
  // GraphQL response
  repository: _propTypes.default.shape({
    name: _propTypes.default.string.isRequired,
    owner: _propTypes.default.shape({
      login: _propTypes.default.string.isRequired
    }).isRequired
  }).isRequired,
  pullRequest: _propTypes.default.shape({
    number: _propTypes.default.number.isRequired,
    headRefName: _propTypes.default.string.isRequired,
    headRepository: _propTypes.default.shape({
      name: _propTypes.default.string.isRequired,
      url: _propTypes.default.string.isRequired,
      sshUrl: _propTypes.default.string.isRequired,
      owner: _propTypes.default.shape({
        login: _propTypes.default.string.isRequired
      })
    })
  }).isRequired,
  // Repository model and attributes
  localRepository: _propTypes.default.object.isRequired,
  isAbsent: _propTypes.default.bool.isRequired,
  isLoading: _propTypes.default.bool.isRequired,
  isPresent: _propTypes.default.bool.isRequired,
  isMerging: _propTypes.default.bool.isRequired,
  isRebasing: _propTypes.default.bool.isRequired,
  branches: _propTypes2.BranchSetPropType.isRequired,
  remotes: _propTypes2.RemoteSetPropType.isRequired,
  children: _propTypes.default.func.isRequired
});
var _default = (0, _reactRelay.createFragmentContainer)(BarePullRequestCheckoutController, {
  repository: function () {
    const node = require("./__generated__/prCheckoutController_repository.graphql");
    if (node.hash && node.hash !== "b2212745240c03ff8fc7cb13dfc63183") {
      console.error("The definition of 'prCheckoutController_repository' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prCheckoutController_repository.graphql");
  },
  pullRequest: function () {
    const node = require("./__generated__/prCheckoutController_pullRequest.graphql");
    if (node.hash && node.hash !== "66e001f389a2c4f74c1369cf69b31268") {
      console.error("The definition of 'prCheckoutController_pullRequest' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prCheckoutController_pullRequest.graphql");
  }
});
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfcmVhY3RSZWxheSIsIl9lbmFibGVhYmxlT3BlcmF0aW9uIiwiX2dpdFNoZWxsT3V0U3RyYXRlZ3kiLCJfcHJvcFR5cGVzMiIsIl9yZXBvcnRlclByb3h5Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJ2YWx1ZSIsIl90b1Byb3BlcnR5S2V5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJ0IiwiaSIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsInIiLCJlIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJjYWxsIiwiVHlwZUVycm9yIiwiTnVtYmVyIiwiQ2hlY2tvdXRTdGF0ZSIsImNvbnN0cnVjdG9yIiwibmFtZSIsIndoZW4iLCJjYXNlcyIsImNoZWNrb3V0U3RhdGVzIiwiSElEREVOIiwiRElTQUJMRUQiLCJCVVNZIiwiQ1VSUkVOVCIsImV4cG9ydHMiLCJCYXJlUHVsbFJlcXVlc3RDaGVja291dENvbnRyb2xsZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsInByb3BzIiwic3RhdGUiLCJjaGVja291dEluUHJvZ3Jlc3MiLCJjaGVja291dE9wIiwiRW5hYmxlYWJsZU9wZXJhdGlvbiIsImNoZWNrb3V0IiwiY2F0Y2giLCJHaXRFcnJvciIsInRvZ2dsZVN0YXRlIiwicmVuZGVyIiwiY2hpbGRyZW4iLCJuZXh0Q2hlY2tvdXRPcCIsInJlcG9zaXRvcnkiLCJwdWxsUmVxdWVzdCIsImlzQWJzZW50IiwiZGlzYWJsZSIsImlzTG9hZGluZyIsImlzUHJlc2VudCIsImlzTWVyZ2luZyIsImlzUmViYXNpbmciLCJoZWFkUmVwb3NpdG9yeSIsImhlYWRQdXNoIiwiYnJhbmNoZXMiLCJnZXRIZWFkQnJhbmNoIiwiZ2V0UHVzaCIsImhlYWRSZW1vdGUiLCJyZW1vdGVzIiwid2l0aE5hbWUiLCJnZXRSZW1vdGVOYW1lIiwiZnJvbVB1bGxSZWZzcGVjIiwiZ2V0T3duZXIiLCJvd25lciIsImxvZ2luIiwiZ2V0UmVwbyIsImdldFNob3J0UmVtb3RlUmVmIiwibnVtYmVyIiwiZnJvbUhlYWRSZXBvIiwiaGVhZFJlZk5hbWUiLCJlbmFibGUiLCJmdWxsSGVhZFJlZiIsInNvdXJjZVJlbW90ZU5hbWUiLCJsb2NhbFJlZk5hbWUiLCJoZWFkUmVtb3RlcyIsIm1hdGNoaW5nR2l0SHViUmVwb3NpdG9yeSIsImxlbmd0aCIsImdldE5hbWUiLCJ1cmwiLCJodHRwcyIsInNzaCIsInNzaFVybCIsIm1vc3RVc2VkUHJvdG9jb2wiLCJyZW1vdGUiLCJsb2NhbFJlcG9zaXRvcnkiLCJhZGRSZW1vdGUiLCJwdWxsVGFyZ2V0cyIsImdldFB1bGxUYXJnZXRzIiwicHVsbCIsInJlbW90ZU5hbWUiLCJmZk9ubHkiLCJpbmNyZW1lbnRDb3VudGVyIiwiZmV0Y2giLCJjcmVhdGVOZXciLCJ0cmFjayIsInN0YXJ0UG9pbnQiLCJQcm9wVHlwZXMiLCJzaGFwZSIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJvYmplY3QiLCJib29sIiwiQnJhbmNoU2V0UHJvcFR5cGUiLCJSZW1vdGVTZXRQcm9wVHlwZSIsImZ1bmMiLCJfZGVmYXVsdCIsImNyZWF0ZUZyYWdtZW50Q29udGFpbmVyIiwibm9kZSIsImhhc2giLCJjb25zb2xlIiwiZXJyb3IiXSwic291cmNlcyI6WyJwci1jaGVja291dC1jb250cm9sbGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtncmFwaHFsLCBjcmVhdGVGcmFnbWVudENvbnRhaW5lcn0gZnJvbSAncmVhY3QtcmVsYXknO1xuXG5pbXBvcnQgRW5hYmxlYWJsZU9wZXJhdGlvbiBmcm9tICcuLi9tb2RlbHMvZW5hYmxlYWJsZS1vcGVyYXRpb24nO1xuaW1wb3J0IHtHaXRFcnJvcn0gZnJvbSAnLi4vZ2l0LXNoZWxsLW91dC1zdHJhdGVneSc7XG5pbXBvcnQge1JlbW90ZVNldFByb3BUeXBlLCBCcmFuY2hTZXRQcm9wVHlwZX0gZnJvbSAnLi4vcHJvcC10eXBlcyc7XG5pbXBvcnQge2luY3JlbWVudENvdW50ZXJ9IGZyb20gJy4uL3JlcG9ydGVyLXByb3h5JztcblxuY2xhc3MgQ2hlY2tvdXRTdGF0ZSB7XG4gIGNvbnN0cnVjdG9yKG5hbWUpIHtcbiAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICB9XG5cbiAgd2hlbihjYXNlcykge1xuICAgIHJldHVybiBjYXNlc1t0aGlzLm5hbWVdIHx8IGNhc2VzLmRlZmF1bHQ7XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNoZWNrb3V0U3RhdGVzID0ge1xuICBISURERU46IG5ldyBDaGVja291dFN0YXRlKCdoaWRkZW4nKSxcbiAgRElTQUJMRUQ6IG5ldyBDaGVja291dFN0YXRlKCdkaXNhYmxlZCcpLFxuICBCVVNZOiBuZXcgQ2hlY2tvdXRTdGF0ZSgnYnVzeScpLFxuICBDVVJSRU5UOiBuZXcgQ2hlY2tvdXRTdGF0ZSgnY3VycmVudCcpLFxufTtcblxuZXhwb3J0IGNsYXNzIEJhcmVQdWxsUmVxdWVzdENoZWNrb3V0Q29udHJvbGxlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLy8gR3JhcGhRTCByZXNwb25zZVxuICAgIHJlcG9zaXRvcnk6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICBvd25lcjogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgbG9naW46IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgIH0pLmlzUmVxdWlyZWQsXG4gICAgfSkuaXNSZXF1aXJlZCxcbiAgICBwdWxsUmVxdWVzdDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIG51bWJlcjogUHJvcFR5cGVzLm51bWJlci5pc1JlcXVpcmVkLFxuICAgICAgaGVhZFJlZk5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgIGhlYWRSZXBvc2l0b3J5OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICBuYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIHVybDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICBzc2hVcmw6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgb3duZXI6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgICAgbG9naW46IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgfSksXG4gICAgICB9KSxcbiAgICB9KS5pc1JlcXVpcmVkLFxuXG4gICAgLy8gUmVwb3NpdG9yeSBtb2RlbCBhbmQgYXR0cmlidXRlc1xuICAgIGxvY2FsUmVwb3NpdG9yeTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGlzQWJzZW50OiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzTG9hZGluZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBpc1ByZXNlbnQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgaXNNZXJnaW5nOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzUmViYXNpbmc6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgYnJhbmNoZXM6IEJyYW5jaFNldFByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgcmVtb3RlczogUmVtb3RlU2V0UHJvcFR5cGUuaXNSZXF1aXJlZCxcblxuICAgIGNoaWxkcmVuOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB9XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLnN0YXRlID0ge1xuICAgICAgY2hlY2tvdXRJblByb2dyZXNzOiBmYWxzZSxcbiAgICB9O1xuXG4gICAgdGhpcy5jaGVja291dE9wID0gbmV3IEVuYWJsZWFibGVPcGVyYXRpb24oXG4gICAgICAoKSA9PiB0aGlzLmNoZWNrb3V0KCkuY2F0Y2goZSA9PiB7XG4gICAgICAgIGlmICghKGUgaW5zdGFuY2VvZiBHaXRFcnJvcikpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9KSxcbiAgICApO1xuICAgIHRoaXMuY2hlY2tvdXRPcC50b2dnbGVTdGF0ZSh0aGlzLCAnY2hlY2tvdXRJblByb2dyZXNzJyk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuY2hpbGRyZW4odGhpcy5uZXh0Q2hlY2tvdXRPcCgpKTtcbiAgfVxuXG4gIG5leHRDaGVja291dE9wKCkge1xuICAgIGNvbnN0IHtyZXBvc2l0b3J5LCBwdWxsUmVxdWVzdH0gPSB0aGlzLnByb3BzO1xuXG4gICAgaWYgKHRoaXMucHJvcHMuaXNBYnNlbnQpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5ISURERU4sICdObyByZXBvc2l0b3J5IGZvdW5kJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMuaXNMb2FkaW5nKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja291dE9wLmRpc2FibGUoY2hlY2tvdXRTdGF0ZXMuRElTQUJMRUQsICdMb2FkaW5nJyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLnByb3BzLmlzUHJlc2VudCkge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5kaXNhYmxlKGNoZWNrb3V0U3RhdGVzLkRJU0FCTEVELCAnTm8gcmVwb3NpdG9yeSBmb3VuZCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnByb3BzLmlzTWVyZ2luZykge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5kaXNhYmxlKGNoZWNrb3V0U3RhdGVzLkRJU0FCTEVELCAnTWVyZ2UgaW4gcHJvZ3Jlc3MnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wcm9wcy5pc1JlYmFzaW5nKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja291dE9wLmRpc2FibGUoY2hlY2tvdXRTdGF0ZXMuRElTQUJMRUQsICdSZWJhc2UgaW4gcHJvZ3Jlc3MnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0ZS5jaGVja291dEluUHJvZ3Jlc3MpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5ESVNBQkxFRCwgJ0NoZWNraW5nIG91dC4uLicpO1xuICAgIH1cblxuICAgIC8vIGRldGVybWluZSBpZiBwdWxsUmVxdWVzdC5oZWFkUmVwb3NpdG9yeSBpcyBudWxsXG4gICAgLy8gdGhpcyBjYW4gaGFwcGVuIGlmIGEgcmVwb3NpdG9yeSBoYXMgYmVlbiBkZWxldGVkLlxuICAgIGlmICghcHVsbFJlcXVlc3QuaGVhZFJlcG9zaXRvcnkpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5ESVNBQkxFRCwgJ1B1bGwgcmVxdWVzdCBoZWFkIHJlcG9zaXRvcnkgZG9lcyBub3QgZXhpc3QnKTtcbiAgICB9XG5cbiAgICAvLyBEZXRlcm1pbmUgaWYgd2UgYWxyZWFkeSBoYXZlIHRoaXMgUFIgY2hlY2tlZCBvdXQuXG5cbiAgICBjb25zdCBoZWFkUHVzaCA9IHRoaXMucHJvcHMuYnJhbmNoZXMuZ2V0SGVhZEJyYW5jaCgpLmdldFB1c2goKTtcbiAgICBjb25zdCBoZWFkUmVtb3RlID0gdGhpcy5wcm9wcy5yZW1vdGVzLndpdGhOYW1lKGhlYWRQdXNoLmdldFJlbW90ZU5hbWUoKSk7XG5cbiAgICAvLyAoZGV0ZWN0IGNoZWNrb3V0IGZyb20gcHVsbC8jIyMgcmVmc3BlYylcbiAgICBjb25zdCBmcm9tUHVsbFJlZnNwZWMgPVxuICAgICAgaGVhZFJlbW90ZS5nZXRPd25lcigpID09PSByZXBvc2l0b3J5Lm93bmVyLmxvZ2luICYmXG4gICAgICBoZWFkUmVtb3RlLmdldFJlcG8oKSA9PT0gcmVwb3NpdG9yeS5uYW1lICYmXG4gICAgICBoZWFkUHVzaC5nZXRTaG9ydFJlbW90ZVJlZigpID09PSBgcHVsbC8ke3B1bGxSZXF1ZXN0Lm51bWJlcn0vaGVhZGA7XG5cbiAgICAvLyAoZGV0ZWN0IGNoZWNrb3V0IGZyb20gaGVhZCByZXBvc2l0b3J5KVxuICAgIGNvbnN0IGZyb21IZWFkUmVwbyA9XG4gICAgICBoZWFkUmVtb3RlLmdldE93bmVyKCkgPT09IHB1bGxSZXF1ZXN0LmhlYWRSZXBvc2l0b3J5Lm93bmVyLmxvZ2luICYmXG4gICAgICBoZWFkUmVtb3RlLmdldFJlcG8oKSA9PT0gcHVsbFJlcXVlc3QuaGVhZFJlcG9zaXRvcnkubmFtZSAmJlxuICAgICAgaGVhZFB1c2guZ2V0U2hvcnRSZW1vdGVSZWYoKSA9PT0gcHVsbFJlcXVlc3QuaGVhZFJlZk5hbWU7XG5cbiAgICBpZiAoZnJvbVB1bGxSZWZzcGVjIHx8IGZyb21IZWFkUmVwbykge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5kaXNhYmxlKGNoZWNrb3V0U3RhdGVzLkNVUlJFTlQsICdDdXJyZW50Jyk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5lbmFibGUoKTtcbiAgfVxuXG4gIGFzeW5jIGNoZWNrb3V0KCkge1xuICAgIGNvbnN0IHtwdWxsUmVxdWVzdH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IHtoZWFkUmVwb3NpdG9yeX0gPSBwdWxsUmVxdWVzdDtcblxuICAgIGNvbnN0IGZ1bGxIZWFkUmVmID0gYHJlZnMvaGVhZHMvJHtwdWxsUmVxdWVzdC5oZWFkUmVmTmFtZX1gO1xuXG4gICAgbGV0IHNvdXJjZVJlbW90ZU5hbWUsIGxvY2FsUmVmTmFtZTtcblxuICAgIC8vIERpc2NvdmVyIG9yIGNyZWF0ZSBhIHJlbW90ZSBwb2ludGluZyB0byB0aGUgcmVwbyBjb250YWluaW5nIHRoZSBwdWxsIHJlcXVlc3QncyBoZWFkIHJlZi5cbiAgICAvLyBJZiB0aGUgbG9jYWwgcmVwb3NpdG9yeSBhbHJlYWR5IGhhcyB0aGUgaGVhZCByZXBvc2l0b3J5IHNwZWNpZmllZCBhcyBhIHJlbW90ZSwgdGhhdCByZW1vdGUgd2lsbCBiZSB1c2VkLCBzb1xuICAgIC8vIHRoYXQgYW55IHJlbGF0ZWQgY29uZmlndXJhdGlvbiBpcyBwaWNrZWQgdXAgZm9yIHRoZSBmZXRjaC4gT3RoZXJ3aXNlLCB0aGUgaGVhZCByZXBvc2l0b3J5IGZldGNoIFVSTCBpcyB1c2VkXG4gICAgLy8gZGlyZWN0bHkuXG4gICAgY29uc3QgaGVhZFJlbW90ZXMgPSB0aGlzLnByb3BzLnJlbW90ZXMubWF0Y2hpbmdHaXRIdWJSZXBvc2l0b3J5KGhlYWRSZXBvc2l0b3J5Lm93bmVyLmxvZ2luLCBoZWFkUmVwb3NpdG9yeS5uYW1lKTtcbiAgICBpZiAoaGVhZFJlbW90ZXMubGVuZ3RoID4gMCkge1xuICAgICAgc291cmNlUmVtb3RlTmFtZSA9IGhlYWRSZW1vdGVzWzBdLmdldE5hbWUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgdXJsID0ge1xuICAgICAgICBodHRwczogaGVhZFJlcG9zaXRvcnkudXJsICsgJy5naXQnLFxuICAgICAgICBzc2g6IGhlYWRSZXBvc2l0b3J5LnNzaFVybCxcbiAgICAgIH1bdGhpcy5wcm9wcy5yZW1vdGVzLm1vc3RVc2VkUHJvdG9jb2woWydodHRwcycsICdzc2gnXSldO1xuXG4gICAgICAvLyBUaGlzIHdpbGwgdGhyb3cgaWYgYSByZW1vdGUgd2l0aCB0aGlzIG5hbWUgYWxyZWFkeSBleGlzdHMgKGFuZCBwb2ludHMgc29tZXdoZXJlIGVsc2UsIG9yIHdlIHdvdWxkIGhhdmUgZm91bmRcbiAgICAgIC8vIGl0IGFib3ZlKS4gwq9cXF8o44OEKV8vwq9cbiAgICAgIGNvbnN0IHJlbW90ZSA9IGF3YWl0IHRoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5LmFkZFJlbW90ZShoZWFkUmVwb3NpdG9yeS5vd25lci5sb2dpbiwgdXJsKTtcbiAgICAgIHNvdXJjZVJlbW90ZU5hbWUgPSByZW1vdGUuZ2V0TmFtZSgpO1xuICAgIH1cblxuICAgIC8vIElkZW50aWZ5IGFuIGV4aXN0aW5nIGxvY2FsIHJlZiB0aGF0IGFscmVhZHkgY29ycmVzcG9uZHMgdG8gdGhlIHB1bGwgcmVxdWVzdCwgaWYgb25lIGV4aXN0cy4gT3RoZXJ3aXNlLCBnZW5lcmF0ZVxuICAgIC8vIGEgbmV3IGxvY2FsIHJlZiBuYW1lLlxuICAgIGNvbnN0IHB1bGxUYXJnZXRzID0gdGhpcy5wcm9wcy5icmFuY2hlcy5nZXRQdWxsVGFyZ2V0cyhzb3VyY2VSZW1vdGVOYW1lLCBmdWxsSGVhZFJlZik7XG4gICAgaWYgKHB1bGxUYXJnZXRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGxvY2FsUmVmTmFtZSA9IHB1bGxUYXJnZXRzWzBdLmdldE5hbWUoKTtcblxuICAgICAgLy8gQ2hlY2sgb3V0IHRoZSBleGlzdGluZyBsb2NhbCByZWYuXG4gICAgICBhd2FpdCB0aGlzLnByb3BzLmxvY2FsUmVwb3NpdG9yeS5jaGVja291dChsb2NhbFJlZk5hbWUpO1xuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgdGhpcy5wcm9wcy5sb2NhbFJlcG9zaXRvcnkucHVsbChmdWxsSGVhZFJlZiwge3JlbW90ZU5hbWU6IHNvdXJjZVJlbW90ZU5hbWUsIGZmT25seTogdHJ1ZX0pO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgaW5jcmVtZW50Q291bnRlcignY2hlY2tvdXQtcHInKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGF3YWl0IHRoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5LmZldGNoKGZ1bGxIZWFkUmVmLCB7cmVtb3RlTmFtZTogc291cmNlUmVtb3RlTmFtZX0pO1xuXG4gICAgLy8gQ2hlY2sgb3V0IHRoZSBsb2NhbCByZWYgYW5kIHNldCBpdCB1cCB0byB0cmFjayB0aGUgaGVhZCByZWYuXG4gICAgYXdhaXQgdGhpcy5wcm9wcy5sb2NhbFJlcG9zaXRvcnkuY2hlY2tvdXQoXG4gICAgICBgcHItJHtwdWxsUmVxdWVzdC5udW1iZXJ9LyR7aGVhZFJlcG9zaXRvcnkub3duZXIubG9naW59LyR7cHVsbFJlcXVlc3QuaGVhZFJlZk5hbWV9YCxcbiAgICAgIHtjcmVhdGVOZXc6IHRydWUsIHRyYWNrOiB0cnVlLCBzdGFydFBvaW50OiBgcmVmcy9yZW1vdGVzLyR7c291cmNlUmVtb3RlTmFtZX0vJHtwdWxsUmVxdWVzdC5oZWFkUmVmTmFtZX1gLFxuICAgICAgfSk7XG5cbiAgICBpbmNyZW1lbnRDb3VudGVyKCdjaGVja291dC1wcicpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUZyYWdtZW50Q29udGFpbmVyKEJhcmVQdWxsUmVxdWVzdENoZWNrb3V0Q29udHJvbGxlciwge1xuICByZXBvc2l0b3J5OiBncmFwaHFsYFxuICAgIGZyYWdtZW50IHByQ2hlY2tvdXRDb250cm9sbGVyX3JlcG9zaXRvcnkgb24gUmVwb3NpdG9yeSB7XG4gICAgICBuYW1lXG4gICAgICBvd25lciB7XG4gICAgICAgIGxvZ2luXG4gICAgICB9XG4gICAgfVxuICBgLFxuICBwdWxsUmVxdWVzdDogZ3JhcGhxbGBcbiAgICBmcmFnbWVudCBwckNoZWNrb3V0Q29udHJvbGxlcl9wdWxsUmVxdWVzdCBvbiBQdWxsUmVxdWVzdCB7XG4gICAgICBudW1iZXJcbiAgICAgIGhlYWRSZWZOYW1lXG4gICAgICBoZWFkUmVwb3NpdG9yeSB7XG4gICAgICAgIG5hbWVcbiAgICAgICAgdXJsXG4gICAgICAgIHNzaFVybFxuICAgICAgICBvd25lciB7XG4gICAgICAgICAgbG9naW5cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgYCxcbn0pO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxXQUFBLEdB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