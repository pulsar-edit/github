"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BarePullRequestCheckoutController = exports.checkoutStates = void 0;
var _react = _interopRequireDefault(require("react"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _reactRelay = require("react-relay");
var _enableableOperation = _interopRequireDefault(require("../models/enableable-operation"));
var _gitShellOutStrategy = require("../git-shell-out-strategy");
var _propTypes2 = require("../prop-types");
var _reporterProxy = require("../reporter-proxy");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class CheckoutState {
  constructor(name) {
    this.name = name;
  }
  when(cases) {
    return cases[this.name] || cases.default;
  }
}
const checkoutStates = {
  HIDDEN: new CheckoutState('hidden'),
  DISABLED: new CheckoutState('disabled'),
  BUSY: new CheckoutState('busy'),
  CURRENT: new CheckoutState('current')
};
exports.checkoutStates = checkoutStates;
class BarePullRequestCheckoutController extends _react.default.Component {
  constructor(props) {
    super(props);
    this.state = {
      checkoutInProgress: false
    };
    this.checkoutOp = new _enableableOperation.default(() => this.checkout().catch(e => {
      if (!(e instanceof _gitShellOutStrategy.GitError)) {
        throw e;
      }
    }));
    this.checkoutOp.toggleState(this, 'checkoutInProgress');
  }
  render() {
    return this.props.children(this.nextCheckoutOp());
  }
  nextCheckoutOp() {
    const {
      repository,
      pullRequest
    } = this.props;
    if (this.props.isAbsent) {
      return this.checkoutOp.disable(checkoutStates.HIDDEN, 'No repository found');
    }
    if (this.props.isLoading) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Loading');
    }
    if (!this.props.isPresent) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'No repository found');
    }
    if (this.props.isMerging) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Merge in progress');
    }
    if (this.props.isRebasing) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Rebase in progress');
    }
    if (this.state.checkoutInProgress) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Checking out...');
    }

    // determine if pullRequest.headRepository is null
    // this can happen if a repository has been deleted.
    if (!pullRequest.headRepository) {
      return this.checkoutOp.disable(checkoutStates.DISABLED, 'Pull request head repository does not exist');
    }

    // Determine if we already have this PR checked out.

    const headPush = this.props.branches.getHeadBranch().getPush();
    const headRemote = this.props.remotes.withName(headPush.getRemoteName());

    // (detect checkout from pull/### refspec)
    const fromPullRefspec = headRemote.getOwner() === repository.owner.login && headRemote.getRepo() === repository.name && headPush.getShortRemoteRef() === `pull/${pullRequest.number}/head`;

    // (detect checkout from head repository)
    const fromHeadRepo = headRemote.getOwner() === pullRequest.headRepository.owner.login && headRemote.getRepo() === pullRequest.headRepository.name && headPush.getShortRemoteRef() === pullRequest.headRefName;
    if (fromPullRefspec || fromHeadRepo) {
      return this.checkoutOp.disable(checkoutStates.CURRENT, 'Current');
    }
    return this.checkoutOp.enable();
  }
  async checkout() {
    const {
      pullRequest
    } = this.props;
    const {
      headRepository
    } = pullRequest;
    const fullHeadRef = `refs/heads/${pullRequest.headRefName}`;
    let sourceRemoteName, localRefName;

    // Discover or create a remote pointing to the repo containing the pull request's head ref.
    // If the local repository already has the head repository specified as a remote, that remote will be used, so
    // that any related configuration is picked up for the fetch. Otherwise, the head repository fetch URL is used
    // directly.
    const headRemotes = this.props.remotes.matchingGitHubRepository(headRepository.owner.login, headRepository.name);
    if (headRemotes.length > 0) {
      sourceRemoteName = headRemotes[0].getName();
    } else {
      const url = {
        https: headRepository.url + '.git',
        ssh: headRepository.sshUrl
      }[this.props.remotes.mostUsedProtocol(['https', 'ssh'])];

      // This will throw if a remote with this name already exists (and points somewhere else, or we would have found
      // it above). ¯\_(ツ)_/¯
      const remote = await this.props.localRepository.addRemote(headRepository.owner.login, url);
      sourceRemoteName = remote.getName();
    }

    // Identify an existing local ref that already corresponds to the pull request, if one exists. Otherwise, generate
    // a new local ref name.
    const pullTargets = this.props.branches.getPullTargets(sourceRemoteName, fullHeadRef);
    if (pullTargets.length > 0) {
      localRefName = pullTargets[0].getName();

      // Check out the existing local ref.
      await this.props.localRepository.checkout(localRefName);
      try {
        await this.props.localRepository.pull(fullHeadRef, {
          remoteName: sourceRemoteName,
          ffOnly: true
        });
      } finally {
        (0, _reporterProxy.incrementCounter)('checkout-pr');
      }
      return;
    }
    await this.props.localRepository.fetch(fullHeadRef, {
      remoteName: sourceRemoteName
    });

    // Check out the local ref and set it up to track the head ref.
    await this.props.localRepository.checkout(`pr-${pullRequest.number}/${headRepository.owner.login}/${pullRequest.headRefName}`, {
      createNew: true,
      track: true,
      startPoint: `refs/remotes/${sourceRemoteName}/${pullRequest.headRefName}`
    });
    (0, _reporterProxy.incrementCounter)('checkout-pr');
  }
}
exports.BarePullRequestCheckoutController = BarePullRequestCheckoutController;
_defineProperty(BarePullRequestCheckoutController, "propTypes", {
  // GraphQL response
  repository: _propTypes.default.shape({
    name: _propTypes.default.string.isRequired,
    owner: _propTypes.default.shape({
      login: _propTypes.default.string.isRequired
    }).isRequired
  }).isRequired,
  pullRequest: _propTypes.default.shape({
    number: _propTypes.default.number.isRequired,
    headRefName: _propTypes.default.string.isRequired,
    headRepository: _propTypes.default.shape({
      name: _propTypes.default.string.isRequired,
      url: _propTypes.default.string.isRequired,
      sshUrl: _propTypes.default.string.isRequired,
      owner: _propTypes.default.shape({
        login: _propTypes.default.string.isRequired
      })
    })
  }).isRequired,
  // Repository model and attributes
  localRepository: _propTypes.default.object.isRequired,
  isAbsent: _propTypes.default.bool.isRequired,
  isLoading: _propTypes.default.bool.isRequired,
  isPresent: _propTypes.default.bool.isRequired,
  isMerging: _propTypes.default.bool.isRequired,
  isRebasing: _propTypes.default.bool.isRequired,
  branches: _propTypes2.BranchSetPropType.isRequired,
  remotes: _propTypes2.RemoteSetPropType.isRequired,
  children: _propTypes.default.func.isRequired
});
var _default = (0, _reactRelay.createFragmentContainer)(BarePullRequestCheckoutController, {
  repository: function () {
    const node = require("./__generated__/prCheckoutController_repository.graphql");
    if (node.hash && node.hash !== "b2212745240c03ff8fc7cb13dfc63183") {
      console.error("The definition of 'prCheckoutController_repository' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prCheckoutController_repository.graphql");
  },
  pullRequest: function () {
    const node = require("./__generated__/prCheckoutController_pullRequest.graphql");
    if (node.hash && node.hash !== "66e001f389a2c4f74c1369cf69b31268") {
      console.error("The definition of 'prCheckoutController_pullRequest' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prCheckoutController_pullRequest.graphql");
  }
});
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9wVHlwZXMiLCJfcmVhY3RSZWxheSIsIl9lbmFibGVhYmxlT3BlcmF0aW9uIiwiX2dpdFNoZWxsT3V0U3RyYXRlZ3kiLCJfcHJvcFR5cGVzMiIsIl9yZXBvcnRlclByb3h5Iiwib2JqIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmaW5lUHJvcGVydHkiLCJrZXkiLCJ2YWx1ZSIsIl90b1Byb3BlcnR5S2V5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJhcmciLCJfdG9QcmltaXRpdmUiLCJTdHJpbmciLCJpbnB1dCIsImhpbnQiLCJwcmltIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJ1bmRlZmluZWQiLCJyZXMiLCJjYWxsIiwiVHlwZUVycm9yIiwiTnVtYmVyIiwiQ2hlY2tvdXRTdGF0ZSIsImNvbnN0cnVjdG9yIiwibmFtZSIsIndoZW4iLCJjYXNlcyIsImNoZWNrb3V0U3RhdGVzIiwiSElEREVOIiwiRElTQUJMRUQiLCJCVVNZIiwiQ1VSUkVOVCIsImV4cG9ydHMiLCJCYXJlUHVsbFJlcXVlc3RDaGVja291dENvbnRyb2xsZXIiLCJSZWFjdCIsIkNvbXBvbmVudCIsInByb3BzIiwic3RhdGUiLCJjaGVja291dEluUHJvZ3Jlc3MiLCJjaGVja291dE9wIiwiRW5hYmxlYWJsZU9wZXJhdGlvbiIsImNoZWNrb3V0IiwiY2F0Y2giLCJlIiwiR2l0RXJyb3IiLCJ0b2dnbGVTdGF0ZSIsInJlbmRlciIsImNoaWxkcmVuIiwibmV4dENoZWNrb3V0T3AiLCJyZXBvc2l0b3J5IiwicHVsbFJlcXVlc3QiLCJpc0Fic2VudCIsImRpc2FibGUiLCJpc0xvYWRpbmciLCJpc1ByZXNlbnQiLCJpc01lcmdpbmciLCJpc1JlYmFzaW5nIiwiaGVhZFJlcG9zaXRvcnkiLCJoZWFkUHVzaCIsImJyYW5jaGVzIiwiZ2V0SGVhZEJyYW5jaCIsImdldFB1c2giLCJoZWFkUmVtb3RlIiwicmVtb3RlcyIsIndpdGhOYW1lIiwiZ2V0UmVtb3RlTmFtZSIsImZyb21QdWxsUmVmc3BlYyIsImdldE93bmVyIiwib3duZXIiLCJsb2dpbiIsImdldFJlcG8iLCJnZXRTaG9ydFJlbW90ZVJlZiIsIm51bWJlciIsImZyb21IZWFkUmVwbyIsImhlYWRSZWZOYW1lIiwiZW5hYmxlIiwiZnVsbEhlYWRSZWYiLCJzb3VyY2VSZW1vdGVOYW1lIiwibG9jYWxSZWZOYW1lIiwiaGVhZFJlbW90ZXMiLCJtYXRjaGluZ0dpdEh1YlJlcG9zaXRvcnkiLCJsZW5ndGgiLCJnZXROYW1lIiwidXJsIiwiaHR0cHMiLCJzc2giLCJzc2hVcmwiLCJtb3N0VXNlZFByb3RvY29sIiwicmVtb3RlIiwibG9jYWxSZXBvc2l0b3J5IiwiYWRkUmVtb3RlIiwicHVsbFRhcmdldHMiLCJnZXRQdWxsVGFyZ2V0cyIsInB1bGwiLCJyZW1vdGVOYW1lIiwiZmZPbmx5IiwiaW5jcmVtZW50Q291bnRlciIsImZldGNoIiwiY3JlYXRlTmV3IiwidHJhY2siLCJzdGFydFBvaW50IiwiUHJvcFR5cGVzIiwic2hhcGUiLCJzdHJpbmciLCJpc1JlcXVpcmVkIiwib2JqZWN0IiwiYm9vbCIsIkJyYW5jaFNldFByb3BUeXBlIiwiUmVtb3RlU2V0UHJvcFR5cGUiLCJmdW5jIiwiX2RlZmF1bHQiLCJjcmVhdGVGcmFnbWVudENvbnRhaW5lciIsIm5vZGUiLCJoYXNoIiwiY29uc29sZSIsImVycm9yIl0sInNvdXJjZXMiOlsicHItY2hlY2tvdXQtY29udHJvbGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7Z3JhcGhxbCwgY3JlYXRlRnJhZ21lbnRDb250YWluZXJ9IGZyb20gJ3JlYWN0LXJlbGF5JztcblxuaW1wb3J0IEVuYWJsZWFibGVPcGVyYXRpb24gZnJvbSAnLi4vbW9kZWxzL2VuYWJsZWFibGUtb3BlcmF0aW9uJztcbmltcG9ydCB7R2l0RXJyb3J9IGZyb20gJy4uL2dpdC1zaGVsbC1vdXQtc3RyYXRlZ3knO1xuaW1wb3J0IHtSZW1vdGVTZXRQcm9wVHlwZSwgQnJhbmNoU2V0UHJvcFR5cGV9IGZyb20gJy4uL3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtpbmNyZW1lbnRDb3VudGVyfSBmcm9tICcuLi9yZXBvcnRlci1wcm94eSc7XG5cbmNsYXNzIENoZWNrb3V0U3RhdGUge1xuICBjb25zdHJ1Y3RvcihuYW1lKSB7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgfVxuXG4gIHdoZW4oY2FzZXMpIHtcbiAgICByZXR1cm4gY2FzZXNbdGhpcy5uYW1lXSB8fCBjYXNlcy5kZWZhdWx0O1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjaGVja291dFN0YXRlcyA9IHtcbiAgSElEREVOOiBuZXcgQ2hlY2tvdXRTdGF0ZSgnaGlkZGVuJyksXG4gIERJU0FCTEVEOiBuZXcgQ2hlY2tvdXRTdGF0ZSgnZGlzYWJsZWQnKSxcbiAgQlVTWTogbmV3IENoZWNrb3V0U3RhdGUoJ2J1c3knKSxcbiAgQ1VSUkVOVDogbmV3IENoZWNrb3V0U3RhdGUoJ2N1cnJlbnQnKSxcbn07XG5cbmV4cG9ydCBjbGFzcyBCYXJlUHVsbFJlcXVlc3RDaGVja291dENvbnRyb2xsZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8vIEdyYXBoUUwgcmVzcG9uc2VcbiAgICByZXBvc2l0b3J5OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgbmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgb3duZXI6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgIGxvZ2luOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICB9KS5pc1JlcXVpcmVkLFxuICAgIH0pLmlzUmVxdWlyZWQsXG4gICAgcHVsbFJlcXVlc3Q6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBudW1iZXI6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICAgIGhlYWRSZWZOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICBoZWFkUmVwb3NpdG9yeTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgbmFtZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICB1cmw6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgc3NoVXJsOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIG93bmVyOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICAgIGxvZ2luOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgIH0pLFxuICAgICAgfSksXG4gICAgfSkuaXNSZXF1aXJlZCxcblxuICAgIC8vIFJlcG9zaXRvcnkgbW9kZWwgYW5kIGF0dHJpYnV0ZXNcbiAgICBsb2NhbFJlcG9zaXRvcnk6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBpc0Fic2VudDogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBpc0xvYWRpbmc6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgaXNQcmVzZW50OiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzTWVyZ2luZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBpc1JlYmFzaW5nOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGJyYW5jaGVzOiBCcmFuY2hTZXRQcm9wVHlwZS5pc1JlcXVpcmVkLFxuICAgIHJlbW90ZXM6IFJlbW90ZVNldFByb3BUeXBlLmlzUmVxdWlyZWQsXG5cbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGNoZWNrb3V0SW5Qcm9ncmVzczogZmFsc2UsXG4gICAgfTtcblxuICAgIHRoaXMuY2hlY2tvdXRPcCA9IG5ldyBFbmFibGVhYmxlT3BlcmF0aW9uKFxuICAgICAgKCkgPT4gdGhpcy5jaGVja291dCgpLmNhdGNoKGUgPT4ge1xuICAgICAgICBpZiAoIShlIGluc3RhbmNlb2YgR2l0RXJyb3IpKSB7XG4gICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfVxuICAgICAgfSksXG4gICAgKTtcbiAgICB0aGlzLmNoZWNrb3V0T3AudG9nZ2xlU3RhdGUodGhpcywgJ2NoZWNrb3V0SW5Qcm9ncmVzcycpO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmNoaWxkcmVuKHRoaXMubmV4dENoZWNrb3V0T3AoKSk7XG4gIH1cblxuICBuZXh0Q2hlY2tvdXRPcCgpIHtcbiAgICBjb25zdCB7cmVwb3NpdG9yeSwgcHVsbFJlcXVlc3R9ID0gdGhpcy5wcm9wcztcblxuICAgIGlmICh0aGlzLnByb3BzLmlzQWJzZW50KSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja291dE9wLmRpc2FibGUoY2hlY2tvdXRTdGF0ZXMuSElEREVOLCAnTm8gcmVwb3NpdG9yeSBmb3VuZCcpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLnByb3BzLmlzTG9hZGluZykge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5kaXNhYmxlKGNoZWNrb3V0U3RhdGVzLkRJU0FCTEVELCAnTG9hZGluZycpO1xuICAgIH1cblxuICAgIGlmICghdGhpcy5wcm9wcy5pc1ByZXNlbnQpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5ESVNBQkxFRCwgJ05vIHJlcG9zaXRvcnkgZm91bmQnKTtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5wcm9wcy5pc01lcmdpbmcpIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5ESVNBQkxFRCwgJ01lcmdlIGluIHByb2dyZXNzJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMucHJvcHMuaXNSZWJhc2luZykge1xuICAgICAgcmV0dXJuIHRoaXMuY2hlY2tvdXRPcC5kaXNhYmxlKGNoZWNrb3V0U3RhdGVzLkRJU0FCTEVELCAnUmViYXNlIGluIHByb2dyZXNzJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuc3RhdGUuY2hlY2tvdXRJblByb2dyZXNzKSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja291dE9wLmRpc2FibGUoY2hlY2tvdXRTdGF0ZXMuRElTQUJMRUQsICdDaGVja2luZyBvdXQuLi4nKTtcbiAgICB9XG5cbiAgICAvLyBkZXRlcm1pbmUgaWYgcHVsbFJlcXVlc3QuaGVhZFJlcG9zaXRvcnkgaXMgbnVsbFxuICAgIC8vIHRoaXMgY2FuIGhhcHBlbiBpZiBhIHJlcG9zaXRvcnkgaGFzIGJlZW4gZGVsZXRlZC5cbiAgICBpZiAoIXB1bGxSZXF1ZXN0LmhlYWRSZXBvc2l0b3J5KSB7XG4gICAgICByZXR1cm4gdGhpcy5jaGVja291dE9wLmRpc2FibGUoY2hlY2tvdXRTdGF0ZXMuRElTQUJMRUQsICdQdWxsIHJlcXVlc3QgaGVhZCByZXBvc2l0b3J5IGRvZXMgbm90IGV4aXN0Jyk7XG4gICAgfVxuXG4gICAgLy8gRGV0ZXJtaW5lIGlmIHdlIGFscmVhZHkgaGF2ZSB0aGlzIFBSIGNoZWNrZWQgb3V0LlxuXG4gICAgY29uc3QgaGVhZFB1c2ggPSB0aGlzLnByb3BzLmJyYW5jaGVzLmdldEhlYWRCcmFuY2goKS5nZXRQdXNoKCk7XG4gICAgY29uc3QgaGVhZFJlbW90ZSA9IHRoaXMucHJvcHMucmVtb3Rlcy53aXRoTmFtZShoZWFkUHVzaC5nZXRSZW1vdGVOYW1lKCkpO1xuXG4gICAgLy8gKGRldGVjdCBjaGVja291dCBmcm9tIHB1bGwvIyMjIHJlZnNwZWMpXG4gICAgY29uc3QgZnJvbVB1bGxSZWZzcGVjID1cbiAgICAgIGhlYWRSZW1vdGUuZ2V0T3duZXIoKSA9PT0gcmVwb3NpdG9yeS5vd25lci5sb2dpbiAmJlxuICAgICAgaGVhZFJlbW90ZS5nZXRSZXBvKCkgPT09IHJlcG9zaXRvcnkubmFtZSAmJlxuICAgICAgaGVhZFB1c2guZ2V0U2hvcnRSZW1vdGVSZWYoKSA9PT0gYHB1bGwvJHtwdWxsUmVxdWVzdC5udW1iZXJ9L2hlYWRgO1xuXG4gICAgLy8gKGRldGVjdCBjaGVja291dCBmcm9tIGhlYWQgcmVwb3NpdG9yeSlcbiAgICBjb25zdCBmcm9tSGVhZFJlcG8gPVxuICAgICAgaGVhZFJlbW90ZS5nZXRPd25lcigpID09PSBwdWxsUmVxdWVzdC5oZWFkUmVwb3NpdG9yeS5vd25lci5sb2dpbiAmJlxuICAgICAgaGVhZFJlbW90ZS5nZXRSZXBvKCkgPT09IHB1bGxSZXF1ZXN0LmhlYWRSZXBvc2l0b3J5Lm5hbWUgJiZcbiAgICAgIGhlYWRQdXNoLmdldFNob3J0UmVtb3RlUmVmKCkgPT09IHB1bGxSZXF1ZXN0LmhlYWRSZWZOYW1lO1xuXG4gICAgaWYgKGZyb21QdWxsUmVmc3BlYyB8fCBmcm9tSGVhZFJlcG8pIHtcbiAgICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZGlzYWJsZShjaGVja291dFN0YXRlcy5DVVJSRU5ULCAnQ3VycmVudCcpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmNoZWNrb3V0T3AuZW5hYmxlKCk7XG4gIH1cblxuICBhc3luYyBjaGVja291dCgpIHtcbiAgICBjb25zdCB7cHVsbFJlcXVlc3R9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7aGVhZFJlcG9zaXRvcnl9ID0gcHVsbFJlcXVlc3Q7XG5cbiAgICBjb25zdCBmdWxsSGVhZFJlZiA9IGByZWZzL2hlYWRzLyR7cHVsbFJlcXVlc3QuaGVhZFJlZk5hbWV9YDtcblxuICAgIGxldCBzb3VyY2VSZW1vdGVOYW1lLCBsb2NhbFJlZk5hbWU7XG5cbiAgICAvLyBEaXNjb3ZlciBvciBjcmVhdGUgYSByZW1vdGUgcG9pbnRpbmcgdG8gdGhlIHJlcG8gY29udGFpbmluZyB0aGUgcHVsbCByZXF1ZXN0J3MgaGVhZCByZWYuXG4gICAgLy8gSWYgdGhlIGxvY2FsIHJlcG9zaXRvcnkgYWxyZWFkeSBoYXMgdGhlIGhlYWQgcmVwb3NpdG9yeSBzcGVjaWZpZWQgYXMgYSByZW1vdGUsIHRoYXQgcmVtb3RlIHdpbGwgYmUgdXNlZCwgc29cbiAgICAvLyB0aGF0IGFueSByZWxhdGVkIGNvbmZpZ3VyYXRpb24gaXMgcGlja2VkIHVwIGZvciB0aGUgZmV0Y2guIE90aGVyd2lzZSwgdGhlIGhlYWQgcmVwb3NpdG9yeSBmZXRjaCBVUkwgaXMgdXNlZFxuICAgIC8vIGRpcmVjdGx5LlxuICAgIGNvbnN0IGhlYWRSZW1vdGVzID0gdGhpcy5wcm9wcy5yZW1vdGVzLm1hdGNoaW5nR2l0SHViUmVwb3NpdG9yeShoZWFkUmVwb3NpdG9yeS5vd25lci5sb2dpbiwgaGVhZFJlcG9zaXRvcnkubmFtZSk7XG4gICAgaWYgKGhlYWRSZW1vdGVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHNvdXJjZVJlbW90ZU5hbWUgPSBoZWFkUmVtb3Rlc1swXS5nZXROYW1lKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IHVybCA9IHtcbiAgICAgICAgaHR0cHM6IGhlYWRSZXBvc2l0b3J5LnVybCArICcuZ2l0JyxcbiAgICAgICAgc3NoOiBoZWFkUmVwb3NpdG9yeS5zc2hVcmwsXG4gICAgICB9W3RoaXMucHJvcHMucmVtb3Rlcy5tb3N0VXNlZFByb3RvY29sKFsnaHR0cHMnLCAnc3NoJ10pXTtcblxuICAgICAgLy8gVGhpcyB3aWxsIHRocm93IGlmIGEgcmVtb3RlIHdpdGggdGhpcyBuYW1lIGFscmVhZHkgZXhpc3RzIChhbmQgcG9pbnRzIHNvbWV3aGVyZSBlbHNlLCBvciB3ZSB3b3VsZCBoYXZlIGZvdW5kXG4gICAgICAvLyBpdCBhYm92ZSkuIMKvXFxfKOODhClfL8KvXG4gICAgICBjb25zdCByZW1vdGUgPSBhd2FpdCB0aGlzLnByb3BzLmxvY2FsUmVwb3NpdG9yeS5hZGRSZW1vdGUoaGVhZFJlcG9zaXRvcnkub3duZXIubG9naW4sIHVybCk7XG4gICAgICBzb3VyY2VSZW1vdGVOYW1lID0gcmVtb3RlLmdldE5hbWUoKTtcbiAgICB9XG5cbiAgICAvLyBJZGVudGlmeSBhbiBleGlzdGluZyBsb2NhbCByZWYgdGhhdCBhbHJlYWR5IGNvcnJlc3BvbmRzIHRvIHRoZSBwdWxsIHJlcXVlc3QsIGlmIG9uZSBleGlzdHMuIE90aGVyd2lzZSwgZ2VuZXJhdGVcbiAgICAvLyBhIG5ldyBsb2NhbCByZWYgbmFtZS5cbiAgICBjb25zdCBwdWxsVGFyZ2V0cyA9IHRoaXMucHJvcHMuYnJhbmNoZXMuZ2V0UHVsbFRhcmdldHMoc291cmNlUmVtb3RlTmFtZSwgZnVsbEhlYWRSZWYpO1xuICAgIGlmIChwdWxsVGFyZ2V0cy5sZW5ndGggPiAwKSB7XG4gICAgICBsb2NhbFJlZk5hbWUgPSBwdWxsVGFyZ2V0c1swXS5nZXROYW1lKCk7XG5cbiAgICAgIC8vIENoZWNrIG91dCB0aGUgZXhpc3RpbmcgbG9jYWwgcmVmLlxuICAgICAgYXdhaXQgdGhpcy5wcm9wcy5sb2NhbFJlcG9zaXRvcnkuY2hlY2tvdXQobG9jYWxSZWZOYW1lKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHRoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5LnB1bGwoZnVsbEhlYWRSZWYsIHtyZW1vdGVOYW1lOiBzb3VyY2VSZW1vdGVOYW1lLCBmZk9ubHk6IHRydWV9KTtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIGluY3JlbWVudENvdW50ZXIoJ2NoZWNrb3V0LXByJyk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBhd2FpdCB0aGlzLnByb3BzLmxvY2FsUmVwb3NpdG9yeS5mZXRjaChmdWxsSGVhZFJlZiwge3JlbW90ZU5hbWU6IHNvdXJjZVJlbW90ZU5hbWV9KTtcblxuICAgIC8vIENoZWNrIG91dCB0aGUgbG9jYWwgcmVmIGFuZCBzZXQgaXQgdXAgdG8gdHJhY2sgdGhlIGhlYWQgcmVmLlxuICAgIGF3YWl0IHRoaXMucHJvcHMubG9jYWxSZXBvc2l0b3J5LmNoZWNrb3V0KFxuICAgICAgYHByLSR7cHVsbFJlcXVlc3QubnVtYmVyfS8ke2hlYWRSZXBvc2l0b3J5Lm93bmVyLmxvZ2lufS8ke3B1bGxSZXF1ZXN0LmhlYWRSZWZOYW1lfWAsXG4gICAgICB7Y3JlYXRlTmV3OiB0cnVlLCB0cmFjazogdHJ1ZSwgc3RhcnRQb2ludDogYHJlZnMvcmVtb3Rlcy8ke3NvdXJjZVJlbW90ZU5hbWV9LyR7cHVsbFJlcXVlc3QuaGVhZFJlZk5hbWV9YCxcbiAgICAgIH0pO1xuXG4gICAgaW5jcmVtZW50Q291bnRlcignY2hlY2tvdXQtcHInKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBjcmVhdGVGcmFnbWVudENvbnRhaW5lcihCYXJlUHVsbFJlcXVlc3RDaGVja291dENvbnRyb2xsZXIsIHtcbiAgcmVwb3NpdG9yeTogZ3JhcGhxbGBcbiAgICBmcmFnbWVudCBwckNoZWNrb3V0Q29udHJvbGxlcl9yZXBvc2l0b3J5IG9uIFJlcG9zaXRvcnkge1xuICAgICAgbmFtZVxuICAgICAgb3duZXIge1xuICAgICAgICBsb2dpblxuICAgICAgfVxuICAgIH1cbiAgYCxcbiAgcHVsbFJlcXVlc3Q6IGdyYXBocWxgXG4gICAgZnJhZ21lbnQgcHJDaGVja291dENvbnRyb2xsZXJfcHVsbFJlcXVlc3Qgb24gUHVsbFJlcXVlc3Qge1xuICAgICAgbnVtYmVyXG4gICAgICBoZWFkUmVmTmFtZVxuICAgICAgaGVhZFJlcG9zaXRvcnkge1xuICAgICAgICBuYW1lXG4gICAgICAgIHVybFxuICAgICAgICBzc2hVcmxcbiAgICAgICAgb3duZXIge1xuICAgICAgICAgIGxvZ2luXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIGAsXG59KTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsVUFBQSxHQUFBRixz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