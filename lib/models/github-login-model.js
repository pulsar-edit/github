"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _crypto = _interopRequireDefault(require("crypto"));
var _eventKit = require("event-kit");
var _keytarStrategy = require("../shared/keytar-strategy");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
let instance = null;
class GithubLoginModel {
  // Be sure that we're requesting at least this many scopes on the token we grant through github.atom.io or we'll
  // give everyone a really frustrating experience ;-)

  static get() {
    if (!instance) {
      instance = new GithubLoginModel();
    }
    return instance;
  }
  constructor(Strategy) {
    this._Strategy = Strategy;
    this._strategy = null;
    this.emitter = new _eventKit.Emitter();
    this.checked = new Map();
  }
  async getStrategy() {
    if (this._strategy) {
      return this._strategy;
    }
    if (this._Strategy) {
      this._strategy = new this._Strategy();
      return this._strategy;
    }
    this._strategy = await (0, _keytarStrategy.createStrategy)();
    return this._strategy;
  }
  async getToken(account) {
    const strategy = await this.getStrategy();
    const password = await strategy.getPassword('atom-github', account);
    if (!password || password === _keytarStrategy.UNAUTHENTICATED) {
      // User is not logged in
      return _keytarStrategy.UNAUTHENTICATED;
    }
    if (/^https?:\/\//.test(account)) {
      // Avoid storing tokens in memory longer than necessary. Let's cache token scope checks by storing a set of
      // checksums instead.
      const hash = _crypto.default.createHash('md5');
      hash.update(password);
      const fingerprint = hash.digest('base64');
      const outcome = this.checked.get(fingerprint);
      if (outcome === _keytarStrategy.UNAUTHENTICATED || outcome === _keytarStrategy.INSUFFICIENT) {
        // Cached failure
        return outcome;
      } else if (!outcome) {
        // No cached outcome. Query for scopes.
        try {
          const scopes = await this.getScopes(account, password);
          if (scopes === _keytarStrategy.UNAUTHORIZED) {
            // Password is incorrect. Treat it as though you aren't authenticated at all.
            this.checked.set(fingerprint, _keytarStrategy.UNAUTHENTICATED);
            return _keytarStrategy.UNAUTHENTICATED;
          }
          const scopeSet = new Set(scopes);
          for (const scope of this.constructor.REQUIRED_SCOPES) {
            if (!scopeSet.has(scope)) {
              // Token doesn't have enough OAuth scopes, need to reauthenticate
              this.checked.set(fingerprint, _keytarStrategy.INSUFFICIENT);
              return _keytarStrategy.INSUFFICIENT;
            }
          }

          // Successfully authenticated and had all required scopes.
          this.checked.set(fingerprint, true);
        } catch (e) {
          // Most likely a network error. Do not cache the failure.
          return e;
        }
      }
    }
    return password;
  }
  async setToken(account, token) {
    const strategy = await this.getStrategy();
    await strategy.replacePassword('atom-github', account, token);
    this.didUpdate();
  }
  async removeToken(account) {
    const strategy = await this.getStrategy();
    await strategy.deletePassword('atom-github', account);
    this.didUpdate();
  }

  /* istanbul ignore next */
  async getScopes(host, token) {
    if (atom.inSpecMode()) {
      if (token === 'good-token') {
        return this.constructor.REQUIRED_SCOPES;
      }
      throw new Error('Attempt to check token scopes in specs');
    }
    let response;
    try {
      response = await fetch(host, {
        method: 'HEAD',
        headers: {
          Authorization: `bearer ${token}`
        }
      });
    } catch (e) {
      e.network = true;
      throw e;
    }
    if (response.status === 401) {
      return _keytarStrategy.UNAUTHORIZED;
    }
    if (response.status !== 200) {
      const e = new Error(`Unable to check token for OAuth scopes against ${host}`);
      e.response = response;
      e.responseText = await response.text();
      throw e;
    }
    return response.headers.get('X-OAuth-Scopes').split(/\s*,\s*/);
  }
  didUpdate() {
    this.emitter.emit('did-update');
  }
  onDidUpdate(cb) {
    return this.emitter.on('did-update', cb);
  }
  destroy() {
    this.emitter.dispose();
  }
}
exports.default = GithubLoginModel;
_defineProperty(GithubLoginModel, "REQUIRED_SCOPES", ['repo', 'read:org', 'user:email']);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY3J5cHRvIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfZXZlbnRLaXQiLCJfa2V5dGFyU3RyYXRlZ3kiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZpbmVQcm9wZXJ0eSIsImtleSIsInZhbHVlIiwiX3RvUHJvcGVydHlLZXkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJjb25maWd1cmFibGUiLCJ3cml0YWJsZSIsImFyZyIsIl90b1ByaW1pdGl2ZSIsIlN0cmluZyIsImlucHV0IiwiaGludCIsInByaW0iLCJTeW1ib2wiLCJ0b1ByaW1pdGl2ZSIsInVuZGVmaW5lZCIsInJlcyIsImNhbGwiLCJUeXBlRXJyb3IiLCJOdW1iZXIiLCJpbnN0YW5jZSIsIkdpdGh1YkxvZ2luTW9kZWwiLCJnZXQiLCJjb25zdHJ1Y3RvciIsIlN0cmF0ZWd5IiwiX1N0cmF0ZWd5IiwiX3N0cmF0ZWd5IiwiZW1pdHRlciIsIkVtaXR0ZXIiLCJjaGVja2VkIiwiTWFwIiwiZ2V0U3RyYXRlZ3kiLCJjcmVhdGVTdHJhdGVneSIsImdldFRva2VuIiwiYWNjb3VudCIsInN0cmF0ZWd5IiwicGFzc3dvcmQiLCJnZXRQYXNzd29yZCIsIlVOQVVUSEVOVElDQVRFRCIsInRlc3QiLCJoYXNoIiwiY3J5cHRvIiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImZpbmdlcnByaW50IiwiZGlnZXN0Iiwib3V0Y29tZSIsIklOU1VGRklDSUVOVCIsInNjb3BlcyIsImdldFNjb3BlcyIsIlVOQVVUSE9SSVpFRCIsInNldCIsInNjb3BlU2V0IiwiU2V0Iiwic2NvcGUiLCJSRVFVSVJFRF9TQ09QRVMiLCJoYXMiLCJlIiwic2V0VG9rZW4iLCJ0b2tlbiIsInJlcGxhY2VQYXNzd29yZCIsImRpZFVwZGF0ZSIsInJlbW92ZVRva2VuIiwiZGVsZXRlUGFzc3dvcmQiLCJob3N0IiwiYXRvbSIsImluU3BlY01vZGUiLCJFcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsIm5ldHdvcmsiLCJzdGF0dXMiLCJyZXNwb25zZVRleHQiLCJ0ZXh0Iiwic3BsaXQiLCJlbWl0Iiwib25EaWRVcGRhdGUiLCJjYiIsIm9uIiwiZGVzdHJveSIsImRpc3Bvc2UiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiZ2l0aHViLWxvZ2luLW1vZGVsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcbmltcG9ydCB7RW1pdHRlcn0gZnJvbSAnZXZlbnQta2l0JztcblxuaW1wb3J0IHtVTkFVVEhFTlRJQ0FURUQsIElOU1VGRklDSUVOVCwgVU5BVVRIT1JJWkVELCBjcmVhdGVTdHJhdGVneX0gZnJvbSAnLi4vc2hhcmVkL2tleXRhci1zdHJhdGVneSc7XG5cbmxldCBpbnN0YW5jZSA9IG51bGw7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdpdGh1YkxvZ2luTW9kZWwge1xuICAvLyBCZSBzdXJlIHRoYXQgd2UncmUgcmVxdWVzdGluZyBhdCBsZWFzdCB0aGlzIG1hbnkgc2NvcGVzIG9uIHRoZSB0b2tlbiB3ZSBncmFudCB0aHJvdWdoIGdpdGh1Yi5hdG9tLmlvIG9yIHdlJ2xsXG4gIC8vIGdpdmUgZXZlcnlvbmUgYSByZWFsbHkgZnJ1c3RyYXRpbmcgZXhwZXJpZW5jZSA7LSlcbiAgc3RhdGljIFJFUVVJUkVEX1NDT1BFUyA9IFsncmVwbycsICdyZWFkOm9yZycsICd1c2VyOmVtYWlsJ11cblxuICBzdGF0aWMgZ2V0KCkge1xuICAgIGlmICghaW5zdGFuY2UpIHtcbiAgICAgIGluc3RhbmNlID0gbmV3IEdpdGh1YkxvZ2luTW9kZWwoKTtcbiAgICB9XG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9XG5cbiAgY29uc3RydWN0b3IoU3RyYXRlZ3kpIHtcbiAgICB0aGlzLl9TdHJhdGVneSA9IFN0cmF0ZWd5O1xuICAgIHRoaXMuX3N0cmF0ZWd5ID0gbnVsbDtcbiAgICB0aGlzLmVtaXR0ZXIgPSBuZXcgRW1pdHRlcigpO1xuICAgIHRoaXMuY2hlY2tlZCA9IG5ldyBNYXAoKTtcbiAgfVxuXG4gIGFzeW5jIGdldFN0cmF0ZWd5KCkge1xuICAgIGlmICh0aGlzLl9zdHJhdGVneSkge1xuICAgICAgcmV0dXJuIHRoaXMuX3N0cmF0ZWd5O1xuICAgIH1cblxuICAgIGlmICh0aGlzLl9TdHJhdGVneSkge1xuICAgICAgdGhpcy5fc3RyYXRlZ3kgPSBuZXcgdGhpcy5fU3RyYXRlZ3koKTtcbiAgICAgIHJldHVybiB0aGlzLl9zdHJhdGVneTtcbiAgICB9XG5cbiAgICB0aGlzLl9zdHJhdGVneSA9IGF3YWl0IGNyZWF0ZVN0cmF0ZWd5KCk7XG4gICAgcmV0dXJuIHRoaXMuX3N0cmF0ZWd5O1xuICB9XG5cbiAgYXN5bmMgZ2V0VG9rZW4oYWNjb3VudCkge1xuICAgIGNvbnN0IHN0cmF0ZWd5ID0gYXdhaXQgdGhpcy5nZXRTdHJhdGVneSgpO1xuICAgIGNvbnN0IHBhc3N3b3JkID0gYXdhaXQgc3RyYXRlZ3kuZ2V0UGFzc3dvcmQoJ2F0b20tZ2l0aHViJywgYWNjb3VudCk7XG4gICAgaWYgKCFwYXNzd29yZCB8fCBwYXNzd29yZCA9PT0gVU5BVVRIRU5USUNBVEVEKSB7XG4gICAgICAvLyBVc2VyIGlzIG5vdCBsb2dnZWQgaW5cbiAgICAgIHJldHVybiBVTkFVVEhFTlRJQ0FURUQ7XG4gICAgfVxuXG4gICAgaWYgKC9eaHR0cHM/OlxcL1xcLy8udGVzdChhY2NvdW50KSkge1xuICAgICAgLy8gQXZvaWQgc3RvcmluZyB0b2tlbnMgaW4gbWVtb3J5IGxvbmdlciB0aGFuIG5lY2Vzc2FyeS4gTGV0J3MgY2FjaGUgdG9rZW4gc2NvcGUgY2hlY2tzIGJ5IHN0b3JpbmcgYSBzZXQgb2ZcbiAgICAgIC8vIGNoZWNrc3VtcyBpbnN0ZWFkLlxuICAgICAgY29uc3QgaGFzaCA9IGNyeXB0by5jcmVhdGVIYXNoKCdtZDUnKTtcbiAgICAgIGhhc2gudXBkYXRlKHBhc3N3b3JkKTtcbiAgICAgIGNvbnN0IGZpbmdlcnByaW50ID0gaGFzaC5kaWdlc3QoJ2Jhc2U2NCcpO1xuXG4gICAgICBjb25zdCBvdXRjb21lID0gdGhpcy5jaGVja2VkLmdldChmaW5nZXJwcmludCk7XG4gICAgICBpZiAob3V0Y29tZSA9PT0gVU5BVVRIRU5USUNBVEVEIHx8IG91dGNvbWUgPT09IElOU1VGRklDSUVOVCkge1xuICAgICAgICAvLyBDYWNoZWQgZmFpbHVyZVxuICAgICAgICByZXR1cm4gb3V0Y29tZTtcbiAgICAgIH0gZWxzZSBpZiAoIW91dGNvbWUpIHtcbiAgICAgICAgLy8gTm8gY2FjaGVkIG91dGNvbWUuIFF1ZXJ5IGZvciBzY29wZXMuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3Qgc2NvcGVzID0gYXdhaXQgdGhpcy5nZXRTY29wZXMoYWNjb3VudCwgcGFzc3dvcmQpO1xuICAgICAgICAgIGlmIChzY29wZXMgPT09IFVOQVVUSE9SSVpFRCkge1xuICAgICAgICAgICAgLy8gUGFzc3dvcmQgaXMgaW5jb3JyZWN0LiBUcmVhdCBpdCBhcyB0aG91Z2ggeW91IGFyZW4ndCBhdXRoZW50aWNhdGVkIGF0IGFsbC5cbiAgICAgICAgICAgIHRoaXMuY2hlY2tlZC5zZXQoZmluZ2VycHJpbnQsIFVOQVVUSEVOVElDQVRFRCk7XG4gICAgICAgICAgICByZXR1cm4gVU5BVVRIRU5USUNBVEVEO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjb25zdCBzY29wZVNldCA9IG5ldyBTZXQoc2NvcGVzKTtcblxuICAgICAgICAgIGZvciAoY29uc3Qgc2NvcGUgb2YgdGhpcy5jb25zdHJ1Y3Rvci5SRVFVSVJFRF9TQ09QRVMpIHtcbiAgICAgICAgICAgIGlmICghc2NvcGVTZXQuaGFzKHNjb3BlKSkge1xuICAgICAgICAgICAgICAvLyBUb2tlbiBkb2Vzbid0IGhhdmUgZW5vdWdoIE9BdXRoIHNjb3BlcywgbmVlZCB0byByZWF1dGhlbnRpY2F0ZVxuICAgICAgICAgICAgICB0aGlzLmNoZWNrZWQuc2V0KGZpbmdlcnByaW50LCBJTlNVRkZJQ0lFTlQpO1xuICAgICAgICAgICAgICByZXR1cm4gSU5TVUZGSUNJRU5UO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cblxuICAgICAgICAgIC8vIFN1Y2Nlc3NmdWxseSBhdXRoZW50aWNhdGVkIGFuZCBoYWQgYWxsIHJlcXVpcmVkIHNjb3Blcy5cbiAgICAgICAgICB0aGlzLmNoZWNrZWQuc2V0KGZpbmdlcnByaW50LCB0cnVlKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8vIE1vc3QgbGlrZWx5IGEgbmV0d29yayBlcnJvci4gRG8gbm90IGNhY2hlIHRoZSBmYWlsdXJlLlxuICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHBhc3N3b3JkO1xuICB9XG5cbiAgYXN5bmMgc2V0VG9rZW4oYWNjb3VudCwgdG9rZW4pIHtcbiAgICBjb25zdCBzdHJhdGVneSA9IGF3YWl0IHRoaXMuZ2V0U3RyYXRlZ3koKTtcbiAgICBhd2FpdCBzdHJhdGVneS5yZXBsYWNlUGFzc3dvcmQoJ2F0b20tZ2l0aHViJywgYWNjb3VudCwgdG9rZW4pO1xuICAgIHRoaXMuZGlkVXBkYXRlKCk7XG4gIH1cblxuICBhc3luYyByZW1vdmVUb2tlbihhY2NvdW50KSB7XG4gICAgY29uc3Qgc3RyYXRlZ3kgPSBhd2FpdCB0aGlzLmdldFN0cmF0ZWd5KCk7XG4gICAgYXdhaXQgc3RyYXRlZ3kuZGVsZXRlUGFzc3dvcmQoJ2F0b20tZ2l0aHViJywgYWNjb3VudCk7XG4gICAgdGhpcy5kaWRVcGRhdGUoKTtcbiAgfVxuXG4gIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gIGFzeW5jIGdldFNjb3Blcyhob3N0LCB0b2tlbikge1xuICAgIGlmIChhdG9tLmluU3BlY01vZGUoKSkge1xuICAgICAgaWYgKHRva2VuID09PSAnZ29vZC10b2tlbicpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IuUkVRVUlSRURfU0NPUEVTO1xuICAgICAgfVxuXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0F0dGVtcHQgdG8gY2hlY2sgdG9rZW4gc2NvcGVzIGluIHNwZWNzJyk7XG4gICAgfVxuXG4gICAgbGV0IHJlc3BvbnNlO1xuICAgIHRyeSB7XG4gICAgICByZXNwb25zZSA9IGF3YWl0IGZldGNoKGhvc3QsIHtcbiAgICAgICAgbWV0aG9kOiAnSEVBRCcsXG4gICAgICAgIGhlYWRlcnM6IHtBdXRob3JpemF0aW9uOiBgYmVhcmVyICR7dG9rZW59YH0sXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBlLm5ldHdvcmsgPSB0cnVlO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG5cbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgIHJldHVybiBVTkFVVEhPUklaRUQ7XG4gICAgfVxuXG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7XG4gICAgICBjb25zdCBlID0gbmV3IEVycm9yKGBVbmFibGUgdG8gY2hlY2sgdG9rZW4gZm9yIE9BdXRoIHNjb3BlcyBhZ2FpbnN0ICR7aG9zdH1gKTtcbiAgICAgIGUucmVzcG9uc2UgPSByZXNwb25zZTtcbiAgICAgIGUucmVzcG9uc2VUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgICAgdGhyb3cgZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ1gtT0F1dGgtU2NvcGVzJykuc3BsaXQoL1xccyosXFxzKi8pO1xuICB9XG5cbiAgZGlkVXBkYXRlKCkge1xuICAgIHRoaXMuZW1pdHRlci5lbWl0KCdkaWQtdXBkYXRlJyk7XG4gIH1cblxuICBvbkRpZFVwZGF0ZShjYikge1xuICAgIHJldHVybiB0aGlzLmVtaXR0ZXIub24oJ2RpZC11cGRhdGUnLCBjYik7XG4gIH1cblxuICBkZXN0cm95KCkge1xuICAgIHRoaXMuZW1pdHRlci5kaXNwb3NlKCk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7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