"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _atom = require("atom");
var _util = require("util");
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == typeof i ? i : String(i); }
function _toPrimitive(t, r) { if ("object" != typeof t || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != typeof i) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
const LAYER_NAMES = ['unchanged', 'addition', 'deletion', 'nonewline', 'hunk', 'patch'];
class PatchBuffer {
  constructor() {
    this.buffer = new _atom.TextBuffer();
    this.buffer.retain();
    this.layers = LAYER_NAMES.reduce((map, layerName) => {
      map[layerName] = this.buffer.addMarkerLayer();
      return map;
    }, {});
  }
  getBuffer() {
    return this.buffer;
  }
  getInsertionPoint() {
    return this.buffer.getEndPosition();
  }
  getLayer(layerName) {
    return this.layers[layerName];
  }
  findMarkers(layerName, ...args) {
    return this.layers[layerName].findMarkers(...args);
  }
  findAllMarkers(...args) {
    return LAYER_NAMES.reduce((arr, layerName) => {
      arr.push(...this.findMarkers(layerName, ...args));
      return arr;
    }, []);
  }
  markPosition(layerName, ...args) {
    return this.layers[layerName].markPosition(...args);
  }
  markRange(layerName, ...args) {
    return this.layers[layerName].markRange(...args);
  }
  clearAllLayers() {
    for (const layerName of LAYER_NAMES) {
      this.layers[layerName].clear();
    }
  }
  createInserterAt(insertionPoint) {
    return new Inserter(this, _atom.Point.fromObject(insertionPoint));
  }
  createInserterAtEnd() {
    return this.createInserterAt(this.getInsertionPoint());
  }
  createSubBuffer(rangeLike, options = {}) {
    const opts = _objectSpread({
      exclude: new Set()
    }, options);
    const range = _atom.Range.fromObject(rangeLike);
    const baseOffset = range.start.negate();
    const includedMarkersByLayer = LAYER_NAMES.reduce((map, layerName) => {
      map[layerName] = this.layers[layerName].findMarkers({
        intersectsRange: range
      }).filter(m => !opts.exclude.has(m));
      return map;
    }, {});
    const markerMap = new Map();
    const subBuffer = new PatchBuffer();
    subBuffer.getBuffer().setText(this.buffer.getTextInRange(range));
    for (const layerName of LAYER_NAMES) {
      for (const oldMarker of includedMarkersByLayer[layerName]) {
        const oldRange = oldMarker.getRange();
        const clippedStart = oldRange.start.isLessThanOrEqual(range.start) ? range.start : oldRange.start;
        const clippedEnd = oldRange.end.isGreaterThanOrEqual(range.end) ? range.end : oldRange.end;

        // Exclude non-empty markers that intersect *only* at the range start or end
        if (clippedStart.isEqual(clippedEnd) && !oldRange.start.isEqual(oldRange.end)) {
          continue;
        }
        const startOffset = clippedStart.row === range.start.row ? baseOffset : [baseOffset.row, 0];
        const endOffset = clippedEnd.row === range.start.row ? baseOffset : [baseOffset.row, 0];
        const newMarker = subBuffer.markRange(layerName, [clippedStart.translate(startOffset), clippedEnd.translate(endOffset)], oldMarker.getProperties());
        markerMap.set(oldMarker, newMarker);
      }
    }
    return {
      patchBuffer: subBuffer,
      markerMap
    };
  }
  extractPatchBuffer(rangeLike, options = {}) {
    const {
      patchBuffer: subBuffer,
      markerMap
    } = this.createSubBuffer(rangeLike, options);
    for (const oldMarker of markerMap.keys()) {
      oldMarker.destroy();
    }
    this.buffer.setTextInRange(rangeLike, '');
    return {
      patchBuffer: subBuffer,
      markerMap
    };
  }
  deleteLastNewline() {
    if (this.buffer.getLastLine() === '') {
      this.buffer.deleteRow(this.buffer.getLastRow());
    }
    return this;
  }
  adopt(original) {
    this.clearAllLayers();
    this.buffer.setText(original.getBuffer().getText());
    const markerMap = new Map();
    for (const layerName of LAYER_NAMES) {
      for (const originalMarker of original.getLayer(layerName).getMarkers()) {
        const newMarker = this.markRange(layerName, originalMarker.getRange(), originalMarker.getProperties());
        markerMap.set(originalMarker, newMarker);
      }
    }
    return markerMap;
  }

  /* istanbul ignore next */
  inspect(opts = {}) {
    /* istanbul ignore next */
    const options = _objectSpread({
      layerNames: LAYER_NAMES
    }, opts);
    let inspectString = '';
    const increasingMarkers = [];
    for (const layerName of options.layerNames) {
      for (const marker of this.findMarkers(layerName, {})) {
        increasingMarkers.push({
          layerName,
          point: marker.getRange().start,
          start: true,
          id: marker.id
        });
        increasingMarkers.push({
          layerName,
          point: marker.getRange().end,
          end: true,
          id: marker.id
        });
      }
    }
    increasingMarkers.sort((a, b) => {
      const cmp = a.point.compare(b.point);
      if (cmp !== 0) {
        return cmp;
      } else if (a.start && b.start) {
        return 0;
      } else if (a.start && !b.start) {
        return -1;
      } else if (!a.start && b.start) {
        return 1;
      } else {
        return 0;
      }
    });
    let inspectPoint = _atom.Point.fromObject([0, 0]);
    for (const marker of increasingMarkers) {
      if (!marker.point.isEqual(inspectPoint)) {
        inspectString += (0, _util.inspect)(this.buffer.getTextInRange([inspectPoint, marker.point])) + '\n';
      }
      if (marker.start) {
        inspectString += `  start ${marker.layerName}@${marker.id}\n`;
      } else if (marker.end) {
        inspectString += `  end ${marker.layerName}@${marker.id}\n`;
      }
      inspectPoint = marker.point;
    }
    return inspectString;
  }
}
exports.default = PatchBuffer;
class Inserter {
  constructor(patchBuffer, insertionPoint) {
    const clipped = patchBuffer.getBuffer().clipPosition(insertionPoint);
    this.patchBuffer = patchBuffer;
    this.startPoint = clipped.copy();
    this.insertionPoint = clipped.copy();
    this.markerBlueprints = [];
    this.markerMapCallbacks = [];
    this.markersBefore = new Set();
    this.markersAfter = new Set();
  }
  keepBefore(markers) {
    for (const marker of markers) {
      if (marker.getRange().end.isEqual(this.startPoint)) {
        this.markersBefore.add(marker);
      }
    }
    return this;
  }
  keepAfter(markers) {
    for (const marker of markers) {
      if (marker.getRange().start.isEqual(this.startPoint)) {
        this.markersAfter.add(marker);
      }
    }
    return this;
  }
  markWhile(layerName, block, markerOpts) {
    const start = this.insertionPoint.copy();
    block();
    const end = this.insertionPoint.copy();
    this.markerBlueprints.push({
      layerName,
      range: new _atom.Range(start, end),
      markerOpts
    });
    return this;
  }
  insert(text) {
    const insertedRange = this.patchBuffer.getBuffer().insert(this.insertionPoint, text);
    this.insertionPoint = insertedRange.end;
    return this;
  }
  insertMarked(text, layerName, markerOpts) {
    return this.markWhile(layerName, () => this.insert(text), markerOpts);
  }
  insertPatchBuffer(subPatchBuffer, opts) {
    const baseOffset = this.insertionPoint.copy();
    this.insert(subPatchBuffer.getBuffer().getText());
    const subMarkerMap = new Map();
    for (const layerName of LAYER_NAMES) {
      for (const oldMarker of subPatchBuffer.findMarkers(layerName, {})) {
        const startOffset = oldMarker.getRange().start.row === 0 ? baseOffset : [baseOffset.row, 0];
        const endOffset = oldMarker.getRange().end.row === 0 ? baseOffset : [baseOffset.row, 0];
        const range = oldMarker.getRange().translate(startOffset, endOffset);
        const markerOpts = _objectSpread({}, oldMarker.getProperties(), {
          callback: newMarker => {
            subMarkerMap.set(oldMarker, newMarker);
          }
        });
        this.markerBlueprints.push({
          layerName,
          range,
          markerOpts
        });
      }
    }
    this.markerMapCallbacks.push({
      markerMap: subMarkerMap,
      callback: opts.callback
    });
    return this;
  }
  apply() {
    for (const {
      layerName,
      range,
      markerOpts
    } of this.markerBlueprints) {
      const callback = markerOpts.callback;
      delete markerOpts.callback;
      const marker = this.patchBuffer.markRange(layerName, range, markerOpts);
      if (callback) {
        callback(marker);
      }
    }
    for (const {
      markerMap,
      callback
    } of this.markerMapCallbacks) {
      callback(markerMap);
    }
    for (const beforeMarker of this.markersBefore) {
      const isEmpty = beforeMarker.getRange().isEmpty();
      if (!beforeMarker.isReversed()) {
        beforeMarker.setHeadPosition(this.startPoint);
        if (isEmpty) {
          beforeMarker.setTailPosition(this.startPoint);
        }
      } else {
        beforeMarker.setTailPosition(this.startPoint);
        if (isEmpty) {
          beforeMarker.setHeadPosition(this.startPoint);
        }
      }
    }
    for (const afterMarker of this.markersAfter) {
      const isEmpty = afterMarker.getRange().isEmpty();
      if (!afterMarker.isReversed()) {
        afterMarker.setTailPosition(this.insertionPoint);
        if (isEmpty) {
          afterMarker.setHeadPosition(this.insertionPoint);
        }
      } else {
        afterMarker.setHeadPosition(this.insertionPoint);
        if (isEmpty) {
          afterMarker.setTailPosition(this.insertionPoint);
        }
      }
    }
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXRvbSIsInJlcXVpcmUiLCJfdXRpbCIsIm93bktleXMiLCJlIiwiciIsInQiLCJPYmplY3QiLCJrZXlzIiwiZ2V0T3duUHJvcGVydHlTeW1ib2xzIiwibyIsImZpbHRlciIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImVudW1lcmFibGUiLCJwdXNoIiwiYXBwbHkiLCJfb2JqZWN0U3ByZWFkIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiZm9yRWFjaCIsIl9kZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvcnMiLCJkZWZpbmVQcm9wZXJ0aWVzIiwiZGVmaW5lUHJvcGVydHkiLCJvYmoiLCJrZXkiLCJ2YWx1ZSIsIl90b1Byb3BlcnR5S2V5IiwiY29uZmlndXJhYmxlIiwid3JpdGFibGUiLCJpIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiU3ltYm9sIiwidG9QcmltaXRpdmUiLCJjYWxsIiwiVHlwZUVycm9yIiwiTnVtYmVyIiwiTEFZRVJfTkFNRVMiLCJQYXRjaEJ1ZmZlciIsImNvbnN0cnVjdG9yIiwiYnVmZmVyIiwiVGV4dEJ1ZmZlciIsInJldGFpbiIsImxheWVycyIsInJlZHVjZSIsIm1hcCIsImxheWVyTmFtZSIsImFkZE1hcmtlckxheWVyIiwiZ2V0QnVmZmVyIiwiZ2V0SW5zZXJ0aW9uUG9pbnQiLCJnZXRFbmRQb3NpdGlvbiIsImdldExheWVyIiwiZmluZE1hcmtlcnMiLCJhcmdzIiwiZmluZEFsbE1hcmtlcnMiLCJhcnIiLCJtYXJrUG9zaXRpb24iLCJtYXJrUmFuZ2UiLCJjbGVhckFsbExheWVycyIsImNsZWFyIiwiY3JlYXRlSW5zZXJ0ZXJBdCIsImluc2VydGlvblBvaW50IiwiSW5zZXJ0ZXIiLCJQb2ludCIsImZyb21PYmplY3QiLCJjcmVhdGVJbnNlcnRlckF0RW5kIiwiY3JlYXRlU3ViQnVmZmVyIiwicmFuZ2VMaWtlIiwib3B0aW9ucyIsIm9wdHMiLCJleGNsdWRlIiwiU2V0IiwicmFuZ2UiLCJSYW5nZSIsImJhc2VPZmZzZXQiLCJzdGFydCIsIm5lZ2F0ZSIsImluY2x1ZGVkTWFya2Vyc0J5TGF5ZXIiLCJpbnRlcnNlY3RzUmFuZ2UiLCJtIiwiaGFzIiwibWFya2VyTWFwIiwiTWFwIiwic3ViQnVmZmVyIiwic2V0VGV4dCIsImdldFRleHRJblJhbmdlIiwib2xkTWFya2VyIiwib2xkUmFuZ2UiLCJnZXRSYW5nZSIsImNsaXBwZWRTdGFydCIsImlzTGVzc1RoYW5PckVxdWFsIiwiY2xpcHBlZEVuZCIsImVuZCIsImlzR3JlYXRlclRoYW5PckVxdWFsIiwiaXNFcXVhbCIsInN0YXJ0T2Zmc2V0Iiwicm93IiwiZW5kT2Zmc2V0IiwibmV3TWFya2VyIiwidHJhbnNsYXRlIiwiZ2V0UHJvcGVydGllcyIsInNldCIsInBhdGNoQnVmZmVyIiwiZXh0cmFjdFBhdGNoQnVmZmVyIiwiZGVzdHJveSIsInNldFRleHRJblJhbmdlIiwiZGVsZXRlTGFzdE5ld2xpbmUiLCJnZXRMYXN0TGluZSIsImRlbGV0ZVJvdyIsImdldExhc3RSb3ciLCJhZG9wdCIsIm9yaWdpbmFsIiwiZ2V0VGV4dCIsIm9yaWdpbmFsTWFya2VyIiwiZ2V0TWFya2VycyIsImluc3BlY3QiLCJsYXllck5hbWVzIiwiaW5zcGVjdFN0cmluZyIsImluY3JlYXNpbmdNYXJrZXJzIiwibWFya2VyIiwicG9pbnQiLCJpZCIsInNvcnQiLCJhIiwiYiIsImNtcCIsImNvbXBhcmUiLCJpbnNwZWN0UG9pbnQiLCJleHBvcnRzIiwiZGVmYXVsdCIsImNsaXBwZWQiLCJjbGlwUG9zaXRpb24iLCJzdGFydFBvaW50IiwiY29weSIsIm1hcmtlckJsdWVwcmludHMiLCJtYXJrZXJNYXBDYWxsYmFja3MiLCJtYXJrZXJzQmVmb3JlIiwibWFya2Vyc0FmdGVyIiwia2VlcEJlZm9yZSIsIm1hcmtlcnMiLCJhZGQiLCJrZWVwQWZ0ZXIiLCJtYXJrV2hpbGUiLCJibG9jayIsIm1hcmtlck9wdHMiLCJpbnNlcnQiLCJ0ZXh0IiwiaW5zZXJ0ZWRSYW5nZSIsImluc2VydE1hcmtlZCIsImluc2VydFBhdGNoQnVmZmVyIiwic3ViUGF0Y2hCdWZmZXIiLCJzdWJNYXJrZXJNYXAiLCJjYWxsYmFjayIsImJlZm9yZU1hcmtlciIsImlzRW1wdHkiLCJpc1JldmVyc2VkIiwic2V0SGVhZFBvc2l0aW9uIiwic2V0VGFpbFBvc2l0aW9uIiwiYWZ0ZXJNYXJrZXIiXSwic291cmNlcyI6WyJwYXRjaC1idWZmZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtUZXh0QnVmZmVyLCBSYW5nZSwgUG9pbnR9IGZyb20gJ2F0b20nO1xuaW1wb3J0IHtpbnNwZWN0fSBmcm9tICd1dGlsJztcblxuY29uc3QgTEFZRVJfTkFNRVMgPSBbJ3VuY2hhbmdlZCcsICdhZGRpdGlvbicsICdkZWxldGlvbicsICdub25ld2xpbmUnLCAnaHVuaycsICdwYXRjaCddO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQYXRjaEJ1ZmZlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuYnVmZmVyID0gbmV3IFRleHRCdWZmZXIoKTtcbiAgICB0aGlzLmJ1ZmZlci5yZXRhaW4oKTtcblxuICAgIHRoaXMubGF5ZXJzID0gTEFZRVJfTkFNRVMucmVkdWNlKChtYXAsIGxheWVyTmFtZSkgPT4ge1xuICAgICAgbWFwW2xheWVyTmFtZV0gPSB0aGlzLmJ1ZmZlci5hZGRNYXJrZXJMYXllcigpO1xuICAgICAgcmV0dXJuIG1hcDtcbiAgICB9LCB7fSk7XG4gIH1cblxuICBnZXRCdWZmZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuYnVmZmVyO1xuICB9XG5cbiAgZ2V0SW5zZXJ0aW9uUG9pbnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuYnVmZmVyLmdldEVuZFBvc2l0aW9uKCk7XG4gIH1cblxuICBnZXRMYXllcihsYXllck5hbWUpIHtcbiAgICByZXR1cm4gdGhpcy5sYXllcnNbbGF5ZXJOYW1lXTtcbiAgfVxuXG4gIGZpbmRNYXJrZXJzKGxheWVyTmFtZSwgLi4uYXJncykge1xuICAgIHJldHVybiB0aGlzLmxheWVyc1tsYXllck5hbWVdLmZpbmRNYXJrZXJzKC4uLmFyZ3MpO1xuICB9XG5cbiAgZmluZEFsbE1hcmtlcnMoLi4uYXJncykge1xuICAgIHJldHVybiBMQVlFUl9OQU1FUy5yZWR1Y2UoKGFyciwgbGF5ZXJOYW1lKSA9PiB7XG4gICAgICBhcnIucHVzaCguLi50aGlzLmZpbmRNYXJrZXJzKGxheWVyTmFtZSwgLi4uYXJncykpO1xuICAgICAgcmV0dXJuIGFycjtcbiAgICB9LCBbXSk7XG4gIH1cblxuICBtYXJrUG9zaXRpb24obGF5ZXJOYW1lLCAuLi5hcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMubGF5ZXJzW2xheWVyTmFtZV0ubWFya1Bvc2l0aW9uKC4uLmFyZ3MpO1xuICB9XG5cbiAgbWFya1JhbmdlKGxheWVyTmFtZSwgLi4uYXJncykge1xuICAgIHJldHVybiB0aGlzLmxheWVyc1tsYXllck5hbWVdLm1hcmtSYW5nZSguLi5hcmdzKTtcbiAgfVxuXG4gIGNsZWFyQWxsTGF5ZXJzKCkge1xuICAgIGZvciAoY29uc3QgbGF5ZXJOYW1lIG9mIExBWUVSX05BTUVTKSB7XG4gICAgICB0aGlzLmxheWVyc1tsYXllck5hbWVdLmNsZWFyKCk7XG4gICAgfVxuICB9XG5cbiAgY3JlYXRlSW5zZXJ0ZXJBdChpbnNlcnRpb25Qb2ludCkge1xuICAgIHJldHVybiBuZXcgSW5zZXJ0ZXIodGhpcywgUG9pbnQuZnJvbU9iamVjdChpbnNlcnRpb25Qb2ludCkpO1xuICB9XG5cbiAgY3JlYXRlSW5zZXJ0ZXJBdEVuZCgpIHtcbiAgICByZXR1cm4gdGhpcy5jcmVhdGVJbnNlcnRlckF0KHRoaXMuZ2V0SW5zZXJ0aW9uUG9pbnQoKSk7XG4gIH1cblxuICBjcmVhdGVTdWJCdWZmZXIocmFuZ2VMaWtlLCBvcHRpb25zID0ge30pIHtcbiAgICBjb25zdCBvcHRzID0ge1xuICAgICAgZXhjbHVkZTogbmV3IFNldCgpLFxuICAgICAgLi4ub3B0aW9ucyxcbiAgICB9O1xuXG4gICAgY29uc3QgcmFuZ2UgPSBSYW5nZS5mcm9tT2JqZWN0KHJhbmdlTGlrZSk7XG4gICAgY29uc3QgYmFzZU9mZnNldCA9IHJhbmdlLnN0YXJ0Lm5lZ2F0ZSgpO1xuICAgIGNvbnN0IGluY2x1ZGVkTWFya2Vyc0J5TGF5ZXIgPSBMQVlFUl9OQU1FUy5yZWR1Y2UoKG1hcCwgbGF5ZXJOYW1lKSA9PiB7XG4gICAgICBtYXBbbGF5ZXJOYW1lXSA9IHRoaXMubGF5ZXJzW2xheWVyTmFtZV1cbiAgICAgICAgLmZpbmRNYXJrZXJzKHtpbnRlcnNlY3RzUmFuZ2U6IHJhbmdlfSlcbiAgICAgICAgLmZpbHRlcihtID0+ICFvcHRzLmV4Y2x1ZGUuaGFzKG0pKTtcbiAgICAgIHJldHVybiBtYXA7XG4gICAgfSwge30pO1xuICAgIGNvbnN0IG1hcmtlck1hcCA9IG5ldyBNYXAoKTtcblxuICAgIGNvbnN0IHN1YkJ1ZmZlciA9IG5ldyBQYXRjaEJ1ZmZlcigpO1xuICAgIHN1YkJ1ZmZlci5nZXRCdWZmZXIoKS5zZXRUZXh0KHRoaXMuYnVmZmVyLmdldFRleHRJblJhbmdlKHJhbmdlKSk7XG5cbiAgICBmb3IgKGNvbnN0IGxheWVyTmFtZSBvZiBMQVlFUl9OQU1FUykge1xuICAgICAgZm9yIChjb25zdCBvbGRNYXJrZXIgb2YgaW5jbHVkZWRNYXJrZXJzQnlMYXllcltsYXllck5hbWVdKSB7XG4gICAgICAgIGNvbnN0IG9sZFJhbmdlID0gb2xkTWFya2VyLmdldFJhbmdlKCk7XG5cbiAgICAgICAgY29uc3QgY2xpcHBlZFN0YXJ0ID0gb2xkUmFuZ2Uuc3RhcnQuaXNMZXNzVGhhbk9yRXF1YWwocmFuZ2Uuc3RhcnQpID8gcmFuZ2Uuc3RhcnQgOiBvbGRSYW5nZS5zdGFydDtcbiAgICAgICAgY29uc3QgY2xpcHBlZEVuZCA9IG9sZFJhbmdlLmVuZC5pc0dyZWF0ZXJUaGFuT3JFcXVhbChyYW5nZS5lbmQpID8gcmFuZ2UuZW5kIDogb2xkUmFuZ2UuZW5kO1xuXG4gICAgICAgIC8vIEV4Y2x1ZGUgbm9uLWVtcHR5IG1hcmtlcnMgdGhhdCBpbnRlcnNlY3QgKm9ubHkqIGF0IHRoZSByYW5nZSBzdGFydCBvciBlbmRcbiAgICAgICAgaWYgKGNsaXBwZWRTdGFydC5pc0VxdWFsKGNsaXBwZWRFbmQpICYmICFvbGRSYW5nZS5zdGFydC5pc0VxdWFsKG9sZFJhbmdlLmVuZCkpIHtcbiAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gY2xpcHBlZFN0YXJ0LnJvdyA9PT0gcmFuZ2Uuc3RhcnQucm93ID8gYmFzZU9mZnNldCA6IFtiYXNlT2Zmc2V0LnJvdywgMF07XG4gICAgICAgIGNvbnN0IGVuZE9mZnNldCA9IGNsaXBwZWRFbmQucm93ID09PSByYW5nZS5zdGFydC5yb3cgPyBiYXNlT2Zmc2V0IDogW2Jhc2VPZmZzZXQucm93LCAwXTtcblxuICAgICAgICBjb25zdCBuZXdNYXJrZXIgPSBzdWJCdWZmZXIubWFya1JhbmdlKFxuICAgICAgICAgIGxheWVyTmFtZSxcbiAgICAgICAgICBbY2xpcHBlZFN0YXJ0LnRyYW5zbGF0ZShzdGFydE9mZnNldCksIGNsaXBwZWRFbmQudHJhbnNsYXRlKGVuZE9mZnNldCldLFxuICAgICAgICAgIG9sZE1hcmtlci5nZXRQcm9wZXJ0aWVzKCksXG4gICAgICAgICk7XG4gICAgICAgIG1hcmtlck1hcC5zZXQob2xkTWFya2VyLCBuZXdNYXJrZXIpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7cGF0Y2hCdWZmZXI6IHN1YkJ1ZmZlciwgbWFya2VyTWFwfTtcbiAgfVxuXG4gIGV4dHJhY3RQYXRjaEJ1ZmZlcihyYW5nZUxpa2UsIG9wdGlvbnMgPSB7fSkge1xuICAgIGNvbnN0IHtwYXRjaEJ1ZmZlcjogc3ViQnVmZmVyLCBtYXJrZXJNYXB9ID0gdGhpcy5jcmVhdGVTdWJCdWZmZXIocmFuZ2VMaWtlLCBvcHRpb25zKTtcblxuICAgIGZvciAoY29uc3Qgb2xkTWFya2VyIG9mIG1hcmtlck1hcC5rZXlzKCkpIHtcbiAgICAgIG9sZE1hcmtlci5kZXN0cm95KCk7XG4gICAgfVxuXG4gICAgdGhpcy5idWZmZXIuc2V0VGV4dEluUmFuZ2UocmFuZ2VMaWtlLCAnJyk7XG4gICAgcmV0dXJuIHtwYXRjaEJ1ZmZlcjogc3ViQnVmZmVyLCBtYXJrZXJNYXB9O1xuICB9XG5cbiAgZGVsZXRlTGFzdE5ld2xpbmUoKSB7XG4gICAgaWYgKHRoaXMuYnVmZmVyLmdldExhc3RMaW5lKCkgPT09ICcnKSB7XG4gICAgICB0aGlzLmJ1ZmZlci5kZWxldGVSb3codGhpcy5idWZmZXIuZ2V0TGFzdFJvdygpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGFkb3B0KG9yaWdpbmFsKSB7XG4gICAgdGhpcy5jbGVhckFsbExheWVycygpO1xuICAgIHRoaXMuYnVmZmVyLnNldFRleHQob3JpZ2luYWwuZ2V0QnVmZmVyKCkuZ2V0VGV4dCgpKTtcblxuICAgIGNvbnN0IG1hcmtlck1hcCA9IG5ldyBNYXAoKTtcbiAgICBmb3IgKGNvbnN0IGxheWVyTmFtZSBvZiBMQVlFUl9OQU1FUykge1xuICAgICAgZm9yIChjb25zdCBvcmlnaW5hbE1hcmtlciBvZiBvcmlnaW5hbC5nZXRMYXllcihsYXllck5hbWUpLmdldE1hcmtlcnMoKSkge1xuICAgICAgICBjb25zdCBuZXdNYXJrZXIgPSB0aGlzLm1hcmtSYW5nZShsYXllck5hbWUsIG9yaWdpbmFsTWFya2VyLmdldFJhbmdlKCksIG9yaWdpbmFsTWFya2VyLmdldFByb3BlcnRpZXMoKSk7XG4gICAgICAgIG1hcmtlck1hcC5zZXQob3JpZ2luYWxNYXJrZXIsIG5ld01hcmtlcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXJrZXJNYXA7XG4gIH1cblxuICAvKiBpc3RhbmJ1bCBpZ25vcmUgbmV4dCAqL1xuICBpbnNwZWN0KG9wdHMgPSB7fSkge1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgIGxheWVyTmFtZXM6IExBWUVSX05BTUVTLFxuICAgICAgLi4ub3B0cyxcbiAgICB9O1xuXG4gICAgbGV0IGluc3BlY3RTdHJpbmcgPSAnJztcblxuICAgIGNvbnN0IGluY3JlYXNpbmdNYXJrZXJzID0gW107XG4gICAgZm9yIChjb25zdCBsYXllck5hbWUgb2Ygb3B0aW9ucy5sYXllck5hbWVzKSB7XG4gICAgICBmb3IgKGNvbnN0IG1hcmtlciBvZiB0aGlzLmZpbmRNYXJrZXJzKGxheWVyTmFtZSwge30pKSB7XG4gICAgICAgIGluY3JlYXNpbmdNYXJrZXJzLnB1c2goe2xheWVyTmFtZSwgcG9pbnQ6IG1hcmtlci5nZXRSYW5nZSgpLnN0YXJ0LCBzdGFydDogdHJ1ZSwgaWQ6IG1hcmtlci5pZH0pO1xuICAgICAgICBpbmNyZWFzaW5nTWFya2Vycy5wdXNoKHtsYXllck5hbWUsIHBvaW50OiBtYXJrZXIuZ2V0UmFuZ2UoKS5lbmQsIGVuZDogdHJ1ZSwgaWQ6IG1hcmtlci5pZH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpbmNyZWFzaW5nTWFya2Vycy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICBjb25zdCBjbXAgPSBhLnBvaW50LmNvbXBhcmUoYi5wb2ludCk7XG4gICAgICBpZiAoY21wICE9PSAwKSB7XG4gICAgICAgIHJldHVybiBjbXA7XG4gICAgICB9IGVsc2UgaWYgKGEuc3RhcnQgJiYgYi5zdGFydCkge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH0gZWxzZSBpZiAoYS5zdGFydCAmJiAhYi5zdGFydCkge1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgICB9IGVsc2UgaWYgKCFhLnN0YXJ0ICYmIGIuc3RhcnQpIHtcbiAgICAgICAgcmV0dXJuIDE7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gMDtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGxldCBpbnNwZWN0UG9pbnQgPSBQb2ludC5mcm9tT2JqZWN0KFswLCAwXSk7XG4gICAgZm9yIChjb25zdCBtYXJrZXIgb2YgaW5jcmVhc2luZ01hcmtlcnMpIHtcbiAgICAgIGlmICghbWFya2VyLnBvaW50LmlzRXF1YWwoaW5zcGVjdFBvaW50KSkge1xuICAgICAgICBpbnNwZWN0U3RyaW5nICs9IGluc3BlY3QodGhpcy5idWZmZXIuZ2V0VGV4dEluUmFuZ2UoW2luc3BlY3RQb2ludCwgbWFya2VyLnBvaW50XSkpICsgJ1xcbic7XG4gICAgICB9XG5cbiAgICAgIGlmIChtYXJrZXIuc3RhcnQpIHtcbiAgICAgICAgaW5zcGVjdFN0cmluZyArPSBgICBzdGFydCAke21hcmtlci5sYXllck5hbWV9QCR7bWFya2VyLmlkfVxcbmA7XG4gICAgICB9IGVsc2UgaWYgKG1hcmtlci5lbmQpIHtcbiAgICAgICAgaW5zcGVjdFN0cmluZyArPSBgICBlbmQgJHttYXJrZXIubGF5ZXJOYW1lfUAke21hcmtlci5pZH1cXG5gO1xuICAgICAgfVxuXG4gICAgICBpbnNwZWN0UG9pbnQgPSBtYXJrZXIucG9pbnQ7XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3BlY3RTdHJpbmc7XG4gIH1cbn1cblxuY2xhc3MgSW5zZXJ0ZXIge1xuICBjb25zdHJ1Y3RvcihwYXRjaEJ1ZmZlciwgaW5zZXJ0aW9uUG9pbnQpIHtcbiAgICBjb25zdCBjbGlwcGVkID0gcGF0Y2hCdWZmZXIuZ2V0QnVmZmVyKCkuY2xpcFBvc2l0aW9uKGluc2VydGlvblBvaW50KTtcblxuICAgIHRoaXMucGF0Y2hCdWZmZXIgPSBwYXRjaEJ1ZmZlcjtcbiAgICB0aGlzLnN0YXJ0UG9pbnQgPSBjbGlwcGVkLmNvcHkoKTtcbiAgICB0aGlzLmluc2VydGlvblBvaW50ID0gY2xpcHBlZC5jb3B5KCk7XG4gICAgdGhpcy5tYXJrZXJCbHVlcHJpbnRzID0gW107XG4gICAgdGhpcy5tYXJrZXJNYXBDYWxsYmFja3MgPSBbXTtcblxuICAgIHRoaXMubWFya2Vyc0JlZm9yZSA9IG5ldyBTZXQoKTtcbiAgICB0aGlzLm1hcmtlcnNBZnRlciA9IG5ldyBTZXQoKTtcbiAgfVxuXG4gIGtlZXBCZWZvcmUobWFya2Vycykge1xuICAgIGZvciAoY29uc3QgbWFya2VyIG9mIG1hcmtlcnMpIHtcbiAgICAgIGlmIChtYXJrZXIuZ2V0UmFuZ2UoKS5lbmQuaXNFcXVhbCh0aGlzLnN0YXJ0UG9pbnQpKSB7XG4gICAgICAgIHRoaXMubWFya2Vyc0JlZm9yZS5hZGQobWFya2VyKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBrZWVwQWZ0ZXIobWFya2Vycykge1xuICAgIGZvciAoY29uc3QgbWFya2VyIG9mIG1hcmtlcnMpIHtcbiAgICAgIGlmIChtYXJrZXIuZ2V0UmFuZ2UoKS5zdGFydC5pc0VxdWFsKHRoaXMuc3RhcnRQb2ludCkpIHtcbiAgICAgICAgdGhpcy5tYXJrZXJzQWZ0ZXIuYWRkKG1hcmtlcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgbWFya1doaWxlKGxheWVyTmFtZSwgYmxvY2ssIG1hcmtlck9wdHMpIHtcbiAgICBjb25zdCBzdGFydCA9IHRoaXMuaW5zZXJ0aW9uUG9pbnQuY29weSgpO1xuICAgIGJsb2NrKCk7XG4gICAgY29uc3QgZW5kID0gdGhpcy5pbnNlcnRpb25Qb2ludC5jb3B5KCk7XG4gICAgdGhpcy5tYXJrZXJCbHVlcHJpbnRzLnB1c2goe2xheWVyTmFtZSwgcmFuZ2U6IG5ldyBSYW5nZShzdGFydCwgZW5kKSwgbWFya2VyT3B0c30pO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgaW5zZXJ0KHRleHQpIHtcbiAgICBjb25zdCBpbnNlcnRlZFJhbmdlID0gdGhpcy5wYXRjaEJ1ZmZlci5nZXRCdWZmZXIoKS5pbnNlcnQodGhpcy5pbnNlcnRpb25Qb2ludCwgdGV4dCk7XG4gICAgdGhpcy5pbnNlcnRpb25Qb2ludCA9IGluc2VydGVkUmFuZ2UuZW5kO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgaW5zZXJ0TWFya2VkKHRleHQsIGxheWVyTmFtZSwgbWFya2VyT3B0cykge1xuICAgIHJldHVybiB0aGlzLm1hcmtXaGlsZShsYXllck5hbWUsICgpID0+IHRoaXMuaW5zZXJ0KHRleHQpLCBtYXJrZXJPcHRzKTtcbiAgfVxuXG4gIGluc2VydFBhdGNoQnVmZmVyKHN1YlBhdGNoQnVmZmVyLCBvcHRzKSB7XG4gICAgY29uc3QgYmFzZU9mZnNldCA9IHRoaXMuaW5zZXJ0aW9uUG9pbnQuY29weSgpO1xuICAgIHRoaXMuaW5zZXJ0KHN1YlBhdGNoQnVmZmVyLmdldEJ1ZmZlcigpLmdldFRleHQoKSk7XG5cbiAgICBjb25zdCBzdWJNYXJrZXJNYXAgPSBuZXcgTWFwKCk7XG4gICAgZm9yIChjb25zdCBsYXllck5hbWUgb2YgTEFZRVJfTkFNRVMpIHtcbiAgICAgIGZvciAoY29uc3Qgb2xkTWFya2VyIG9mIHN1YlBhdGNoQnVmZmVyLmZpbmRNYXJrZXJzKGxheWVyTmFtZSwge30pKSB7XG4gICAgICAgIGNvbnN0IHN0YXJ0T2Zmc2V0ID0gb2xkTWFya2VyLmdldFJhbmdlKCkuc3RhcnQucm93ID09PSAwID8gYmFzZU9mZnNldCA6IFtiYXNlT2Zmc2V0LnJvdywgMF07XG4gICAgICAgIGNvbnN0IGVuZE9mZnNldCA9IG9sZE1hcmtlci5nZXRSYW5nZSgpLmVuZC5yb3cgPT09IDAgPyBiYXNlT2Zmc2V0IDogW2Jhc2VPZmZzZXQucm93LCAwXTtcblxuICAgICAgICBjb25zdCByYW5nZSA9IG9sZE1hcmtlci5nZXRSYW5nZSgpLnRyYW5zbGF0ZShzdGFydE9mZnNldCwgZW5kT2Zmc2V0KTtcbiAgICAgICAgY29uc3QgbWFya2VyT3B0cyA9IHtcbiAgICAgICAgICAuLi5vbGRNYXJrZXIuZ2V0UHJvcGVydGllcygpLFxuICAgICAgICAgIGNhbGxiYWNrOiBuZXdNYXJrZXIgPT4geyBzdWJNYXJrZXJNYXAuc2V0KG9sZE1hcmtlciwgbmV3TWFya2VyKTsgfSxcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5tYXJrZXJCbHVlcHJpbnRzLnB1c2goe2xheWVyTmFtZSwgcmFuZ2UsIG1hcmtlck9wdHN9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLm1hcmtlck1hcENhbGxiYWNrcy5wdXNoKHttYXJrZXJNYXA6IHN1Yk1hcmtlck1hcCwgY2FsbGJhY2s6IG9wdHMuY2FsbGJhY2t9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgYXBwbHkoKSB7XG4gICAgZm9yIChjb25zdCB7bGF5ZXJOYW1lLCByYW5nZSwgbWFya2VyT3B0c30gb2YgdGhpcy5tYXJrZXJCbHVlcHJpbnRzKSB7XG4gICAgICBjb25zdCBjYWxsYmFjayA9IG1hcmtlck9wdHMuY2FsbGJhY2s7XG4gICAgICBkZWxldGUgbWFya2VyT3B0cy5jYWxsYmFjaztcblxuICAgICAgY29uc3QgbWFya2VyID0gdGhpcy5wYXRjaEJ1ZmZlci5tYXJrUmFuZ2UobGF5ZXJOYW1lLCByYW5nZSwgbWFya2VyT3B0cyk7XG4gICAgICBpZiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2sobWFya2VyKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IHttYXJrZXJNYXAsIGNhbGxiYWNrfSBvZiB0aGlzLm1hcmtlck1hcENhbGxiYWNrcykge1xuICAgICAgY2FsbGJhY2sobWFya2VyTWFwKTtcbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IGJlZm9yZU1hcmtlciBvZiB0aGlzLm1hcmtlcnNCZWZvcmUpIHtcbiAgICAgIGNvbnN0IGlzRW1wdHkgPSBiZWZvcmVNYXJrZXIuZ2V0UmFuZ2UoKS5pc0VtcHR5KCk7XG5cbiAgICAgIGlmICghYmVmb3JlTWFya2VyLmlzUmV2ZXJzZWQoKSkge1xuICAgICAgICBiZWZvcmVNYXJrZXIuc2V0SGVhZFBvc2l0aW9uKHRoaXMuc3RhcnRQb2ludCk7XG4gICAgICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICAgICAgYmVmb3JlTWFya2VyLnNldFRhaWxQb3NpdGlvbih0aGlzLnN0YXJ0UG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBiZWZvcmVNYXJrZXIuc2V0VGFpbFBvc2l0aW9uKHRoaXMuc3RhcnRQb2ludCk7XG4gICAgICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICAgICAgYmVmb3JlTWFya2VyLnNldEhlYWRQb3NpdGlvbih0aGlzLnN0YXJ0UG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBhZnRlck1hcmtlciBvZiB0aGlzLm1hcmtlcnNBZnRlcikge1xuICAgICAgY29uc3QgaXNFbXB0eSA9IGFmdGVyTWFya2VyLmdldFJhbmdlKCkuaXNFbXB0eSgpO1xuXG4gICAgICBpZiAoIWFmdGVyTWFya2VyLmlzUmV2ZXJzZWQoKSkge1xuICAgICAgICBhZnRlck1hcmtlci5zZXRUYWlsUG9zaXRpb24odGhpcy5pbnNlcnRpb25Qb2ludCk7XG4gICAgICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICAgICAgYWZ0ZXJNYXJrZXIuc2V0SGVhZFBvc2l0aW9uKHRoaXMuaW5zZXJ0aW9uUG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhZnRlck1hcmtlci5zZXRIZWFkUG9zaXRpb24odGhpcy5pbnNlcnRpb25Qb2ludCk7XG4gICAgICAgIGlmIChpc0VtcHR5KSB7XG4gICAgICAgICAgYWZ0ZXJNYXJrZXIuc2V0VGFpbFBvc2l0aW9uKHRoaXMuaW5zZXJ0aW9uUG9pbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLEtBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUQsT0FBQTtBQUE2QixTQUFBRSxRQUFBQyxDQUFBLEVBQUFDLENBQUEsUUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLElBQUEsQ0FBQUosQ0FBQSxPQUFBRyxNQUFBLENBQUFFLHFCQUFBLFFBQUFDLENBQUEsR0FBQUgsTUFBQSxDQUFBRSxxQkFBQSxDQUFBTCxDQUFBLEdBQUFDLENBQUEsS0FBQUssQ0FBQSxHQUFBQSxDQUFBLENBQUFDLE1BQUEsV0FBQU4sQ0FBQSxXQUFBRSxNQUFBLENBQUFLLHdCQUFBLENBQUFSLENB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