"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BarePrStatusesView = void 0;
var _react = _interopRequireDefault(require("react"));
var _reactRelay = require("react-relay");
var _propTypes = _interopRequireDefault(require("prop-types"));
var _eventKit = require("event-kit");
var _helpers = require("../helpers");
var _prStatusContextView = _interopRequireDefault(require("./pr-status-context-view"));
var _checkSuiteView = _interopRequireDefault(require("./check-suite-view"));
var _checkSuitesAccumulator = _interopRequireDefault(require("../containers/accumulators/check-suites-accumulator"));
var _buildStatus = require("../models/build-status");
var _octicon = _interopRequireDefault(require("../atom/octicon"));
var _statusDonutChart = _interopRequireDefault(require("./status-donut-chart"));
var _periodicRefresher = _interopRequireDefault(require("../periodic-refresher"));
var _propTypes2 = require("../prop-types");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class BarePrStatusesView extends _react.default.Component {
  constructor(props) {
    super(props);
    _defineProperty(this, "refresh", () => {
      this.props.relay.refetch({
        id: this.props.pullRequest.id
      }, null, () => this.emitter.emit('did-refetch'), {
        force: true
      });
    });
    _defineProperty(this, "renderWithChecks", result => {
      for (const err of result.errors) {
        // eslint-disable-next-line no-console
        console.error(err);
      }
      if (!this.getHeadCommit().status && result.suites.length === 0) {
        return null;
      }
      this.refresherOpts.interval = this.createIntervalCallback(result.suites);
      if (this.props.displayType === 'full') {
        return this.renderAsFull(result);
      } else {
        return this.renderAsCheck(result);
      }
    });
    _defineProperty(this, "onDidRefetch", cb => this.emitter.on('did-refetch', cb));
    this.emitter = new _eventKit.Emitter();
    this.refresherOpts = {
      interval: this.createIntervalCallback([]),
      getCurrentId: () => this.props.pullRequest.id,
      refresh: this.refresh,
      minimumIntervalPerId: this.constructor.MINIMUM_REFRESH_INTERVAL
    };
  }
  componentDidMount() {
    this.refresher = new _periodicRefresher.default(this.constructor, this.refresherOpts);
    this.refresher.start();
  }
  componentWillUnmount() {
    this.refresher.destroy();
  }
  render() {
    const headCommit = this.getHeadCommit();
    return _react.default.createElement(_checkSuitesAccumulator.default, {
      onDidRefetch: this.onDidRefetch,
      commit: headCommit
    }, this.renderWithChecks);
  }
  renderAsCheck({
    runsBySuite
  }) {
    const summaryStatus = this.getSummaryBuildStatus(runsBySuite);
    return _react.default.createElement(_octicon.default, {
      icon: summaryStatus.icon,
      className: `github-PrStatuses--${summaryStatus.classSuffix}`
    });
  }
  renderAsFull({
    suites,
    runsBySuite
  }) {
    const status = this.getHeadCommit().status;
    const contexts = status ? status.contexts : [];
    const summaryStatus = this.getSummaryBuildStatus(runsBySuite);
    const detailStatuses = this.getDetailBuildStatuses(runsBySuite);
    return _react.default.createElement("div", {
      className: "github-PrStatuses"
    }, _react.default.createElement("div", {
      className: "github-PrStatuses-header"
    }, _react.default.createElement("div", {
      className: "github-PrStatuses-donut-chart"
    }, this.renderDonutChart(detailStatuses)), _react.default.createElement("div", {
      className: "github-PrStatuses-summary"
    }, this.summarySentence(summaryStatus, detailStatuses))), _react.default.createElement("ul", {
      className: "github-PrStatuses-list"
    }, contexts.map(context => _react.default.createElement(_prStatusContextView.default, {
      key: context.id,
      context: context
    })), suites.map(suite => _react.default.createElement(_checkSuiteView.default, {
      key: suite.id,
      checkSuite: suite,
      checkRuns: runsBySuite.get(suite),
      switchToIssueish: this.props.switchToIssueish
    }))));
  }
  renderDonutChart(detailStatuses) {
    const counts = this.countsFromStatuses(detailStatuses);
    return _react.default.createElement(_statusDonutChart.default, counts);
  }
  summarySentence(summaryStatus, detailStatuses) {
    if (this.isAllSucceeded(summaryStatus)) {
      return 'All checks succeeded';
    } else if (this.isAllFailed(detailStatuses)) {
      return 'All checks failed';
    } else {
      const noun = detailStatuses.length === 1 ? 'check' : 'checks';
      const parts = [];
      const {
        pending,
        failure,
        success
      } = this.countsFromStatuses(detailStatuses);
      if (pending > 0) {
        parts.push(`${pending} pending`);
      }
      if (failure > 0) {
        parts.push(`${failure} failing`);
      }
      if (success > 0) {
        parts.push(`${success} successful`);
      }
      return (0, _helpers.toSentence)(parts) + ` ${noun}`;
    }
  }
  countsFromStatuses(statuses) {
    const counts = {
      pending: 0,
      failure: 0,
      success: 0,
      neutral: 0
    };
    for (const buildStatus of statuses) {
      const count = counts[buildStatus.classSuffix];
      /* istanbul ignore else */
      if (count !== undefined) {
        counts[buildStatus.classSuffix] = count + 1;
      }
    }
    return counts;
  }
  getHeadCommit() {
    return this.props.pullRequest.recentCommits.edges[0].node.commit;
  }
  getSummaryBuildStatus(runsBySuite) {
    const contextStatus = (0, _buildStatus.buildStatusFromStatusContext)(this.getHeadCommit().status || {});
    const checkRunStatuses = [];
    for (const [, runs] of runsBySuite) {
      for (const checkRun of runs) {
        checkRunStatuses.push((0, _buildStatus.buildStatusFromCheckResult)(checkRun));
      }
    }
    return (0, _buildStatus.combineBuildStatuses)(contextStatus, ...checkRunStatuses);
  }
  getDetailBuildStatuses(runsBySuite) {
    const headCommit = this.getHeadCommit();
    const statuses = [];
    if (headCommit.status) {
      for (const context of headCommit.status.contexts) {
        statuses.push((0, _buildStatus.buildStatusFromStatusContext)(context));
      }
    }
    for (const [, checkRuns] of runsBySuite) {
      for (const checkRun of checkRuns) {
        statuses.push((0, _buildStatus.buildStatusFromCheckResult)(checkRun));
      }
    }
    return statuses;
  }
  createIntervalCallback(suites) {
    return () => {
      const statuses = [(0, _buildStatus.buildStatusFromStatusContext)(this.getHeadCommit().status || {}), ...suites.map(_buildStatus.buildStatusFromCheckResult)];
      if (statuses.some(status => status.classSuffix === 'pending')) {
        return this.constructor.PENDING_REFRESH_TIMEOUT;
      } else {
        return this.constructor.COMPLETED_REFRESH_TIMEOUT;
      }
    };
  }
  isAllSucceeded(buildStatuses) {
    return buildStatuses.classSuffix === 'success';
  }
  isAllFailed(detailStatuses) {
    return detailStatuses.every(s => s.classSuffix === 'failure');
  }
}
exports.BarePrStatusesView = BarePrStatusesView;
_defineProperty(BarePrStatusesView, "propTypes", {
  // Relay
  relay: _propTypes.default.shape({
    refetch: _propTypes.default.func.isRequired
  }).isRequired,
  pullRequest: _propTypes.default.shape({
    id: _propTypes.default.string.isRequired,
    recentCommits: (0, _propTypes2.RelayConnectionPropType)(_propTypes.default.shape({
      commit: _propTypes.default.shape({
        status: _propTypes.default.shape({
          state: _propTypes.default.string.isRequired,
          contexts: _propTypes.default.arrayOf(_propTypes.default.shape({
            id: _propTypes.default.string.isRequired
          }).isRequired).isRequired
        })
      }).isRequired
    }).isRequired).isRequired
  }).isRequired,
  // Control
  displayType: _propTypes.default.oneOf(['check', 'full']),
  // Action
  switchToIssueish: _propTypes.default.func.isRequired
});
_defineProperty(BarePrStatusesView, "defaultProps", {
  displayType: 'full'
});
_defineProperty(BarePrStatusesView, "lastRefreshPerPr", new Map());
_defineProperty(BarePrStatusesView, "COMPLETED_REFRESH_TIMEOUT", 3 * 60 * 1000);
_defineProperty(BarePrStatusesView, "PENDING_REFRESH_TIMEOUT", 30 * 1000);
_defineProperty(BarePrStatusesView, "MINIMUM_REFRESH_INTERVAL", 15 * 1000);
var _default = (0, _reactRelay.createRefetchContainer)(BarePrStatusesView, {
  pullRequest: function () {
    const node = require("./__generated__/prStatusesView_pullRequest.graphql");
    if (node.hash && node.hash !== "e21e2ef5e505a4a8e895bf13cb4202ab") {
      console.error("The definition of 'prStatusesView_pullRequest' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prStatusesView_pullRequest.graphql");
  }
}, function () {
  const node = require("./__generated__/prStatusesViewRefetchQuery.graphql");
  if (node.hash && node.hash !== "34c4cfc61df6413f34a5efa61768cd48") {
    console.error("The definition of 'prStatusesViewRefetchQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
  }
  return require("./__generated__/prStatusesViewRefetchQuery.graphql");
});
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJCYXJlUHJTdGF0dXNlc1ZpZXciLCJSZWFjdCIsIkNvbXBvbmVudCIsImNvbnN0cnVjdG9yIiwicHJvcHMiLCJyZWxheSIsInJlZmV0Y2giLCJpZCIsInB1bGxSZXF1ZXN0IiwiZW1pdHRlciIsImVtaXQiLCJmb3JjZSIsInJlc3VsdCIsImVyciIsImVycm9ycyIsImNvbnNvbGUiLCJlcnJvciIsImdldEhlYWRDb21taXQiLCJzdGF0dXMiLCJzdWl0ZXMiLCJsZW5ndGgiLCJyZWZyZXNoZXJPcHRzIiwiaW50ZXJ2YWwiLCJjcmVhdGVJbnRlcnZhbENhbGxiYWNrIiwiZGlzcGxheVR5cGUiLCJyZW5kZXJBc0Z1bGwiLCJyZW5kZXJBc0NoZWNrIiwiY2IiLCJvbiIsIkVtaXR0ZXIiLCJnZXRDdXJyZW50SWQiLCJyZWZyZXNoIiwibWluaW11bUludGVydmFsUGVySWQiLCJNSU5JTVVNX1JFRlJFU0hfSU5URVJWQUwiLCJjb21wb25lbnREaWRNb3VudCIsInJlZnJlc2hlciIsIlBlcmlvZGljUmVmcmVzaGVyIiwic3RhcnQiLCJjb21wb25lbnRXaWxsVW5tb3VudCIsImRlc3Ryb3kiLCJyZW5kZXIiLCJoZWFkQ29tbWl0Iiwib25EaWRSZWZldGNoIiwicmVuZGVyV2l0aENoZWNrcyIsInJ1bnNCeVN1aXRlIiwic3VtbWFyeVN0YXR1cyIsImdldFN1bW1hcnlCdWlsZFN0YXR1cyIsImljb24iLCJjbGFzc1N1ZmZpeCIsImNvbnRleHRzIiwiZGV0YWlsU3RhdHVzZXMiLCJnZXREZXRhaWxCdWlsZFN0YXR1c2VzIiwicmVuZGVyRG9udXRDaGFydCIsInN1bW1hcnlTZW50ZW5jZSIsIm1hcCIsImNvbnRleHQiLCJzdWl0ZSIsImdldCIsInN3aXRjaFRvSXNzdWVpc2giLCJjb3VudHMiLCJjb3VudHNGcm9tU3RhdHVzZXMiLCJpc0FsbFN1Y2NlZWRlZCIsImlzQWxsRmFpbGVkIiwibm91biIsInBhcnRzIiwicGVuZGluZyIsImZhaWx1cmUiLCJzdWNjZXNzIiwicHVzaCIsInRvU2VudGVuY2UiLCJzdGF0dXNlcyIsIm5ldXRyYWwiLCJidWlsZFN0YXR1cyIsImNvdW50IiwidW5kZWZpbmVkIiwicmVjZW50Q29tbWl0cyIsImVkZ2VzIiwibm9kZSIsImNvbW1pdCIsImNvbnRleHRTdGF0dXMiLCJidWlsZFN0YXR1c0Zyb21TdGF0dXNDb250ZXh0IiwiY2hlY2tSdW5TdGF0dXNlcyIsInJ1bnMiLCJjaGVja1J1biIsImJ1aWxkU3RhdHVzRnJvbUNoZWNrUmVzdWx0IiwiY29tYmluZUJ1aWxkU3RhdHVzZXMiLCJjaGVja1J1bnMiLCJzb21lIiwiUEVORElOR19SRUZSRVNIX1RJTUVPVVQiLCJDT01QTEVURURfUkVGUkVTSF9USU1FT1VUIiwiYnVpbGRTdGF0dXNlcyIsImV2ZXJ5IiwicyIsIlByb3BUeXBlcyIsInNoYXBlIiwiZnVuYyIsImlzUmVxdWlyZWQiLCJzdHJpbmciLCJSZWxheUNvbm5lY3Rpb25Qcm9wVHlwZSIsInN0YXRlIiwiYXJyYXlPZiIsIm9uZU9mIiwiTWFwIiwiY3JlYXRlUmVmZXRjaENvbnRhaW5lciJdLCJzb3VyY2VzIjpbInByLXN0YXR1c2VzLXZpZXcuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7Y3JlYXRlUmVmZXRjaENvbnRhaW5lciwgZ3JhcGhxbH0gZnJvbSAncmVhY3QtcmVsYXknO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7RW1pdHRlcn0gZnJvbSAnZXZlbnQta2l0JztcblxuaW1wb3J0IHt0b1NlbnRlbmNlfSBmcm9tICcuLi9oZWxwZXJzJztcbmltcG9ydCBQdWxsUmVxdWVzdFN0YXR1c0NvbnRleHRWaWV3IGZyb20gJy4vcHItc3RhdHVzLWNvbnRleHQtdmlldyc7XG5pbXBvcnQgQ2hlY2tTdWl0ZVZpZXcgZnJvbSAnLi9jaGVjay1zdWl0ZS12aWV3JztcbmltcG9ydCBDaGVja1N1aXRlc0FjY3VtdWxhdG9yIGZyb20gJy4uL2NvbnRhaW5lcnMvYWNjdW11bGF0b3JzL2NoZWNrLXN1aXRlcy1hY2N1bXVsYXRvcic7XG5pbXBvcnQge1xuICBidWlsZFN0YXR1c0Zyb21TdGF0dXNDb250ZXh0LFxuICBidWlsZFN0YXR1c0Zyb21DaGVja1Jlc3VsdCxcbiAgY29tYmluZUJ1aWxkU3RhdHVzZXMsXG59IGZyb20gJy4uL21vZGVscy9idWlsZC1zdGF0dXMnO1xuaW1wb3J0IE9jdGljb24gZnJvbSAnLi4vYXRvbS9vY3RpY29uJztcbmltcG9ydCBTdGF0dXNEb251dENoYXJ0IGZyb20gJy4vc3RhdHVzLWRvbnV0LWNoYXJ0JztcbmltcG9ydCBQZXJpb2RpY1JlZnJlc2hlciBmcm9tICcuLi9wZXJpb2RpYy1yZWZyZXNoZXInO1xuaW1wb3J0IHtSZWxheUNvbm5lY3Rpb25Qcm9wVHlwZX0gZnJvbSAnLi4vcHJvcC10eXBlcyc7XG5cbmV4cG9ydCBjbGFzcyBCYXJlUHJTdGF0dXNlc1ZpZXcgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIC8vIFJlbGF5XG4gICAgcmVsYXk6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICByZWZldGNoOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIH0pLmlzUmVxdWlyZWQsXG4gICAgcHVsbFJlcXVlc3Q6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBpZDogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgcmVjZW50Q29tbWl0czogUmVsYXlDb25uZWN0aW9uUHJvcFR5cGUoXG4gICAgICAgIFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgICAgY29tbWl0OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICAgICAgc3RhdHVzOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICAgICAgICBzdGF0ZTogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgICAgICAgICBjb250ZXh0czogUHJvcFR5cGVzLmFycmF5T2YoXG4gICAgICAgICAgICAgICAgUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgICAgICAgICAgIGlkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgfSkuaXNSZXF1aXJlZCxcbiAgICAgICAgICAgICAgKS5pc1JlcXVpcmVkLFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgfSkuaXNSZXF1aXJlZCxcbiAgICAgICAgfSkuaXNSZXF1aXJlZCxcbiAgICAgICkuaXNSZXF1aXJlZCxcbiAgICB9KS5pc1JlcXVpcmVkLFxuXG4gICAgLy8gQ29udHJvbFxuICAgIGRpc3BsYXlUeXBlOiBQcm9wVHlwZXMub25lT2YoW1xuICAgICAgJ2NoZWNrJywgJ2Z1bGwnLFxuICAgIF0pLFxuXG4gICAgLy8gQWN0aW9uXG4gICAgc3dpdGNoVG9Jc3N1ZWlzaDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgfVxuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgZGlzcGxheVR5cGU6ICdmdWxsJyxcbiAgfVxuXG4gIHN0YXRpYyBsYXN0UmVmcmVzaFBlclByID0gbmV3IE1hcCgpXG5cbiAgc3RhdGljIENPTVBMRVRFRF9SRUZSRVNIX1RJTUVPVVQgPSAzICogNjAgKiAxMDAwXG4gIHN0YXRpYyBQRU5ESU5HX1JFRlJFU0hfVElNRU9VVCA9IDMwICogMTAwMFxuICBzdGF0aWMgTUlOSU1VTV9SRUZSRVNIX0lOVEVSVkFMID0gMTUgKiAxMDAwXG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLmVtaXR0ZXIgPSBuZXcgRW1pdHRlcigpO1xuXG4gICAgdGhpcy5yZWZyZXNoZXJPcHRzID0ge1xuICAgICAgaW50ZXJ2YWw6IHRoaXMuY3JlYXRlSW50ZXJ2YWxDYWxsYmFjayhbXSksXG4gICAgICBnZXRDdXJyZW50SWQ6ICgpID0+IHRoaXMucHJvcHMucHVsbFJlcXVlc3QuaWQsXG4gICAgICByZWZyZXNoOiB0aGlzLnJlZnJlc2gsXG4gICAgICBtaW5pbXVtSW50ZXJ2YWxQZXJJZDogdGhpcy5jb25zdHJ1Y3Rvci5NSU5JTVVNX1JFRlJFU0hfSU5URVJWQUwsXG4gICAgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucmVmcmVzaGVyID0gbmV3IFBlcmlvZGljUmVmcmVzaGVyKHRoaXMuY29uc3RydWN0b3IsIHRoaXMucmVmcmVzaGVyT3B0cyk7XG4gICAgdGhpcy5yZWZyZXNoZXIuc3RhcnQoKTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMucmVmcmVzaGVyLmRlc3Ryb3koKTtcbiAgfVxuXG4gIHJlZnJlc2ggPSAoKSA9PiB7XG4gICAgdGhpcy5wcm9wcy5yZWxheS5yZWZldGNoKHtcbiAgICAgIGlkOiB0aGlzLnByb3BzLnB1bGxSZXF1ZXN0LmlkLFxuICAgIH0sIG51bGwsICgpID0+IHRoaXMuZW1pdHRlci5lbWl0KCdkaWQtcmVmZXRjaCcpLCB7Zm9yY2U6IHRydWV9KTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCBoZWFkQ29tbWl0ID0gdGhpcy5nZXRIZWFkQ29tbWl0KCk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxDaGVja1N1aXRlc0FjY3VtdWxhdG9yIG9uRGlkUmVmZXRjaD17dGhpcy5vbkRpZFJlZmV0Y2h9IGNvbW1pdD17aGVhZENvbW1pdH0+XG4gICAgICAgIHt0aGlzLnJlbmRlcldpdGhDaGVja3N9XG4gICAgICA8L0NoZWNrU3VpdGVzQWNjdW11bGF0b3I+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlcldpdGhDaGVja3MgPSByZXN1bHQgPT4ge1xuICAgIGZvciAoY29uc3QgZXJyIG9mIHJlc3VsdC5lcnJvcnMpIHtcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLmdldEhlYWRDb21taXQoKS5zdGF0dXMgJiYgcmVzdWx0LnN1aXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHRoaXMucmVmcmVzaGVyT3B0cy5pbnRlcnZhbCA9IHRoaXMuY3JlYXRlSW50ZXJ2YWxDYWxsYmFjayhyZXN1bHQuc3VpdGVzKTtcblxuICAgIGlmICh0aGlzLnByb3BzLmRpc3BsYXlUeXBlID09PSAnZnVsbCcpIHtcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlckFzRnVsbChyZXN1bHQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5yZW5kZXJBc0NoZWNrKHJlc3VsdCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyQXNDaGVjayh7cnVuc0J5U3VpdGV9KSB7XG4gICAgY29uc3Qgc3VtbWFyeVN0YXR1cyA9IHRoaXMuZ2V0U3VtbWFyeUJ1aWxkU3RhdHVzKHJ1bnNCeVN1aXRlKTtcbiAgICByZXR1cm4gPE9jdGljb24gaWNvbj17c3VtbWFyeVN0YXR1cy5pY29ufSBjbGFzc05hbWU9e2BnaXRodWItUHJTdGF0dXNlcy0tJHtzdW1tYXJ5U3RhdHVzLmNsYXNzU3VmZml4fWB9IC8+O1xuICB9XG5cbiAgcmVuZGVyQXNGdWxsKHtzdWl0ZXMsIHJ1bnNCeVN1aXRlfSkge1xuICAgIGNvbnN0IHN0YXR1cyA9IHRoaXMuZ2V0SGVhZENvbW1pdCgpLnN0YXR1cztcbiAgICBjb25zdCBjb250ZXh0cyA9IHN0YXR1cyA/IHN0YXR1cy5jb250ZXh0cyA6IFtdO1xuXG4gICAgY29uc3Qgc3VtbWFyeVN0YXR1cyA9IHRoaXMuZ2V0U3VtbWFyeUJ1aWxkU3RhdHVzKHJ1bnNCeVN1aXRlKTtcbiAgICBjb25zdCBkZXRhaWxTdGF0dXNlcyA9IHRoaXMuZ2V0RGV0YWlsQnVpbGRTdGF0dXNlcyhydW5zQnlTdWl0ZSk7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJnaXRodWItUHJTdGF0dXNlc1wiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImdpdGh1Yi1QclN0YXR1c2VzLWhlYWRlclwiPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2l0aHViLVByU3RhdHVzZXMtZG9udXQtY2hhcnRcIj5cbiAgICAgICAgICAgIHt0aGlzLnJlbmRlckRvbnV0Q2hhcnQoZGV0YWlsU3RhdHVzZXMpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2l0aHViLVByU3RhdHVzZXMtc3VtbWFyeVwiPlxuICAgICAgICAgICAge3RoaXMuc3VtbWFyeVNlbnRlbmNlKHN1bW1hcnlTdGF0dXMsIGRldGFpbFN0YXR1c2VzKX1cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDx1bCBjbGFzc05hbWU9XCJnaXRodWItUHJTdGF0dXNlcy1saXN0XCI+XG4gICAgICAgICAge2NvbnRleHRzLm1hcChjb250ZXh0ID0+IDxQdWxsUmVxdWVzdFN0YXR1c0NvbnRleHRWaWV3IGtleT17Y29udGV4dC5pZH0gY29udGV4dD17Y29udGV4dH0gLz4pfVxuICAgICAgICAgIHtzdWl0ZXMubWFwKHN1aXRlID0+IChcbiAgICAgICAgICAgIDxDaGVja1N1aXRlVmlld1xuICAgICAgICAgICAgICBrZXk9e3N1aXRlLmlkfVxuICAgICAgICAgICAgICBjaGVja1N1aXRlPXtzdWl0ZX1cbiAgICAgICAgICAgICAgY2hlY2tSdW5zPXtydW5zQnlTdWl0ZS5nZXQoc3VpdGUpfVxuICAgICAgICAgICAgICBzd2l0Y2hUb0lzc3VlaXNoPXt0aGlzLnByb3BzLnN3aXRjaFRvSXNzdWVpc2h9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICkpfVxuICAgICAgICA8L3VsPlxuICAgICAgPC9kaXY+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckRvbnV0Q2hhcnQoZGV0YWlsU3RhdHVzZXMpIHtcbiAgICBjb25zdCBjb3VudHMgPSB0aGlzLmNvdW50c0Zyb21TdGF0dXNlcyhkZXRhaWxTdGF0dXNlcyk7XG4gICAgcmV0dXJuIDxTdGF0dXNEb251dENoYXJ0IHsuLi5jb3VudHN9IC8+O1xuICB9XG5cbiAgc3VtbWFyeVNlbnRlbmNlKHN1bW1hcnlTdGF0dXMsIGRldGFpbFN0YXR1c2VzKSB7XG4gICAgaWYgKHRoaXMuaXNBbGxTdWNjZWVkZWQoc3VtbWFyeVN0YXR1cykpIHtcbiAgICAgIHJldHVybiAnQWxsIGNoZWNrcyBzdWNjZWVkZWQnO1xuICAgIH0gZWxzZSBpZiAodGhpcy5pc0FsbEZhaWxlZChkZXRhaWxTdGF0dXNlcykpIHtcbiAgICAgIHJldHVybiAnQWxsIGNoZWNrcyBmYWlsZWQnO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBub3VuID0gZGV0YWlsU3RhdHVzZXMubGVuZ3RoID09PSAxID8gJ2NoZWNrJyA6ICdjaGVja3MnO1xuICAgICAgY29uc3QgcGFydHMgPSBbXTtcbiAgICAgIGNvbnN0IHtwZW5kaW5nLCBmYWlsdXJlLCBzdWNjZXNzfSA9IHRoaXMuY291bnRzRnJvbVN0YXR1c2VzKGRldGFpbFN0YXR1c2VzKTtcblxuICAgICAgaWYgKHBlbmRpbmcgPiAwKSB7XG4gICAgICAgIHBhcnRzLnB1c2goYCR7cGVuZGluZ30gcGVuZGluZ2ApO1xuICAgICAgfVxuICAgICAgaWYgKGZhaWx1cmUgPiAwKSB7XG4gICAgICAgIHBhcnRzLnB1c2goYCR7ZmFpbHVyZX0gZmFpbGluZ2ApO1xuICAgICAgfVxuICAgICAgaWYgKHN1Y2Nlc3MgPiAwKSB7XG4gICAgICAgIHBhcnRzLnB1c2goYCR7c3VjY2Vzc30gc3VjY2Vzc2Z1bGApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRvU2VudGVuY2UocGFydHMpICsgYCAke25vdW59YDtcbiAgICB9XG4gIH1cblxuICBjb3VudHNGcm9tU3RhdHVzZXMoc3RhdHVzZXMpIHtcbiAgICBjb25zdCBjb3VudHMgPSB7XG4gICAgICBwZW5kaW5nOiAwLFxuICAgICAgZmFpbHVyZTogMCxcbiAgICAgIHN1Y2Nlc3M6IDAsXG4gICAgICBuZXV0cmFsOiAwLFxuICAgIH07XG5cbiAgICBmb3IgKGNvbnN0IGJ1aWxkU3RhdHVzIG9mIHN0YXR1c2VzKSB7XG4gICAgICBjb25zdCBjb3VudCA9IGNvdW50c1tidWlsZFN0YXR1cy5jbGFzc1N1ZmZpeF07XG4gICAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgZWxzZSAqL1xuICAgICAgaWYgKGNvdW50ICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY291bnRzW2J1aWxkU3RhdHVzLmNsYXNzU3VmZml4XSA9IGNvdW50ICsgMTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGNvdW50cztcbiAgfVxuXG4gIGdldEhlYWRDb21taXQoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucHVsbFJlcXVlc3QucmVjZW50Q29tbWl0cy5lZGdlc1swXS5ub2RlLmNvbW1pdDtcbiAgfVxuXG4gIGdldFN1bW1hcnlCdWlsZFN0YXR1cyhydW5zQnlTdWl0ZSkge1xuICAgIGNvbnN0IGNvbnRleHRTdGF0dXMgPSBidWlsZFN0YXR1c0Zyb21TdGF0dXNDb250ZXh0KHRoaXMuZ2V0SGVhZENvbW1pdCgpLnN0YXR1cyB8fCB7fSk7XG4gICAgY29uc3QgY2hlY2tSdW5TdGF0dXNlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgWywgcnVuc10gb2YgcnVuc0J5U3VpdGUpIHtcbiAgICAgIGZvciAoY29uc3QgY2hlY2tSdW4gb2YgcnVucykge1xuICAgICAgICBjaGVja1J1blN0YXR1c2VzLnB1c2goYnVpbGRTdGF0dXNGcm9tQ2hlY2tSZXN1bHQoY2hlY2tSdW4pKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gY29tYmluZUJ1aWxkU3RhdHVzZXMoY29udGV4dFN0YXR1cywgLi4uY2hlY2tSdW5TdGF0dXNlcyk7XG4gIH1cblxuICBnZXREZXRhaWxCdWlsZFN0YXR1c2VzKHJ1bnNCeVN1aXRlKSB7XG4gICAgY29uc3QgaGVhZENvbW1pdCA9IHRoaXMuZ2V0SGVhZENvbW1pdCgpO1xuXG4gICAgY29uc3Qgc3RhdHVzZXMgPSBbXTtcblxuICAgIGlmIChoZWFkQ29tbWl0LnN0YXR1cykge1xuICAgICAgZm9yIChjb25zdCBjb250ZXh0IG9mIGhlYWRDb21taXQuc3RhdHVzLmNvbnRleHRzKSB7XG4gICAgICAgIHN0YXR1c2VzLnB1c2goYnVpbGRTdGF0dXNGcm9tU3RhdHVzQ29udGV4dChjb250ZXh0KSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZm9yIChjb25zdCBbLCBjaGVja1J1bnNdIG9mIHJ1bnNCeVN1aXRlKSB7XG4gICAgICBmb3IgKGNvbnN0IGNoZWNrUnVuIG9mIGNoZWNrUnVucykge1xuICAgICAgICBzdGF0dXNlcy5wdXNoKGJ1aWxkU3RhdHVzRnJvbUNoZWNrUmVzdWx0KGNoZWNrUnVuKSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHN0YXR1c2VzO1xuICB9XG5cbiAgY3JlYXRlSW50ZXJ2YWxDYWxsYmFjayhzdWl0ZXMpIHtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY29uc3Qgc3RhdHVzZXMgPSBbXG4gICAgICAgIGJ1aWxkU3RhdHVzRnJvbVN0YXR1c0NvbnRleHQodGhpcy5nZXRIZWFkQ29tbWl0KCkuc3RhdHVzIHx8IHt9KSxcbiAgICAgICAgLi4uc3VpdGVzLm1hcChidWlsZFN0YXR1c0Zyb21DaGVja1Jlc3VsdCksXG4gICAgICBdO1xuXG4gICAgICBpZiAoc3RhdHVzZXMuc29tZShzdGF0dXMgPT4gc3RhdHVzLmNsYXNzU3VmZml4ID09PSAncGVuZGluZycpKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmNvbnN0cnVjdG9yLlBFTkRJTkdfUkVGUkVTSF9USU1FT1VUO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IuQ09NUExFVEVEX1JFRlJFU0hfVElNRU9VVDtcbiAgICAgIH1cbiAgICB9O1xuICB9XG5cbiAgaXNBbGxTdWNjZWVkZWQoYnVpbGRTdGF0dXNlcykge1xuICAgIHJldHVybiBidWlsZFN0YXR1c2VzLmNsYXNzU3VmZml4ID09PSAnc3VjY2Vzcyc7XG4gIH1cblxuICBpc0FsbEZhaWxlZChkZXRhaWxTdGF0dXNlcykge1xuICAgIHJldHVybiBkZXRhaWxTdGF0dXNlcy5ldmVyeShzID0+IHMuY2xhc3NTdWZmaXggPT09ICdmYWlsdXJlJyk7XG4gIH1cblxuICBvbkRpZFJlZmV0Y2ggPSBjYiA9PiB0aGlzLmVtaXR0ZXIub24oJ2RpZC1yZWZldGNoJywgY2IpXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZVJlZmV0Y2hDb250YWluZXIoQmFyZVByU3RhdHVzZXNWaWV3LCB7XG4gIHB1bGxSZXF1ZXN0OiBncmFwaHFsYFxuICAgIGZyYWdtZW50IHByU3RhdHVzZXNWaWV3X3B1bGxSZXF1ZXN0IG9uIFB1bGxSZXF1ZXN0XG4gICAgQGFyZ3VtZW50RGVmaW5pdGlvbnMoXG4gICAgICBjaGVja1N1aXRlQ291bnQ6IHt0eXBlOiBcIkludCFcIn1cbiAgICAgIGNoZWNrU3VpdGVDdXJzb3I6IHt0eXBlOiBcIlN0cmluZ1wifVxuICAgICAgY2hlY2tSdW5Db3VudDoge3R5cGU6IFwiSW50IVwifVxuICAgICAgY2hlY2tSdW5DdXJzb3I6IHt0eXBlOiBcIlN0cmluZ1wifVxuICAgICkge1xuICAgICAgaWRcbiAgICAgIHJlY2VudENvbW1pdHM6IGNvbW1pdHMobGFzdDoxKSB7XG4gICAgICAgIGVkZ2VzIHtcbiAgICAgICAgICBub2RlIHtcbiAgICAgICAgICAgIGNvbW1pdCB7XG4gICAgICAgICAgICAgIHN0YXR1cyB7XG4gICAgICAgICAgICAgICAgc3RhdGVcbiAgICAgICAgICAgICAgICBjb250ZXh0cyB7XG4gICAgICAgICAgICAgICAgICBpZFxuICAgICAgICAgICAgICAgICAgc3RhdGVcbiAgICAgICAgICAgICAgICAgIC4uLnByU3RhdHVzQ29udGV4dFZpZXdfY29udGV4dFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIC4uLmNoZWNrU3VpdGVzQWNjdW11bGF0b3JfY29tbWl0IEBhcmd1bWVudHMoXG4gICAgICAgICAgICAgICAgY2hlY2tTdWl0ZUNvdW50OiAkY2hlY2tTdWl0ZUNvdW50XG4gICAgICAgICAgICAgICAgY2hlY2tTdWl0ZUN1cnNvcjogJGNoZWNrU3VpdGVDdXJzb3JcbiAgICAgICAgICAgICAgICBjaGVja1J1bkNvdW50OiAkY2hlY2tSdW5Db3VudFxuICAgICAgICAgICAgICAgIGNoZWNrUnVuQ3Vyc29yOiAkY2hlY2tSdW5DdXJzb3JcbiAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgYCxcbn0sIGdyYXBocWxgXG4gIHF1ZXJ5IHByU3RhdHVzZXNWaWV3UmVmZXRjaFF1ZXJ5KFxuICAgICRpZDogSUQhXG4gICAgJGNoZWNrU3VpdGVDb3VudDogSW50IVxuICAgICRjaGVja1N1aXRlQ3Vyc29yOiBTdHJpbmdcbiAgICAkY2hlY2tSdW5Db3VudDogSW50IVxuICAgICRjaGVja1J1bkN1cnNvcjogU3RyaW5nXG4gICkge1xuICAgIG5vZGUoaWQ6ICRpZCkge1xuICAgICAgLi4uIG9uIFB1bGxSZXF1ZXN0IHtcbiAgICAgICAgLi4ucHJTdGF0dXNlc1ZpZXdfcHVsbFJlcXVlc3QgQGFyZ3VtZW50cyhcbiAgICAgICAgICBjaGVja1N1aXRlQ291bnQ6ICRjaGVja1N1aXRlQ291bnRcbiAgICAgICAgICBjaGVja1N1aXRlQ3Vyc29yOiAkY2hlY2tTdWl0ZUN1cnNvclxuICAgICAgICAgIGNoZWNrUnVuQ291bnQ6ICRjaGVja1J1bkNvdW50XG4gICAgICAgICAgY2hlY2tSdW5DdXJzb3I6ICRjaGVja1J1bkN1cnNvclxuICAgICAgICApXG4gICAgICB9XG4gICAgfVxuICB9XG5gKTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFBc0Q7QUFBQTtBQUFBO0FBQUE7QUFFL0MsTUFBTUEsa0JBQWtCLFNB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