"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BarePrStatusesView = void 0;
var _react = _interopRequireDefault(require("react"));
var _reactRelay = require("react-relay");
var _propTypes = _interopRequireDefault(require("prop-types"));
var _eventKit = require("event-kit");
var _helpers = require("../helpers");
var _prStatusContextView = _interopRequireDefault(require("./pr-status-context-view"));
var _checkSuiteView = _interopRequireDefault(require("./check-suite-view"));
var _checkSuitesAccumulator = _interopRequireDefault(require("../containers/accumulators/check-suites-accumulator"));
var _buildStatus = require("../models/build-status");
var _octicon = _interopRequireDefault(require("../atom/octicon"));
var _statusDonutChart = _interopRequireDefault(require("./status-donut-chart"));
var _periodicRefresher = _interopRequireDefault(require("../periodic-refresher"));
var _propTypes2 = require("../prop-types");
function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(arg) { var key = _toPrimitive(arg, "string"); return typeof key === "symbol" ? key : String(key); }
function _toPrimitive(input, hint) { if (typeof input !== "object" || input === null) return input; var prim = input[Symbol.toPrimitive]; if (prim !== undefined) { var res = prim.call(input, hint || "default"); if (typeof res !== "object") return res; throw new TypeError("@@toPrimitive must return a primitive value."); } return (hint === "string" ? String : Number)(input); }
class BarePrStatusesView extends _react.default.Component {
  constructor(props) {
    super(props);
    _defineProperty(this, "refresh", () => {
      this.props.relay.refetch({
        id: this.props.pullRequest.id
      }, null, () => this.emitter.emit('did-refetch'), {
        force: true
      });
    });
    _defineProperty(this, "renderWithChecks", result => {
      for (const err of result.errors) {
        // eslint-disable-next-line no-console
        console.error(err);
      }
      if (!this.getHeadCommit().status && result.suites.length === 0) {
        return null;
      }
      this.refresherOpts.interval = this.createIntervalCallback(result.suites);
      if (this.props.displayType === 'full') {
        return this.renderAsFull(result);
      } else {
        return this.renderAsCheck(result);
      }
    });
    _defineProperty(this, "onDidRefetch", cb => this.emitter.on('did-refetch', cb));
    this.emitter = new _eventKit.Emitter();
    this.refresherOpts = {
      interval: this.createIntervalCallback([]),
      getCurrentId: () => this.props.pullRequest.id,
      refresh: this.refresh,
      minimumIntervalPerId: this.constructor.MINIMUM_REFRESH_INTERVAL
    };
  }
  componentDidMount() {
    this.refresher = new _periodicRefresher.default(this.constructor, this.refresherOpts);
    this.refresher.start();
  }
  componentWillUnmount() {
    this.refresher.destroy();
  }
  render() {
    const headCommit = this.getHeadCommit();
    return _react.default.createElement(_checkSuitesAccumulator.default, {
      onDidRefetch: this.onDidRefetch,
      commit: headCommit
    }, this.renderWithChecks);
  }
  renderAsCheck({
    runsBySuite
  }) {
    const summaryStatus = this.getSummaryBuildStatus(runsBySuite);
    return _react.default.createElement(_octicon.default, {
      icon: summaryStatus.icon,
      className: `github-PrStatuses--${summaryStatus.classSuffix}`
    });
  }
  renderAsFull({
    suites,
    runsBySuite
  }) {
    const status = this.getHeadCommit().status;
    const contexts = status ? status.contexts : [];
    const summaryStatus = this.getSummaryBuildStatus(runsBySuite);
    const detailStatuses = this.getDetailBuildStatuses(runsBySuite);
    return _react.default.createElement("div", {
      className: "github-PrStatuses"
    }, _react.default.createElement("div", {
      className: "github-PrStatuses-header"
    }, _react.default.createElement("div", {
      className: "github-PrStatuses-donut-chart"
    }, this.renderDonutChart(detailStatuses)), _react.default.createElement("div", {
      className: "github-PrStatuses-summary"
    }, this.summarySentence(summaryStatus, detailStatuses))), _react.default.createElement("ul", {
      className: "github-PrStatuses-list"
    }, contexts.map(context => _react.default.createElement(_prStatusContextView.default, {
      key: context.id,
      context: context
    })), suites.map(suite => _react.default.createElement(_checkSuiteView.default, {
      key: suite.id,
      checkSuite: suite,
      checkRuns: runsBySuite.get(suite),
      switchToIssueish: this.props.switchToIssueish
    }))));
  }
  renderDonutChart(detailStatuses) {
    const counts = this.countsFromStatuses(detailStatuses);
    return _react.default.createElement(_statusDonutChart.default, counts);
  }
  summarySentence(summaryStatus, detailStatuses) {
    if (this.isAllSucceeded(summaryStatus)) {
      return 'All checks succeeded';
    } else if (this.isAllFailed(detailStatuses)) {
      return 'All checks failed';
    } else {
      const noun = detailStatuses.length === 1 ? 'check' : 'checks';
      const parts = [];
      const {
        pending,
        failure,
        success
      } = this.countsFromStatuses(detailStatuses);
      if (pending > 0) {
        parts.push(`${pending} pending`);
      }
      if (failure > 0) {
        parts.push(`${failure} failing`);
      }
      if (success > 0) {
        parts.push(`${success} successful`);
      }
      return (0, _helpers.toSentence)(parts) + ` ${noun}`;
    }
  }
  countsFromStatuses(statuses) {
    const counts = {
      pending: 0,
      failure: 0,
      success: 0,
      neutral: 0
    };
    for (const buildStatus of statuses) {
      const count = counts[buildStatus.classSuffix];
      /* istanbul ignore else */
      if (count !== undefined) {
        counts[buildStatus.classSuffix] = count + 1;
      }
    }
    return counts;
  }
  getHeadCommit() {
    return this.props.pullRequest.recentCommits.edges[0].node.commit;
  }
  getSummaryBuildStatus(runsBySuite) {
    const contextStatus = (0, _buildStatus.buildStatusFromStatusContext)(this.getHeadCommit().status || {});
    const checkRunStatuses = [];
    for (const [, runs] of runsBySuite) {
      for (const checkRun of runs) {
        checkRunStatuses.push((0, _buildStatus.buildStatusFromCheckResult)(checkRun));
      }
    }
    return (0, _buildStatus.combineBuildStatuses)(contextStatus, ...checkRunStatuses);
  }
  getDetailBuildStatuses(runsBySuite) {
    const headCommit = this.getHeadCommit();
    const statuses = [];
    if (headCommit.status) {
      for (const context of headCommit.status.contexts) {
        statuses.push((0, _buildStatus.buildStatusFromStatusContext)(context));
      }
    }
    for (const [, checkRuns] of runsBySuite) {
      for (const checkRun of checkRuns) {
        statuses.push((0, _buildStatus.buildStatusFromCheckResult)(checkRun));
      }
    }
    return statuses;
  }
  createIntervalCallback(suites) {
    return () => {
      const statuses = [(0, _buildStatus.buildStatusFromStatusContext)(this.getHeadCommit().status || {}), ...suites.map(_buildStatus.buildStatusFromCheckResult)];
      if (statuses.some(status => status.classSuffix === 'pending')) {
        return this.constructor.PENDING_REFRESH_TIMEOUT;
      } else {
        return this.constructor.COMPLETED_REFRESH_TIMEOUT;
      }
    };
  }
  isAllSucceeded(buildStatuses) {
    return buildStatuses.classSuffix === 'success';
  }
  isAllFailed(detailStatuses) {
    return detailStatuses.every(s => s.classSuffix === 'failure');
  }
}
exports.BarePrStatusesView = BarePrStatusesView;
_defineProperty(BarePrStatusesView, "propTypes", {
  // Relay
  relay: _propTypes.default.shape({
    refetch: _propTypes.default.func.isRequired
  }).isRequired,
  pullRequest: _propTypes.default.shape({
    id: _propTypes.default.string.isRequired,
    recentCommits: (0, _propTypes2.RelayConnectionPropType)(_propTypes.default.shape({
      commit: _propTypes.default.shape({
        status: _propTypes.default.shape({
          state: _propTypes.default.string.isRequired,
          contexts: _propTypes.default.arrayOf(_propTypes.default.shape({
            id: _propTypes.default.string.isRequired
          }).isRequired).isRequired
        })
      }).isRequired
    }).isRequired).isRequired
  }).isRequired,
  // Control
  displayType: _propTypes.default.oneOf(['check', 'full']),
  // Action
  switchToIssueish: _propTypes.default.func.isRequired
});
_defineProperty(BarePrStatusesView, "defaultProps", {
  displayType: 'full'
});
_defineProperty(BarePrStatusesView, "lastRefreshPerPr", new Map());
_defineProperty(BarePrStatusesView, "COMPLETED_REFRESH_TIMEOUT", 3 * 60 * 1000);
_defineProperty(BarePrStatusesView, "PENDING_REFRESH_TIMEOUT", 30 * 1000);
_defineProperty(BarePrStatusesView, "MINIMUM_REFRESH_INTERVAL", 15 * 1000);
var _default = (0, _reactRelay.createRefetchContainer)(BarePrStatusesView, {
  pullRequest: function () {
    const node = require("./__generated__/prStatusesView_pullRequest.graphql");
    if (node.hash && node.hash !== "e21e2ef5e505a4a8e895bf13cb4202ab") {
      console.error("The definition of 'prStatusesView_pullRequest' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }
    return require("./__generated__/prStatusesView_pullRequest.graphql");
  }
}, function () {
  const node = require("./__generated__/prStatusesViewRefetchQuery.graphql");
  if (node.hash && node.hash !== "34c4cfc61df6413f34a5efa61768cd48") {
    console.error("The definition of 'prStatusesViewRefetchQuery' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
  }
  return require("./__generated__/prStatusesViewRefetchQuery.graphql");
});
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdFJlbGF5IiwiX3Byb3BUeXBlcyIsIl9ldmVudEtpdCIsIl9oZWxwZXJzIiwiX3ByU3RhdHVzQ29udGV4dFZpZXciLCJfY2hlY2tTdWl0ZVZpZXciLCJfY2hlY2tTdWl0ZXNBY2N1bXVsYXRvciIsIl9idWlsZFN0YXR1cyIsIl9vY3RpY29uIiwiX3N0YXR1c0RvbnV0Q2hhcnQiLCJfcGVyaW9kaWNSZWZyZXNoZXIiLCJfcHJvcFR5cGVzMiIsIm9iaiIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmluZVByb3BlcnR5Iiwia2V5IiwidmFsdWUiLCJfdG9Qcm9wZXJ0eUtleSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsIndyaXRhYmxlIiwiYXJnIiwiX3RvUHJpbWl0aXZlIiwiU3RyaW5nIiwiaW5wdXQiLCJoaW50IiwicHJpbSIsIlN5bWJvbCIsInRvUHJpbWl0aXZlIiwidW5kZWZpbmVkIiwicmVzIiwiY2FsbCIsIlR5cGVFcnJvciIsIk51bWJlciIsIkJhcmVQclN0YXR1c2VzVmlldyIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY29uc3RydWN0b3IiLCJwcm9wcyIsInJlbGF5IiwicmVmZXRjaCIsImlkIiwicHVsbFJlcXVlc3QiLCJlbWl0dGVyIiwiZW1pdCIsImZvcmNlIiwicmVzdWx0IiwiZXJyIiwiZXJyb3JzIiwiY29uc29sZSIsImVycm9yIiwiZ2V0SGVhZENvbW1pdCIsInN0YXR1cyIsInN1aXRlcyIsImxlbmd0aCIsInJlZnJlc2hlck9wdHMiLCJpbnRlcnZhbCIsImNyZWF0ZUludGVydmFsQ2FsbGJhY2siLCJkaXNwbGF5VHlwZSIsInJlbmRlckFzRnVsbCIsInJlbmRlckFzQ2hlY2siLCJjYiIsIm9uIiwiRW1pdHRlciIsImdldEN1cnJlbnRJZCIsInJlZnJlc2giLCJtaW5pbXVtSW50ZXJ2YWxQZXJJZCIsIk1JTklNVU1fUkVGUkVTSF9JTlRFUlZBTCIsImNvbXBvbmVudERpZE1vdW50IiwicmVmcmVzaGVyIiwiUGVyaW9kaWNSZWZyZXNoZXIiLCJzdGFydCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiZGVzdHJveSIsInJlbmRlciIsImhlYWRDb21taXQiLCJjcmVhdGVFbGVtZW50Iiwib25EaWRSZWZldGNoIiwiY29tbWl0IiwicmVuZGVyV2l0aENoZWNrcyIsInJ1bnNCeVN1aXRlIiwic3VtbWFyeVN0YXR1cyIsImdldFN1bW1hcnlCdWlsZFN0YXR1cyIsImljb24iLCJjbGFzc05hbWUiLCJjbGFzc1N1ZmZpeCIsImNvbnRleHRzIiwiZGV0YWlsU3RhdHVzZXMiLCJnZXREZXRhaWxCdWlsZFN0YXR1c2VzIiwicmVuZGVyRG9udXRDaGFydCIsInN1bW1hcnlTZW50ZW5jZSIsIm1hcCIsImNvbnRleHQiLCJzdWl0ZSIsImNoZWNrU3VpdGUiLCJjaGVja1J1bnMiLCJnZXQiLCJzd2l0Y2hUb0lzc3VlaXNoIiwiY291bnRzIiwiY291bnRzRnJvbVN0YXR1c2VzIiwiaXNBbGxTdWNjZWVkZWQiLCJpc0FsbEZhaWxlZCIsIm5vdW4iLCJwYXJ0cyIsInBlbmRpbmciLCJmYWlsdXJlIiwic3VjY2VzcyIsInB1c2giLCJ0b1NlbnRlbmNlIiwic3RhdHVzZXMiLCJuZXV0cmFsIiwiYnVpbGRTdGF0dXMiLCJjb3VudCIsInJlY2VudENvbW1pdHMiLCJlZGdlcyIsIm5vZGUiLCJjb250ZXh0U3RhdHVzIiwiYnVpbGRTdGF0dXNGcm9tU3RhdHVzQ29udGV4dCIsImNoZWNrUnVuU3RhdHVzZXMiLCJydW5zIiwiY2hlY2tSdW4iLCJidWlsZFN0YXR1c0Zyb21DaGVja1Jlc3VsdCIsImNvbWJpbmVCdWlsZFN0YXR1c2VzIiwic29tZSIsIlBFTkRJTkdfUkVGUkVTSF9USU1FT1VUIiwiQ09NUExFVEVEX1JFRlJFU0hfVElNRU9VVCIsImJ1aWxkU3RhdHVzZXMiLCJldmVyeSIsInMiLCJleHBvcnRzIiwiUHJvcFR5cGVzIiwic2hhcGUiLCJmdW5jIiwiaXNSZXF1aXJlZCIsInN0cmluZyIsIlJlbGF5Q29ubmVjdGlvblByb3BUeXBlIiwic3RhdGUiLCJhcnJheU9mIiwib25lT2YiLCJNYXAiLCJfZGVmYXVsdCIsImNyZWF0ZVJlZmV0Y2hDb250YWluZXIiLCJoYXNoIl0sInNvdXJjZXMiOlsicHItc3RhdHVzZXMtdmlldy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtjcmVhdGVSZWZldGNoQ29udGFpbmVyLCBncmFwaHFsfSBmcm9tICdyZWFjdC1yZWxheSc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtFbWl0dGVyfSBmcm9tICdldmVudC1raXQnO1xuXG5pbXBvcnQge3RvU2VudGVuY2V9IGZyb20gJy4uL2hlbHBlcnMnO1xuaW1wb3J0IFB1bGxSZXF1ZXN0U3RhdHVzQ29udGV4dFZpZXcgZnJvbSAnLi9wci1zdGF0dXMtY29udGV4dC12aWV3JztcbmltcG9ydCBDaGVja1N1aXRlVmlldyBmcm9tICcuL2NoZWNrLXN1aXRlLXZpZXcnO1xuaW1wb3J0IENoZWNrU3VpdGVzQWNjdW11bGF0b3IgZnJvbSAnLi4vY29udGFpbmVycy9hY2N1bXVsYXRvcnMvY2hlY2stc3VpdGVzLWFjY3VtdWxhdG9yJztcbmltcG9ydCB7XG4gIGJ1aWxkU3RhdHVzRnJvbVN0YXR1c0NvbnRleHQsXG4gIGJ1aWxkU3RhdHVzRnJvbUNoZWNrUmVzdWx0LFxuICBjb21iaW5lQnVpbGRTdGF0dXNlcyxcbn0gZnJvbSAnLi4vbW9kZWxzL2J1aWxkLXN0YXR1cyc7XG5pbXBvcnQgT2N0aWNvbiBmcm9tICcuLi9hdG9tL29jdGljb24nO1xuaW1wb3J0IFN0YXR1c0RvbnV0Q2hhcnQgZnJvbSAnLi9zdGF0dXMtZG9udXQtY2hhcnQnO1xuaW1wb3J0IFBlcmlvZGljUmVmcmVzaGVyIGZyb20gJy4uL3BlcmlvZGljLXJlZnJlc2hlcic7XG5pbXBvcnQge1JlbGF5Q29ubmVjdGlvblByb3BUeXBlfSBmcm9tICcuLi9wcm9wLXR5cGVzJztcblxuZXhwb3J0IGNsYXNzIEJhcmVQclN0YXR1c2VzVmlldyBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLy8gUmVsYXlcbiAgICByZWxheTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIHJlZmV0Y2g6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgfSkuaXNSZXF1aXJlZCxcbiAgICBwdWxsUmVxdWVzdDogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIGlkOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICByZWNlbnRDb21taXRzOiBSZWxheUNvbm5lY3Rpb25Qcm9wVHlwZShcbiAgICAgICAgUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgICBjb21taXQ6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgICAgICBzdGF0dXM6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgICAgICAgIHN0YXRlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWQsXG4gICAgICAgICAgICAgIGNvbnRleHRzOiBQcm9wVHlwZXMuYXJyYXlPZihcbiAgICAgICAgICAgICAgICBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICAgICAgICAgICAgaWQ6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgICAgICAgICAgICB9KS5pc1JlcXVpcmVkLFxuICAgICAgICAgICAgICApLmlzUmVxdWlyZWQsXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB9KS5pc1JlcXVpcmVkLFxuICAgICAgICB9KS5pc1JlcXVpcmVkLFxuICAgICAgKS5pc1JlcXVpcmVkLFxuICAgIH0pLmlzUmVxdWlyZWQsXG5cbiAgICAvLyBDb250cm9sXG4gICAgZGlzcGxheVR5cGU6IFByb3BUeXBlcy5vbmVPZihbXG4gICAgICAnY2hlY2snLCAnZnVsbCcsXG4gICAgXSksXG5cbiAgICAvLyBBY3Rpb25cbiAgICBzd2l0Y2hUb0lzc3VlaXNoOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBkaXNwbGF5VHlwZTogJ2Z1bGwnLFxuICB9XG5cbiAgc3RhdGljIGxhc3RSZWZyZXNoUGVyUHIgPSBuZXcgTWFwKClcblxuICBzdGF0aWMgQ09NUExFVEVEX1JFRlJFU0hfVElNRU9VVCA9IDMgKiA2MCAqIDEwMDBcbiAgc3RhdGljIFBFTkRJTkdfUkVGUkVTSF9USU1FT1VUID0gMzAgKiAxMDAwXG4gIHN0YXRpYyBNSU5JTVVNX1JFRlJFU0hfSU5URVJWQUwgPSAxNSAqIDEwMDBcblxuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcblxuICAgIHRoaXMuZW1pdHRlciA9IG5ldyBFbWl0dGVyKCk7XG5cbiAgICB0aGlzLnJlZnJlc2hlck9wdHMgPSB7XG4gICAgICBpbnRlcnZhbDogdGhpcy5jcmVhdGVJbnRlcnZhbENhbGxiYWNrKFtdKSxcbiAgICAgIGdldEN1cnJlbnRJZDogKCkgPT4gdGhpcy5wcm9wcy5wdWxsUmVxdWVzdC5pZCxcbiAgICAgIHJlZnJlc2g6IHRoaXMucmVmcmVzaCxcbiAgICAgIG1pbmltdW1JbnRlcnZhbFBlcklkOiB0aGlzLmNvbnN0cnVjdG9yLk1JTklNVU1fUkVGUkVTSF9JTlRFUlZBTCxcbiAgICB9O1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5yZWZyZXNoZXIgPSBuZXcgUGVyaW9kaWNSZWZyZXNoZXIodGhpcy5jb25zdHJ1Y3RvciwgdGhpcy5yZWZyZXNoZXJPcHRzKTtcbiAgICB0aGlzLnJlZnJlc2hlci5zdGFydCgpO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgdGhpcy5yZWZyZXNoZXIuZGVzdHJveSgpO1xuICB9XG5cbiAgcmVmcmVzaCA9ICgpID0+IHtcbiAgICB0aGlzLnByb3BzLnJlbGF5LnJlZmV0Y2goe1xuICAgICAgaWQ6IHRoaXMucHJvcHMucHVsbFJlcXVlc3QuaWQsXG4gICAgfSwgbnVsbCwgKCkgPT4gdGhpcy5lbWl0dGVyLmVtaXQoJ2RpZC1yZWZldGNoJyksIHtmb3JjZTogdHJ1ZX0pO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGhlYWRDb21taXQgPSB0aGlzLmdldEhlYWRDb21taXQoKTtcbiAgICByZXR1cm4gKFxuICAgICAgPENoZWNrU3VpdGVzQWNjdW11bGF0b3Igb25EaWRSZWZldGNoPXt0aGlzLm9uRGlkUmVmZXRjaH0gY29tbWl0PXtoZWFkQ29tbWl0fT5cbiAgICAgICAge3RoaXMucmVuZGVyV2l0aENoZWNrc31cbiAgICAgIDwvQ2hlY2tTdWl0ZXNBY2N1bXVsYXRvcj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyV2l0aENoZWNrcyA9IHJlc3VsdCA9PiB7XG4gICAgZm9yIChjb25zdCBlcnIgb2YgcmVzdWx0LmVycm9ycykge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZ2V0SGVhZENvbW1pdCgpLnN0YXR1cyAmJiByZXN1bHQuc3VpdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5yZWZyZXNoZXJPcHRzLmludGVydmFsID0gdGhpcy5jcmVhdGVJbnRlcnZhbENhbGxiYWNrKHJlc3VsdC5zdWl0ZXMpO1xuXG4gICAgaWYgKHRoaXMucHJvcHMuZGlzcGxheVR5cGUgPT09ICdmdWxsJykge1xuICAgICAgcmV0dXJuIHRoaXMucmVuZGVyQXNGdWxsKHJlc3VsdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnJlbmRlckFzQ2hlY2socmVzdWx0KTtcbiAgICB9XG4gIH1cblxuICByZW5kZXJBc0NoZWNrKHtydW5zQnlTdWl0ZX0pIHtcbiAgICBjb25zdCBzdW1tYXJ5U3RhdHVzID0gdGhpcy5nZXRTdW1tYXJ5QnVpbGRTdGF0dXMocnVuc0J5U3VpdGUpO1xuICAgIHJldHVybiA8T2N0aWNvbiBpY29uPXtzdW1tYXJ5U3RhdHVzLmljb259IGNsYXNzTmFtZT17YGdpdGh1Yi1QclN0YXR1c2VzLS0ke3N1bW1hcnlTdGF0dXMuY2xhc3NTdWZmaXh9YH0gLz47XG4gIH1cblxuICByZW5kZXJBc0Z1bGwoe3N1aXRlcywgcnVuc0J5U3VpdGV9KSB7XG4gICAgY29uc3Qgc3RhdHVzID0gdGhpcy5nZXRIZWFkQ29tbWl0KCkuc3RhdHVzO1xuICAgIGNvbnN0IGNvbnRleHRzID0gc3RhdHVzID8gc3RhdHVzLmNvbnRleHRzIDogW107XG5cbiAgICBjb25zdCBzdW1tYXJ5U3RhdHVzID0gdGhpcy5nZXRTdW1tYXJ5QnVpbGRTdGF0dXMocnVuc0J5U3VpdGUpO1xuICAgIGNvbnN0IGRldGFpbFN0YXR1c2VzID0gdGhpcy5nZXREZXRhaWxCdWlsZFN0YXR1c2VzKHJ1bnNCeVN1aXRlKTtcblxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT1cImdpdGh1Yi1QclN0YXR1c2VzXCI+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZ2l0aHViLVByU3RhdHVzZXMtaGVhZGVyXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJnaXRodWItUHJTdGF0dXNlcy1kb251dC1jaGFydFwiPlxuICAgICAgICAgICAge3RoaXMucmVuZGVyRG9udXRDaGFydChkZXRhaWxTdGF0dXNlcyl9XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJnaXRodWItUHJTdGF0dXNlcy1zdW1tYXJ5XCI+XG4gICAgICAgICAgICB7dGhpcy5zdW1tYXJ5U2VudGVuY2Uoc3VtbWFyeVN0YXR1cywgZGV0YWlsU3RhdHVzZXMpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHVsIGNsYXNzTmFtZT1cImdpdGh1Yi1QclN0YXR1c2VzLWxpc3RcIj5cbiAgICAgICAgICB7Y29udGV4dHMubWFwKGNvbnRleHQgPT4gPFB1bGxSZXF1ZXN0U3RhdHVzQ29udGV4dFZpZXcga2V5PXtjb250ZXh0LmlkfSBjb250ZXh0PXtjb250ZXh0fSAvPil9XG4gICAgICAgICAge3N1aXRlcy5tYXAoc3VpdGUgPT4gKFxuICAgICAgICAgICAgPENoZWNrU3VpdGVWaWV3XG4gICAgICAgICAgICAgIGtleT17c3VpdGUuaWR9XG4gICAgICAgICAgICAgIGNoZWNrU3VpdGU9e3N1aXRlfVxuICAgICAgICAgICAgICBjaGVja1J1bnM9e3J1bnNCeVN1aXRlLmdldChzdWl0ZSl9XG4gICAgICAgICAgICAgIHN3aXRjaFRvSXNzdWVpc2g9e3RoaXMucHJvcHMuc3dpdGNoVG9Jc3N1ZWlzaH1cbiAgICAgICAgICAgIC8+XG4gICAgICAgICAgKSl9XG4gICAgICAgIDwvdWw+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRG9udXRDaGFydChkZXRhaWxTdGF0dXNlcykge1xuICAgIGNvbnN0IGNvdW50cyA9IHRoaXMuY291bnRzRnJvbVN0YXR1c2VzKGRldGFpbFN0YXR1c2VzKTtcbiAgICByZXR1cm4gPFN0YXR1c0RvbnV0Q2hhcnQgey4uLmNvdW50c30gLz47XG4gIH1cblxuICBzdW1tYXJ5U2VudGVuY2Uoc3VtbWFyeVN0YXR1cywgZGV0YWlsU3RhdHVzZXMpIHtcbiAgICBpZiAodGhpcy5pc0FsbFN1Y2NlZWRlZChzdW1tYXJ5U3RhdHVzKSkge1xuICAgICAgcmV0dXJuICdBbGwgY2hlY2tzIHN1Y2NlZWRlZCc7XG4gICAgfSBlbHNlIGlmICh0aGlzLmlzQWxsRmFpbGVkKGRldGFpbFN0YXR1c2VzKSkge1xuICAgICAgcmV0dXJuICdBbGwgY2hlY2tzIGZhaWxlZCc7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IG5vdW4gPSBkZXRhaWxTdGF0dXNlcy5sZW5ndGggPT09IDEgPyAnY2hlY2snIDogJ2NoZWNrcyc7XG4gICAgICBjb25zdCBwYXJ0cyA9IFtdO1xuICAgICAgY29uc3Qge3BlbmRpbmcsIGZhaWx1cmUsIHN1Y2Nlc3N9ID0gdGhpcy5jb3VudHNGcm9tU3RhdHVzZXMoZGV0YWlsU3RhdHVzZXMpO1xuXG4gICAgICBpZiAocGVuZGluZyA+IDApIHtcbiAgICAgICAgcGFydHMucHVzaChgJHtwZW5kaW5nfSBwZW5kaW5nYCk7XG4gICAgICB9XG4gICAgICBpZiAoZmFpbHVyZSA+IDApIHtcbiAgICAgICAgcGFydHMucHVzaChgJHtmYWlsdXJlfSBmYWlsaW5nYCk7XG4gICAgICB9XG4gICAgICBpZiAoc3VjY2VzcyA+IDApIHtcbiAgICAgICAgcGFydHMucHVzaChgJHtzdWNjZXNzfSBzdWNjZXNzZnVsYCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdG9TZW50ZW5jZShwYXJ0cykgKyBgICR7bm91bn1gO1xuICAgIH1cbiAgfVxuXG4gIGNvdW50c0Zyb21TdGF0dXNlcyhzdGF0dXNlcykge1xuICAgIGNvbnN0IGNvdW50cyA9IHtcbiAgICAgIHBlbmRpbmc6IDAsXG4gICAgICBmYWlsdXJlOiAwLFxuICAgICAgc3VjY2VzczogMCxcbiAgICAgIG5ldXRyYWw6IDAsXG4gICAgfTtcblxuICAgIGZvciAoY29uc3QgYnVpbGRTdGF0dXMgb2Ygc3RhdHVzZXMpIHtcbiAgICAgIGNvbnN0IGNvdW50ID0gY291bnRzW2J1aWxkU3RhdHVzLmNsYXNzU3VmZml4XTtcbiAgICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBlbHNlICovXG4gICAgICBpZiAoY291bnQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb3VudHNbYnVpbGRTdGF0dXMuY2xhc3NTdWZmaXhdID0gY291bnQgKyAxO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gY291bnRzO1xuICB9XG5cbiAgZ2V0SGVhZENvbW1pdCgpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5wdWxsUmVxdWVzdC5yZWNlbnRDb21taXRzLmVkZ2VzWzBdLm5vZGUuY29tbWl0O1xuICB9XG5cbiAgZ2V0U3VtbWFyeUJ1aWxkU3RhdHVzKHJ1bnNCeVN1aXRlKSB7XG4gICAgY29uc3QgY29udGV4dFN0YXR1cyA9IGJ1aWxkU3RhdHVzRnJvbVN0YXR1c0NvbnRleHQodGhpcy5nZXRIZWFkQ29tbWl0KCkuc3RhdHVzIHx8IHt9KTtcbiAgICBjb25zdCBjaGVja1J1blN0YXR1c2VzID0gW107XG4gICAgZm9yIChjb25zdCBbLCBydW5zXSBvZiBydW5zQnlTdWl0ZSkge1xuICAgICAgZm9yIChjb25zdCBjaGVja1J1biBvZiBydW5zKSB7XG4gICAgICAgIGNoZWNrUnVuU3RhdHVzZXMucHVzaChidWlsZFN0YXR1c0Zyb21DaGVja1Jlc3VsdChjaGVja1J1bikpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBjb21iaW5lQnVpbGRTdGF0dXNlcyhjb250ZXh0U3RhdHVzLCAuLi5jaGVja1J1blN0YXR1c2VzKTtcbiAgfVxuXG4gIGdldERldGFpbEJ1aWxkU3RhdHVzZXMocnVuc0J5U3VpdGUpIHtcbiAgICBjb25zdCBoZWFkQ29tbWl0ID0gdGhpcy5nZXRIZWFkQ29tbWl0KCk7XG5cbiAgICBjb25zdCBzdGF0dXNlcyA9IFtdO1xuXG4gICAgaWYgKGhlYWRDb21taXQuc3RhdHVzKSB7XG4gICAgICBmb3IgKGNvbnN0IGNvbnRleHQgb2YgaGVhZENvbW1pdC5zdGF0dXMuY29udGV4dHMpIHtcbiAgICAgICAgc3RhdHVzZXMucHVzaChidWlsZFN0YXR1c0Zyb21TdGF0dXNDb250ZXh0KGNvbnRleHQpKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmb3IgKGNvbnN0IFssIGNoZWNrUnVuc10gb2YgcnVuc0J5U3VpdGUpIHtcbiAgICAgIGZvciAoY29uc3QgY2hlY2tSdW4gb2YgY2hlY2tSdW5zKSB7XG4gICAgICAgIHN0YXR1c2VzLnB1c2goYnVpbGRTdGF0dXNGcm9tQ2hlY2tSZXN1bHQoY2hlY2tSdW4pKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gc3RhdHVzZXM7XG4gIH1cblxuICBjcmVhdGVJbnRlcnZhbENhbGxiYWNrKHN1aXRlcykge1xuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjb25zdCBzdGF0dXNlcyA9IFtcbiAgICAgICAgYnVpbGRTdGF0dXNGcm9tU3RhdHVzQ29udGV4dCh0aGlzLmdldEhlYWRDb21taXQoKS5zdGF0dXMgfHwge30pLFxuICAgICAgICAuLi5zdWl0ZXMubWFwKGJ1aWxkU3RhdHVzRnJvbUNoZWNrUmVzdWx0KSxcbiAgICAgIF07XG5cbiAgICAgIGlmIChzdGF0dXNlcy5zb21lKHN0YXR1cyA9PiBzdGF0dXMuY2xhc3NTdWZmaXggPT09ICdwZW5kaW5nJykpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29uc3RydWN0b3IuUEVORElOR19SRUZSRVNIX1RJTUVPVVQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gdGhpcy5jb25zdHJ1Y3Rvci5DT01QTEVURURfUkVGUkVTSF9USU1FT1VUO1xuICAgICAgfVxuICAgIH07XG4gIH1cblxuICBpc0FsbFN1Y2NlZWRlZChidWlsZFN0YXR1c2VzKSB7XG4gICAgcmV0dXJuIGJ1aWxkU3RhdHVzZXMuY2xhc3NTdWZmaXggPT09ICdzdWNjZXNzJztcbiAgfVxuXG4gIGlzQWxsRmFpbGVkKGRldGFpbFN0YXR1c2VzKSB7XG4gICAgcmV0dXJuIGRldGFpbFN0YXR1c2VzLmV2ZXJ5KHMgPT4gcy5jbGFzc1N1ZmZpeCA9PT0gJ2ZhaWx1cmUnKTtcbiAgfVxuXG4gIG9uRGlkUmVmZXRjaCA9IGNiID0+IHRoaXMuZW1pdHRlci5vbignZGlkLXJlZmV0Y2gnLCBjYilcbn1cblxuZXhwb3J0IGRlZmF1bHQgY3JlYXRlUmVmZXRjaENvbnRhaW5lcihCYXJlUHJTdGF0dXNlc1ZpZXcsIHtcbiAgcHVsbFJlcXVlc3Q6IGdyYXBocWxgXG4gICAgZnJhZ21lbnQgcHJTdGF0dXNlc1ZpZXdfcHVsbFJlcXVlc3Qgb24gUHVsbFJlcXVlc3RcbiAgICBAYXJndW1lbnREZWZpbml0aW9ucyhcbiAgICAgIGNoZWNrU3VpdGVDb3VudDoge3R5cGU6IFwiSW50IVwifVxuICAgICAgY2hlY2tTdWl0ZUN1cnNvcjoge3R5cGU6IFwiU3RyaW5nXCJ9XG4gICAgICBjaGVja1J1bkNvdW50OiB7dHlwZTogXCJJbnQhXCJ9XG4gICAgICBjaGVja1J1bkN1cnNvcjoge3R5cGU6IFwiU3RyaW5nXCJ9XG4gICAgKSB7XG4gICAgICBpZFxuICAgICAgcmVjZW50Q29tbWl0czogY29tbWl0cyhsYXN0OjEpIHtcbiAgICAgICAgZWRnZXMge1xuICAgICAgICAgIG5vZGUge1xuICAgICAgICAgICAgY29tbWl0IHtcbiAgICAgICAgICAgICAgc3RhdHVzIHtcbiAgICAgICAgICAgICAgICBzdGF0ZVxuICAgICAgICAgICAgICAgIGNvbnRleHRzIHtcbiAgICAgICAgICAgICAgICAgIGlkXG4gICAgICAgICAgICAgICAgICBzdGF0ZVxuICAgICAgICAgICAgICAgICAgLi4ucHJTdGF0dXNDb250ZXh0Vmlld19jb250ZXh0XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgLi4uY2hlY2tTdWl0ZXNBY2N1bXVsYXRvcl9jb21taXQgQGFyZ3VtZW50cyhcbiAgICAgICAgICAgICAgICBjaGVja1N1aXRlQ291bnQ6ICRjaGVja1N1aXRlQ291bnRcbiAgICAgICAgICAgICAgICBjaGVja1N1aXRlQ3Vyc29yOiAkY2hlY2tTdWl0ZUN1cnNvclxuICAgICAgICAgICAgICAgIGNoZWNrUnVuQ291bnQ6ICRjaGVja1J1bkNvdW50XG4gICAgICAgICAgICAgICAgY2hlY2tSdW5DdXJzb3I6ICRjaGVja1J1bkN1cnNvclxuICAgICAgICAgICAgICApXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICBgLFxufSwgZ3JhcGhxbGBcbiAgcXVlcnkgcHJTdGF0dXNlc1ZpZXdSZWZldGNoUXVlcnkoXG4gICAgJGlkOiBJRCFcbiAgICAkY2hlY2tTdWl0ZUNvdW50OiBJbnQhXG4gICAgJGNoZWNrU3VpdGVDdXJzb3I6IFN0cmluZ1xuICAgICRjaGVja1J1bkNvdW50OiBJbnQhXG4gICAgJGNoZWNrUnVuQ3Vyc29yOiBTdHJpbmdcbiAgKSB7XG4gICAgbm9kZShpZDogJGlkKSB7XG4gICAgICAuLi4gb24gUHVsbFJlcXVlc3Qge1xuICAgICAgICAuLi5wclN0YXR1c2VzVmlld19wdWxsUmVxdWVzdCBAYXJndW1lbnRzKFxuICAgICAgICAgIGNoZWNrU3VpdGVDb3VudDogJGNoZWNrU3VpdGVDb3VudFxuICAgICAgICAgIGNoZWNrU3VpdGVDdXJzb3I6ICRjaGVja1N1aXRlQ3Vyc29yXG4gICAgICAgICAgY2hlY2tSdW5Db3VudDogJGNoZWNrUnVuQ291bnRcbiAgICAgICAgICBjaGVja1J1bkN1cnNvcjogJGNoZWNrUnVuQ3Vyc29yXG4gICAgICAgIClcbiAgICAgIH1cbiAgICB9XG4gIH1cbmApO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFELE9BQUE7QUFDQSxJQUFBRSxVQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFILE9BQUE7QUFFQSxJQUFBSSxRQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxvQkFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sZUFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU8sdUJBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFRLFlBQUEsR0FBQVIsT0FBQTtBQUtBLElBQUFTLFFBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLGlCQUFBLEdBQUFYLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBVyxrQkFBQSxHQUFBWixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVksV0FBQSxHQUFB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