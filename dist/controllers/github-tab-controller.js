"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _propTypes2 = require("../prop-types");

var _githubTabView = _interopRequireDefault(require("../views/github-tab-view"));

var _reporterProxy = require("../reporter-proxy");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class GitHubTabController extends _react.default.Component {
  constructor(...args) {
    super(...args);

    _defineProperty(this, "handlePushBranch", (currentBranch, targetRemote) => {
      return this.props.repository.push(currentBranch.getName(), {
        remote: targetRemote,
        setUpstream: true
      });
    });

    _defineProperty(this, "handleRemoteSelect", (e, remote) => {
      e.preventDefault();
      return this.props.repository.setConfig('atomGithub.currentRemote', remote.getName());
    });

    _defineProperty(this, "openBoundPublishDialog", () => this.props.openPublishDialog(this.props.repository));

    _defineProperty(this, "handleLogin", token => {
      (0, _reporterProxy.incrementCounter)('github-login');
      this.props.loginModel.setToken(this.currentEndpoint().getLoginAccount(), token);
    });

    _defineProperty(this, "handleLogout", () => {
      (0, _reporterProxy.incrementCounter)('github-logout');
      this.props.loginModel.removeToken(this.currentEndpoint().getLoginAccount());
    });

    _defineProperty(this, "handleTokenRetry", () => this.props.loginModel.didUpdate());
  }

  render() {
    return _react.default.createElement(_githubTabView.default // Connection
    , {
      endpoint: this.currentEndpoint(),
      token: this.props.token,
      workspace: this.props.workspace,
      refresher: this.props.refresher,
      rootHolder: this.props.rootHolder,
      workingDirectory: this.props.workingDirectory || this.props.currentWorkDir,
      contextLocked: this.props.contextLocked,
      repository: this.props.repository,
      branches: this.props.branches,
      currentBranch: this.props.currentBranch,
      remotes: this.props.githubRemotes,
      currentRemote: this.props.currentRemote,
      manyRemotesAvailable: this.props.manyRemotesAvailable,
      aheadCount: this.props.aheadCount,
      pushInProgress: this.props.pushInProgress,
      isLoading: this.props.isLoading,
      handleLogin: this.handleLogin,
      handleLogout: this.handleLogout,
      handleTokenRetry: this.handleTokenRetry,
      handlePushBranch: this.handlePushBranch,
      handleRemoteSelect: this.handleRemoteSelect,
      changeWorkingDirectory: this.props.changeWorkingDirectory,
      setContextLock: this.props.setContextLock,
      getCurrentWorkDirs: this.props.getCurrentWorkDirs,
      onDidChangeWorkDirs: this.props.onDidChangeWorkDirs,
      openCreateDialog: this.props.openCreateDialog,
      openBoundPublishDialog: this.openBoundPublishDialog,
      openCloneDialog: this.props.openCloneDialog,
      openGitTab: this.props.openGitTab
    });
  }

  currentEndpoint() {
    return this.props.currentRemote.getEndpointOrDotcom();
  }

}

exports.default = GitHubTabController;

_defineProperty(GitHubTabController, "propTypes", {
  workspace: _propTypes.default.object.isRequired,
  refresher: _propTypes2.RefresherPropType.isRequired,
  loginModel: _propTypes2.GithubLoginModelPropType.isRequired,
  token: _propTypes2.TokenPropType,
  rootHolder: _propTypes2.RefHolderPropType.isRequired,
  workingDirectory: _propTypes.default.string,
  repository: _propTypes.default.object.isRequired,
  allRemotes: _propTypes2.RemoteSetPropType.isRequired,
  githubRemotes: _propTypes2.RemoteSetPropType.isRequired,
  currentRemote: _propTypes2.RemotePropType.isRequired,
  branches: _propTypes2.BranchSetPropType.isRequired,
  currentBranch: _propTypes2.BranchPropType.isRequired,
  aheadCount: _propTypes.default.number.isRequired,
  manyRemotesAvailable: _propTypes.default.bool.isRequired,
  pushInProgress: _propTypes.default.bool.isRequired,
  isLoading: _propTypes.default.bool.isRequired,
  currentWorkDir: _propTypes.default.string,
  changeWorkingDirectory: _propTypes.default.func.isRequired,
  setContextLock: _propTypes.default.func.isRequired,
  contextLocked: _propTypes.default.bool.isRequired,
  onDidChangeWorkDirs: _propTypes.default.func.isRequired,
  getCurrentWorkDirs: _propTypes.default.func.isRequired,
  openCreateDialog: _propTypes.default.func.isRequired,
  openPublishDialog: _propTypes.default.func.isRequired,
  openCloneDialog: _propTypes.default.func.isRequired,
  openGitTab: _propTypes.default.func.isRequired
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9jb250cm9sbGVycy9naXRodWItdGFiLWNvbnRyb2xsZXIuanMiXSwibmFtZXMiOlsiR2l0SHViVGFiQ29udHJvbGxlciIsIlJlYWN0IiwiQ29tcG9uZW50IiwiY3VycmVudEJyYW5jaCIsInRhcmdldFJlbW90ZSIsInByb3BzIiwicmVwb3NpdG9yeSIsInB1c2giLCJnZXROYW1lIiwicmVtb3RlIiwic2V0VXBzdHJlYW0iLCJlIiwicHJldmVudERlZmF1bHQiLCJzZXRDb25maWciLCJvcGVuUHVibGlzaERpYWxvZyIsInRva2VuIiwibG9naW5Nb2RlbCIsInNldFRva2VuIiwiY3VycmVudEVuZHBvaW50IiwiZ2V0TG9naW5BY2NvdW50IiwicmVtb3ZlVG9rZW4iLCJkaWRVcGRhdGUiLCJyZW5kZXIiLCJ3b3Jrc3BhY2UiLCJyZWZyZXNoZXIiLCJyb290SG9sZGVyIiwid29ya2luZ0RpcmVjdG9yeSIsImN1cnJlbnRXb3JrRGlyIiwiY29udGV4dExvY2tlZCIsImJyYW5jaGVzIiwiZ2l0aHViUmVtb3RlcyIsImN1cnJlbnRSZW1vdGUiLCJtYW55UmVtb3Rlc0F2YWlsYWJsZSIsImFoZWFkQ291bnQiLCJwdXNoSW5Qcm9ncmVzcyIsImlzTG9hZGluZyIsImhhbmRsZUxvZ2luIiwiaGFuZGxlTG9nb3V0IiwiaGFuZGxlVG9rZW5SZXRyeSIsImhhbmRsZVB1c2hCcmFuY2giLCJoYW5kbGVSZW1vdGVTZWxlY3QiLCJjaGFuZ2VXb3JraW5nRGlyZWN0b3J5Iiwic2V0Q29udGV4dExvY2siLCJnZXRDdXJyZW50V29ya0RpcnMiLCJvbkRpZENoYW5nZVdvcmtEaXJzIiwib3BlbkNyZWF0ZURpYWxvZyIsIm9wZW5Cb3VuZFB1Ymxpc2hEaWFsb2ciLCJvcGVuQ2xvbmVEaWFsb2ciLCJvcGVuR2l0VGFiIiwiZ2V0RW5kcG9pbnRPckRvdGNvbSIsIlByb3BUeXBlcyIsIm9iamVjdCIsImlzUmVxdWlyZWQiLCJSZWZyZXNoZXJQcm9wVHlwZSIsIkdpdGh1YkxvZ2luTW9kZWxQcm9wVHlwZSIsIlRva2VuUHJvcFR5cGUiLCJSZWZIb2xkZXJQcm9wVHlwZSIsInN0cmluZyIsImFsbFJlbW90ZXMiLCJSZW1vdGVTZXRQcm9wVHlwZSIsIlJlbW90ZVByb3BUeXBlIiwiQnJhbmNoU2V0UHJvcFR5cGUiLCJCcmFuY2hQcm9wVHlwZSIsIm51bWJlciIsImJvb2wiLCJmdW5jIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBRUE7O0FBS0E7O0FBQ0E7Ozs7OztBQUVlLE1BQU1BLG1CQUFOLFNBQWtDQyxlQUFNQyxTQUF4QyxDQUFrRDtBQUFBO0FBQUE7O0FBQUEsOENBd0U1QyxDQUFDQyxhQUFELEVBQWdCQyxZQUFoQixLQUFpQztBQUNsRCxhQUFPLEtBQUtDLEtBQUwsQ0FBV0MsVUFBWCxDQUFzQkMsSUFBdEIsQ0FBMkJKLGFBQWEsQ0FBQ0ssT0FBZCxFQUEzQixFQUFvRDtBQUN6REMsUUFBQUEsTUFBTSxFQUFFTCxZQURpRDtBQUV6RE0sUUFBQUEsV0FBVyxFQUFFO0FBRjRDLE9BQXBELENBQVA7QUFJRCxLQTdFOEQ7O0FBQUEsZ0RBK0UxQyxDQUFDQyxDQUFELEVBQUlGLE1BQUosS0FBZTtBQUNsQ0UsTUFBQUEsQ0FBQyxDQUFDQyxjQUFGO0FBQ0EsYUFBTyxLQUFLUCxLQUFMLENBQVdDLFVBQVgsQ0FBc0JPLFNBQXRCLENBQWdDLDBCQUFoQyxFQUE0REosTUFBTSxDQUFDRCxPQUFQLEVBQTVELENBQVA7QUFDRCxLQWxGOEQ7O0FBQUEsb0RBb0Z0QyxNQUFNLEtBQUtILEtBQUwsQ0FBV1MsaUJBQVgsQ0FBNkIsS0FBS1QsS0FBTCxDQUFXQyxVQUF4QyxDQXBGZ0M7O0FBQUEseUNBc0ZqRFMsS0FBSyxJQUFJO0FBQ3JCLDJDQUFpQixjQUFqQjtBQUNBLFdBQUtWLEtBQUwsQ0FBV1csVUFBWCxDQUFzQkMsUUFBdEIsQ0FBK0IsS0FBS0MsZUFBTCxHQUF1QkMsZUFBdkIsRUFBL0IsRUFBeUVKLEtBQXpFO0FBQ0QsS0F6RjhEOztBQUFBLDBDQTJGaEQs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QmpCdEMsRUFBQUEsaUJBQWlCLEVBQUVvQyxtQkFBVWUsSUFBVixDQUFlYixVQTFCakI7QUEyQmpCTCxFQUFBQSxlQUFlLEVBQUVHLG1CQUFVZSxJQUFWLENBQWViLFVBM0JmO0FBNEJqQkosRUFBQUEsVUFBVSxFQUFFRSxtQkFBVWUsSUFBVixDQUFlYjtBQTVCVixDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5cbmltcG9ydCB7XG4gIEdpdGh1YkxvZ2luTW9kZWxQcm9wVHlwZSwgVG9rZW5Qcm9wVHlwZSwgUmVmSG9sZGVyUHJvcFR5cGUsXG4gIFJlbW90ZVNldFByb3BUeXBlLCBSZW1vdGVQcm9wVHlwZSwgQnJhbmNoU2V0UHJvcFR5cGUsIEJyYW5jaFByb3BUeXBlLFxuICBSZWZyZXNoZXJQcm9wVHlwZSxcbn0gZnJvbSAnLi4vcHJvcC10eXBlcyc7XG5pbXBvcnQgR2l0SHViVGFiVmlldyBmcm9tICcuLi92aWV3cy9naXRodWItdGFiLXZpZXcnO1xuaW1wb3J0IHtpbmNyZW1lbnRDb3VudGVyfSBmcm9tICcuLi9yZXBvcnRlci1wcm94eSc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEdpdEh1YlRhYkNvbnRyb2xsZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIHdvcmtzcGFjZTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIHJlZnJlc2hlcjogUmVmcmVzaGVyUHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBsb2dpbk1vZGVsOiBHaXRodWJMb2dpbk1vZGVsUHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICB0b2tlbjogVG9rZW5Qcm9wVHlwZSxcbiAgICByb290SG9sZGVyOiBSZWZIb2xkZXJQcm9wVHlwZS5pc1JlcXVpcmVkLFxuXG4gICAgd29ya2luZ0RpcmVjdG9yeTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICByZXBvc2l0b3J5OiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgYWxsUmVtb3RlczogUmVtb3RlU2V0UHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBnaXRodWJSZW1vdGVzOiBSZW1vdGVTZXRQcm9wVHlwZS5pc1JlcXVpcmVkLFxuICAgIGN1cnJlbnRSZW1vdGU6IFJlbW90ZVByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgYnJhbmNoZXM6IEJyYW5jaFNldFByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgY3VycmVudEJyYW5jaDogQnJhbmNoUHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICBhaGVhZENvdW50OiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgbWFueVJlbW90ZXNBdmFpbGFibGU6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgcHVzaEluUHJvZ3Jlc3M6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgaXNMb2FkaW5nOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGN1cnJlbnRXb3JrRGlyOiBQcm9wVHlwZXMuc3RyaW5nLFxuXG4gICAgY2hhbmdlV29ya2luZ0RpcmVjdG9yeTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBzZXRDb250ZXh0TG9jazogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBjb250ZXh0TG9ja2VkOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIG9uRGlkQ2hhbmdlV29ya0RpcnM6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgZ2V0Q3VycmVudFdvcmtEaXJzOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9wZW5DcmVhdGVEaWFsb2c6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb3BlblB1Ymxpc2hEaWFsb2c6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgb3BlbkNsb25lRGlhbG9nOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9wZW5HaXRUYWI6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxHaXRIdWJUYWJWaWV3XG4gICAgICAgIC8vIENvbm5lY3Rpb25cbiAgICAgICAgZW5kcG9pbnQ9e3RoaXMuY3VycmVudEVuZHBvaW50KCl9XG4gICAgICAgIHRva2VuPXt0aGlzLnByb3BzLnRva2VufVxuXG4gICAgICAgIHdvcmtzcGFjZT17dGhpcy5wcm9wcy53b3Jrc3BhY2V9XG4gICAgICAgIHJlZnJlc2hlcj17dGhpcy5wcm9wcy5yZWZyZXNoZXJ9XG4gICAgICAgIHJvb3RIb2xkZXI9e3RoaXMucHJvcHMucm9vdEhvbGRlcn1cblxuICAgICAgICB3b3JraW5nRGlyZWN0b3J5PXt0aGlzLnByb3BzLndvcmtpbmdEaXJlY3RvcnkgfHwgdGhpcy5wcm9wcy5jdXJyZW50V29ya0Rpcn1cbiAgICAgICAgY29udGV4dExvY2tlZD17dGhpcy5wcm9wcy5jb250ZXh0TG9ja2VkfVxuICAgICAgICByZXBvc2l0b3J5PXt0aGlzLnByb3BzLnJlcG9zaXRvcnl9XG4gICAgICAgIGJyYW5jaGVzPXt0aGlzLnByb3BzLmJyYW5jaGVzfVxuICAgICAgICBjdXJyZW50QnJhbmNoPXt0aGlzLnByb3BzLmN1cnJlbnRCcmFuY2h9XG4gICAgICAgIHJlbW90ZXM9e3RoaXMucHJvcHMuZ2l0aHViUmVtb3Rlc31cbiAgICAgICAgY3VycmVudFJlbW90ZT17dGhpcy5wcm9wcy5jdXJyZW50UmVtb3RlfVxuICAgICAgICBtYW55UmVtb3Rlc0F2YWlsYWJsZT17dGhpcy5wcm9wcy5tYW55UmVtb3Rlc0F2YWlsYWJsZX1cbiAgICAgICAgYWhlYWRDb3VudD17dGhpcy5wcm9wcy5haGVhZENvdW50fVxuICAgICAgICBwdXNoSW5Qcm9ncmVzcz17dGhpcy5wcm9wcy5wdXNoSW5Qcm9ncmVzc31cbiAgICAgICAgaXNMb2FkaW5nPXt0aGlzLnByb3BzLmlzTG9hZGluZ31cblxuICAgICAgICBoYW5kbGVMb2dpbj17dGhpcy5oYW5kbGVMb2dpbn1cbiAgICAgICAgaGFuZGxlTG9nb3V0PXt0aGlzLmhhbmRsZUxvZ291dH1cbiAgICAgICAgaGFuZGxlVG9rZW5SZXRyeT17dGhpcy5oYW5kbGVUb2tlblJldHJ5fVxuICAgICAgICBoYW5kbGVQdXNoQnJhbmNoPXt0aGlzLmhhbmRsZVB1c2hCcmFuY2h9XG4gICAgICAgIGhhbmRsZVJlbW90ZVNlbGVjdD17dGhpcy5oYW5kbGVSZW1vdGVTZWxlY3R9XG4gICAgICAgIGNoYW5nZVdvcmtpbmdEaXJlY3Rvcnk9e3RoaXMucHJvcHMuY2hhbmdlV29ya2luZ0RpcmVjdG9yeX1cbiAgICAgICAgc2V0Q29udGV4dExvY2s9e3RoaXMucHJvcHMuc2V0Q29udGV4dExvY2t9XG4gICAgICAgIGdldEN1cnJlbnRXb3JrRGlycz17dGhpcy5wcm9wcy5nZXRDdXJyZW50V29ya0RpcnN9XG4gICAgICAgIG9uRGlkQ2hhbmdlV29ya0RpcnM9e3RoaXMucHJvcHMub25EaWRDaGFuZ2VXb3JrRGlyc31cbiAgICAgICAgb3BlbkNyZWF0ZURpYWxvZz17dGhpcy5wcm9wcy5vcGVuQ3JlYXRlRGlhbG9nfVxuICAgICAgICBvcGVuQm91bmRQdWJsaXNoRGlhbG9nPXt0aGlzLm9wZW5Cb3VuZFB1Ymxpc2hEaWFsb2d9XG4gICAgICAgIG9wZW5DbG9uZURpYWxvZz17dGhpcy5wcm9wcy5vcGVuQ2xvbmVEaWFsb2d9XG4gICAgICAgIG9wZW5HaXRUYWI9e3RoaXMucHJvcHMub3BlbkdpdFRhYn1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIGhhbmRsZVB1c2hCcmFuY2ggPSAoY3VycmVudEJyYW5jaCwgdGFyZ2V0UmVtb3RlKSA9PiB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMucmVwb3NpdG9yeS5wdXNoKGN1cnJlbnRCcmFuY2guZ2V0TmFtZSgpLCB7XG4gICAgICByZW1vdGU6IHRhcmdldFJlbW90ZSxcbiAgICAgIHNldFVwc3RyZWFtOiB0cnVlLFxuICAgIH0pO1xuICB9XG5cbiAgaGFuZGxlUmVtb3RlU2VsZWN0ID0gKGUsIHJlbW90ZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5yZXBvc2l0b3J5LnNldENvbmZpZygnYXRvbUdpdGh1Yi5jdXJyZW50UmVtb3RlJywgcmVtb3RlLmdldE5hbWUoKSk7XG4gIH1cblxuICBvcGVuQm91bmRQdWJsaXNoRGlhbG9nID0gKCkgPT4gdGhpcy5wcm9wcy5vcGVuUHVibGlzaERpYWxvZyh0aGlzLnByb3BzLnJlcG9zaXRvcnkpO1xuXG4gIGhhbmRsZUxvZ2luID0gdG9rZW4gPT4ge1xuICAgIGluY3JlbWVudENvdW50ZXIoJ2dpdGh1Yi1sb2dpbicpO1xuICAgIHRoaXMucHJvcHMubG9naW5Nb2RlbC5zZXRUb2tlbih0aGlzLmN1cnJlbnRFbmRwb2ludCgpLmdldExvZ2luQWNjb3VudCgpLCB0b2tlbik7XG4gIH1cblxuICBoYW5kbGVMb2dvdXQgPSAoKSA9PiB7XG4gICAgaW5jcmVtZW50Q291bnRlcignZ2l0aHViLWxvZ291dCcpO1xuICAgIHRoaXMucHJvcHMubG9naW5Nb2RlbC5yZW1vdmVUb2tlbih0aGlzLmN1cnJlbnRFbmRwb2ludCgpLmdldExvZ2luQWNjb3VudCgpKTtcbiAgfVxuXG4gIGhhbmRsZVRva2VuUmV0cnkgPSAoKSA9PiB0aGlzLnByb3BzLmxvZ2luTW9kZWwuZGlkVXBkYXRlKCk7XG5cbiAgY3VycmVudEVuZHBvaW50KCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmN1cnJlbnRSZW1vdGUuZ2V0RW5kcG9pbnRPckRvdGNvbSgpO1xuICB9XG59XG4iXX0=