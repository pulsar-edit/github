"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.BareIssueishDetailController = void 0;

var _react = _interopRequireDefault(require("react"));

var _reactRelay = require("react-relay");

var _propTypes = _interopRequireDefault(require("prop-types"));

var _propTypes2 = require("../prop-types");

var _issueDetailView = _interopRequireDefault(require("../views/issue-detail-view"));

var _commitDetailItem = _interopRequireDefault(require("../items/commit-detail-item"));

var _reviewsItem = _interopRequireDefault(require("../items/reviews-item"));

var _reporterProxy = require("../reporter-proxy");

var _prCheckoutController = _interopRequireDefault(require("./pr-checkout-controller"));

var _prDetailView = _interopRequireDefault(require("../views/pr-detail-view"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

class BareIssueishDetailController extends _react.default.Component {
  constructor(...args) {
    super(...args);

    _defineProperty(this, "openCommit", async ({
      sha
    }) => {
      /* istanbul ignore if */
      if (!this.props.workdirPath) {
        return;
      }

      const uri = _commitDetailItem.default.buildURI(this.props.workdirPath, sha);

      await this.props.workspace.open(uri, {
        pending: true
      });
      (0, _reporterProxy.addEvent)('open-commit-in-pane', {
        package: 'github',
        from: this.constructor.name
      });
    });

    _defineProperty(this, "openReviews", async () => {
      /* istanbul ignore if */
      if (this.getTypename() !== 'PullRequest') {
        return;
      }

      const uri = _reviewsItem.default.buildURI({
        host: this.props.endpoint.getHost(),
        owner: this.props.repository.owner.login,
        repo: this.props.repository.name,
        number: this.props.issueishNumber,
        workdir: this.props.workdirPath
      });

      await this.props.workspace.open(uri);
      (0, _reporterProxy.addEvent)('open-reviews-tab', {
        package: 'github',
        from: this.constructor.name
      });
    });
  }

  componentDidMount() {
    this.updateTitle();
  }

  componentDidUpdate() {
    this.updateTitle();
  }

  updateTitle() {
    const {
      repository
    } = this.props;

    if (repository && (repository.issue || repository.pullRequest)) {
      let prefix, issueish;

      if (this.getTypename() === 'PullRequest') {
        prefix = 'PR:';
        issueish = repository.pullRequest;
      } else {
        prefix = 'Issue:';
        issueish = repository.issue;
      }

      const title = `${prefix} ${repository.owner.login}/${repository.name}#${issueish.number} â€” ${issueish.title}`;
      this.props.onTitleChange(title);
    }
  }

  render() {
    const {
      repository
    } = this.props;

    if (!repository || !repository.issue || !repository.pullRequest) {
      return _react.default.createElement("div", null, "Issue/PR #", this.props.issueishNumber, " not found"); // TODO: no PRs
    }

    if (this.getTypename() === 'PullRequest') {
      return _react.default.createElement(_prCheckoutController.default, {
        repository: repository,
        pullRequest: repository.pullRequest,
        localRepository: this.props.localRepository,
        isAbsent: this.props.isAbsent,
        isLoading: this.props.isLoading,
        isPresent: this.props.isPresent,
        isMerging: this.props.isMerging,
        isRebasing: this.props.isRebasing,
        branches: this.props.branches,
        remotes: this.props.remotes
      }, checkoutOp => _react.default.createElement(_prDetailView.default, {
        relay: this.props.relay,
        repository: this.props.repository,
        pullRequest: this.props.repository.pullRequest,
        checkoutOp: checkoutOp,
        localRepository: this.props.localRepository,
        reviewCommentsLoading: this.props.reviewCommentsLoading,
        reviewCommentsTotalCount: this.props.reviewCommentsTotalCount,
        reviewCommentsResolvedCount: this.props.reviewCommentsResolvedCount,
        reviewCommentThreads: this.props.reviewCommentThreads,
        endpoint: this.props.endpoint,
        token: this.props.token,
        workspace: this.props.workspace,
        commands: this.props.commands,
        keymaps: this.props.keymaps,
        tooltips: this.props.tooltips,
        config: this.props.config,
        openCommit: this.openCommit,
        openReviews: this.openReviews,
        switchToIssueish: this.props.switchToIssueish,
        destroy: this.props.destroy,
        reportRelayError: this.props.reportRelayError,
        itemType: this.props.itemType,
        refEditor: this.props.refEditor,
        initChangedFilePath: this.props.initChangedFilePath,
        initChangedFilePosition: this.props.initChangedFilePosition,
        selectedTab: this.props.selectedTab,
        onTabSelected: this.props.onTabSelected,
        onOpenFilesTab: this.props.onOpenFilesTab,
        workdirPath: this.props.workdirPath
      }));
    } else {
      return _react.default.createElement(_issueDetailView.default, {
        repository: repository,
        issue: repository.issue,
        switchToIssueish: this.props.switchToIssueish,
        tooltips: this.props.tooltips,
        reportRelayError: this.props.reportRelayError
      });
    }
  }

  getTypename() {
    const {
      repository
    } = this.props;
    /* istanbul ignore if */

    if (!repository) {
      return null;
    }
    /* istanbul ignore if */


    if (!repository.pullRequest) {
      return null;
    }

    return repository.pullRequest.__typename;
  }

}

exports.BareIssueishDetailController = BareIssueishDetailController;

_defineProperty(BareIssueishDetailController, "propTypes", {
  // Relay response
  relay: _propTypes.default.object.isRequired,
  repository: _propTypes.default.shape({
    name: _propTypes.default.string.isRequired,
    owner: _propTypes.default.shape({
      login: _propTypes.default.string.isRequired
    }).isRequired,
    pullRequest: _propTypes.default.any,
    issue: _propTypes.default.any
  }),
  // Local Repository model properties
  localRepository: _propTypes.default.object.isRequired,
  branches: _propTypes2.BranchSetPropType.isRequired,
  remotes: _propTypes2.RemoteSetPropType.isRequired,
  isMerging: _propTypes.default.bool.isRequired,
  isRebasing: _propTypes.default.bool.isRequired,
  isAbsent: _propTypes.default.bool.isRequired,
  isLoading: _propTypes.default.bool.isRequired,
  isPresent: _propTypes.default.bool.isRequired,
  workdirPath: _propTypes.default.string,
  issueishNumber: _propTypes.default.number.isRequired,
  // Review comment threads
  reviewCommentsLoading: _propTypes.default.bool.isRequired,
  reviewCommentsTotalCount: _propTypes.default.number.isRequired,
  reviewCommentsResolvedCount: _propTypes.default.number.isRequired,
  reviewCommentThreads: _propTypes.default.arrayOf(_propTypes.default.shape({
    thread: _propTypes.default.object.isRequired,
    comments: _propTypes.default.arrayOf(_propTypes.default.object).isRequired
  })).isRequired,
  // Connection information
  endpoint: _propTypes2.EndpointPropType.isRequired,
  token: _propTypes.default.string.isRequired,
  // Atom environment
  workspace: _propTypes.default.object.isRequired,
  commands: _propTypes.default.object.isRequired,
  keymaps: _propTypes.default.object.isRequired,
  tooltips: _propTypes.default.object.isRequired,
  config: _propTypes.default.object.isRequired,
  // Action methods
  onTitleChange: _propTypes.default.func.isRequired,
  switchToIssueish: _propTypes.default.func.isRequired,
  destroy: _propTypes.default.func.isRequired,
  reportRelayError: _propTypes.default.func.isRequired,
  // Item context
  itemType: _propTypes2.ItemTypePropType.isRequired,
  refEditor: _propTypes2.RefHolderPropType.isRequired,
  // For opening files changed tab
  initChangedFilePath: _propTypes.default.string,
  initChangedFilePosition: _propTypes.default.number,
  selectedTab: _propTypes.default.number.isRequired,
  onTabSelected: _propTypes.default.func.isRequired,
  onOpenFilesTab: _propTypes.default.func.isRequired
});

var _default = (0, _reactRelay.createFragmentContainer)(BareIssueishDetailController, {
  repository: function () {
    const node = require("./__generated__/issueishDetailController_repository.graphql");

    if (node.hash && node.hash !== "504a7b23eb6c4c87798663e4d9c7136a") {
      console.error("The definition of 'issueishDetailController_repository' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data.");
    }

    return require("./__generated__/issueishDetailController_repository.graphql");
  }
});

exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9jb250cm9sbGVycy9pc3N1ZWlzaC1kZXRhaWwtY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJCYXJlSXNzdWVpc2hEZXRhaWxDb250cm9sbGVyIiwiUmVhY3QiLCJDb21wb25lbnQiLCJzaGEiLCJwcm9wcyIsIndvcmtkaXJQYXRoIiwidXJpIiwiQ29tbWl0RGV0YWlsSXRlbSIsImJ1aWxkVVJJIiwid29ya3NwYWNlIiwib3BlbiIsInBlbmRpbmciLCJwYWNrYWdlIiwiZnJvbSIsImNvbnN0cnVjdG9yIiwibmFtZSIsImdldFR5cGVuYW1lIiwiUmV2aWV3c0l0ZW0iLCJob3N0IiwiZW5kcG9pbnQiLCJnZXRIb3N0Iiwib3duZXIiLCJyZXBvc2l0b3J5IiwibG9naW4iLCJyZXBvIiwibnVtYmVyIiwiaXNzdWVpc2hOdW1iZXIiLCJ3b3JrZGlyIiwiY29tcG9uZW50RGlkTW91bnQiLCJ1cGRhdGVUaXRsZSIsImNvbXBvbmVudERpZFVwZGF0ZSIsImlzc3VlIiwicHVsbFJlcXVlc3QiLCJwcmVmaXgiLCJpc3N1ZWlzaCIsInRpdGxlIiwib25UaXRsZUNoYW5nZSIsInJlbmRlciIsImxvY2FsUmVwb3NpdG9yeSIsImlzQWJzZW50IiwiaXNMb2FkaW5nIiwiaXNQcmVzZW50IiwiaXNNZXJnaW5nIiwiaXNSZWJhc2luZyIsImJyYW5jaGVzIiwicmVtb3RlcyIsImNoZWNrb3V0T3AiLCJyZWxheSIsInJldmlld0NvbW1lbnRzTG9hZGluZyIsInJldmlld0NvbW1lbnRzVG90YWxDb3VudCIsInJldmlld0NvbW1lbnRzUmVzb2x2ZWRDb3VudCIsInJldmlld0NvbW1lbnRUaHJlYWRzIiwidG9rZW4iLCJjb21tYW5kcyIsImtleW1hcHMiLCJ0b29sdGlwcyIsImNvbmZpZyIsIm9wZW5Db21taXQiLCJvcGVuUmV2aWV3cyIsInN3aXRjaFRvSXNzdWVpc2giLCJkZXN0cm95IiwicmVwb3J0UmVsYXlFcnJvciIsIml0ZW1UeXBlIiwicmVmRWRpdG9yIiwiaW5pdENoYW5nZWRGaWxlUGF0aCIsImluaXRDaGFuZ2VkRmlsZVBvc2l0aW9uIiwic2VsZWN0ZWRUYWIiLCJvblRhYlNlbGVjdGVkIiwib25PcGVuRmlsZXNUYWIiLCJfX3R5cGVuYW1lIiwiUHJvcFR5cGVzIiwib2JqZWN0IiwiaXNSZXF1aXJlZCIsInNoYXBlIiwic3RyaW5nIiwiYW55IiwiQnJhbmNoU2V0UHJvcFR5cGUiLCJSZW1vdGVTZXRQcm9wVHlwZSIsImJvb2wiLCJhcnJheU9mIiwidGhyZWFkIiwiY29tbWVudHMiLCJFbmRwb2ludFByb3BUeXBlIiwiZnVuYyIsIkl0ZW1UeXBlUHJvcFR5cGUiLCJSZWZIb2xkZXJQcm9wVHlwZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUVBOztBQUdBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7QUFFTyxNQUFNQSw0QkFBTixTQUEyQ0MsZUFBTUMsU0FBakQsQ0FBMkQ7QUFBQTtBQUFBOztBQUFBLHdDQW9LbkQsT0FBTztBQUFDQyxNQUFBQTtBQUFELEtBQVAsS0FBaUI7QUFDNUI7QUFDQSxVQUFJLENBQUMsS0FBS0MsS0FBTCxDQUFXQyxXQUFoQixFQUE2QjtBQUMzQjtBQUNEOztBQUVELFlBQU1DLEdBQUcsR0FBR0MsMEJBQWlCQyxRQUFqQixDQUEwQixLQUFLSixLQUFMLENBQVdDLFdBQXJDLEVBQWtERixHQUFsRCxDQUFaOztBQUNBLFlBQU0sS0FBS0MsS0FBTCxDQUFXSyxTQUFYLENBQXFCQyxJQUFyQixDQUEwQkosR0FBMUIsRUFBK0I7QUFBQ0ssUUFBQUEsT0FBTyxFQUFFO0FBQVYsT0FBL0IsQ0FBTjtBQUNBLG1DQUFTLHFCQUFULEVBQWdDO0FBQUNDLFFBQUFBLE9BQU8sRUFBRSxRQUFWO0FBQW9CQyxRQUFBQSxJQUFJLEVBQUUsS0FBS0MsV0FBTCxDQUFpQkM7QUFBM0MsT0FBaEM7QUFDRCxLQTdLK0Q7O0FBQUEseUNBK0tsRCxZQUFZO0FBQ3hCO0FBQ0EsVUFBSSxLQUFLQyxXQUFMLE9B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QWEsRUFBRWtDLG1CQUFVYSxJQUFWLENBQWVYLFVBN0NiO0FBOENqQmIsRUFBQUEsZ0JBQWdCLEVBQUVXLG1CQUFVYSxJQUFWLENBQWVYLFVBOUNoQjtBQStDakJaLEVBQUFBLE9BQU8sRUFBRVUsbUJBQVVhLElBQVYsQ0FBZVgsVUEvQ1A7QUFnRGpCWCxFQUFBQSxnQkFBZ0IsRUFBRVMsbUJBQVVhLElBQVYsQ0FBZVgsVUFoRGhCO0FBa0RqQjtBQUNBVixFQUFBQSxRQUFRLEVBQUVzQiw2QkFBaUJaLFVBbkRWO0FBb0RqQlQsRUFBQUEsU0FBUyxFQUFFc0IsOEJBQWtCYixVQXBEWjtBQXNEakI7QUFDQVIsRUFBQUEsbUJBQW1CLEVBQUVNLG1CQUFVSSxNQXZEZDtBQXdEakJULEVBQUFBLHVCQUF1QixFQUFFSyxtQkFBVTdDLE1BeERsQjtBQXlEakJ5QyxFQUFBQSxXQUFXLEVBQUVJLG1CQUFVN0MsTUFBVixDQUFpQitDLFVBekRiO0FBMERqQkwsRUFBQUEsYUFBYSxFQUFFRyxtQkFBVWEsSUFBVixDQUFlWCxVQTFEYjtBQTJEakJKLEVBQUFBLGNBQWMsRUFBRUUsbUJBQVVhLElBQVYsQ0FBZVg7QUEzRGQsQzs7ZUE2TU4seUNBQXdCeEUsNEJBQXhCLEVBQXNEO0FBQ25Fc0IsRUFBQUEsVUFBVTtBQUFBOztBQUFBO0FBQUE7QUFBQTs7QUFBQTtBQUFBO0FBRHlELENBQXRELEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHtncmFwaHFsLCBjcmVhdGVGcmFnbWVudENvbnRhaW5lcn0gZnJvbSAncmVhY3QtcmVsYXknO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcblxuaW1wb3J0IHtcbiAgQnJhbmNoU2V0UHJvcFR5cGUsIFJlbW90ZVNldFByb3BUeXBlLCBJdGVtVHlwZVByb3BUeXBlLCBFbmRwb2ludFByb3BUeXBlLCBSZWZIb2xkZXJQcm9wVHlwZSxcbn0gZnJvbSAnLi4vcHJvcC10eXBlcyc7XG5pbXBvcnQgSXNzdWVEZXRhaWxWaWV3IGZyb20gJy4uL3ZpZXdzL2lzc3VlLWRldGFpbC12aWV3JztcbmltcG9ydCBDb21taXREZXRhaWxJdGVtIGZyb20gJy4uL2l0ZW1zL2NvbW1pdC1kZXRhaWwtaXRlbSc7XG5pbXBvcnQgUmV2aWV3c0l0ZW0gZnJvbSAnLi4vaXRlbXMvcmV2aWV3cy1pdGVtJztcbmltcG9ydCB7YWRkRXZlbnR9IGZyb20gJy4uL3JlcG9ydGVyLXByb3h5JztcbmltcG9ydCBQdWxsUmVxdWVzdENoZWNrb3V0Q29udHJvbGxlciBmcm9tICcuL3ByLWNoZWNrb3V0LWNvbnRyb2xsZXInO1xuaW1wb3J0IFB1bGxSZXF1ZXN0RGV0YWlsVmlldyBmcm9tICcuLi92aWV3cy9wci1kZXRhaWwtdmlldyc7XG5cbmV4cG9ydCBjbGFzcyBCYXJlSXNzdWVpc2hEZXRhaWxDb250cm9sbGVyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAvLyBSZWxheSByZXNwb25zZVxuICAgIHJlbGF5OiBQcm9wVHlwZXMub2JqZWN0LmlzUmVxdWlyZWQsXG4gICAgcmVwb3NpdG9yeTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIG5hbWU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICAgIG93bmVyOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICBsb2dpbjogUHJvcFR5cGVzLnN0cmluZy5pc1JlcXVpcmVkLFxuICAgICAgfSkuaXNSZXF1aXJlZCxcbiAgICAgIHB1bGxSZXF1ZXN0OiBQcm9wVHlwZXMuYW55LFxuICAgICAgaXNzdWU6IFByb3BUeXBlcy5hbnksXG4gICAgfSksXG5cbiAgICAvLyBMb2NhbCBSZXBvc2l0b3J5IG1vZGVsIHByb3BlcnRpZXNcbiAgICBsb2NhbFJlcG9zaXRvcnk6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBicmFuY2hlczogQnJhbmNoU2V0UHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICByZW1vdGVzOiBSZW1vdGVTZXRQcm9wVHlwZS5pc1JlcXVpcmVkLFxuICAgIGlzTWVyZ2luZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBpc1JlYmFzaW5nOiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzQWJzZW50OiBQcm9wVHlwZXMuYm9vbC5pc1JlcXVpcmVkLFxuICAgIGlzTG9hZGluZzogUHJvcFR5cGVzLmJvb2wuaXNSZXF1aXJlZCxcbiAgICBpc1ByZXNlbnQ6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgd29ya2RpclBhdGg6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgaXNzdWVpc2hOdW1iZXI6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcblxuICAgIC8vIFJldmlldyBjb21tZW50IHRocmVhZHNcbiAgICByZXZpZXdDb21tZW50c0xvYWRpbmc6IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgcmV2aWV3Q29tbWVudHNUb3RhbENvdW50OiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgcmV2aWV3Q29tbWVudHNSZXNvbHZlZENvdW50OiBQcm9wVHlwZXMubnVtYmVyLmlzUmVxdWlyZWQsXG4gICAgcmV2aWV3Q29tbWVudFRocmVhZHM6IFByb3BUeXBlcy5hcnJheU9mKFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICB0aHJlYWQ6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICAgIGNvbW1lbnRzOiBQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMub2JqZWN0KS5pc1JlcXVpcmVkLFxuICAgIH0pKS5pc1JlcXVpcmVkLFxuXG4gICAgLy8gQ29ubmVjdGlvbiBpbmZvcm1hdGlvblxuICAgIGVuZHBvaW50OiBFbmRwb2ludFByb3BUeXBlLmlzUmVxdWlyZWQsXG4gICAgdG9rZW46IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcblxuICAgIC8vIEF0b20gZW52aXJvbm1lbnRcbiAgICB3b3Jrc3BhY2U6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICBjb21tYW5kczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGtleW1hcHM6IFByb3BUeXBlcy5vYmplY3QuaXNSZXF1aXJlZCxcbiAgICB0b29sdGlwczogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIGNvbmZpZzogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuXG4gICAgLy8gQWN0aW9uIG1ldGhvZHNcbiAgICBvblRpdGxlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIHN3aXRjaFRvSXNzdWVpc2g6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG4gICAgZGVzdHJveTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICByZXBvcnRSZWxheUVycm9yOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuXG4gICAgLy8gSXRlbSBjb250ZXh0XG4gICAgaXRlbVR5cGU6IEl0ZW1UeXBlUHJvcFR5cGUuaXNSZXF1aXJlZCxcbiAgICByZWZFZGl0b3I6IFJlZkhvbGRlclByb3BUeXBlLmlzUmVxdWlyZWQsXG5cbiAgICAvLyBGb3Igb3BlbmluZyBmaWxlcyBjaGFuZ2VkIHRhYlxuICAgIGluaXRDaGFuZ2VkRmlsZVBhdGg6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgaW5pdENoYW5nZWRGaWxlUG9zaXRpb246IFByb3BUeXBlcy5udW1iZXIsXG4gICAgc2VsZWN0ZWRUYWI6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgICBvblRhYlNlbGVjdGVkOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIG9uT3BlbkZpbGVzVGFiOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy51cGRhdGVUaXRsZSgpO1xuICB9XG5cbiAgY29tcG9uZW50RGlkVXBkYXRlKCkge1xuICAgIHRoaXMudXBkYXRlVGl0bGUoKTtcbiAgfVxuXG4gIHVwZGF0ZVRpdGxlKCkge1xuICAgIGNvbnN0IHtyZXBvc2l0b3J5fSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKHJlcG9zaXRvcnkgJiYgKHJlcG9zaXRvcnkuaXNzdWUgfHwgcmVwb3NpdG9yeS5wdWxsUmVxdWVzdCkpIHtcbiAgICAgIGxldCBwcmVmaXgsIGlzc3VlaXNoO1xuICAgICAgaWYgKHRoaXMuZ2V0VHlwZW5hbWUoKSA9PT0gJ1B1bGxSZXF1ZXN0Jykge1xuICAgICAgICBwcmVmaXggPSAnUFI6JztcbiAgICAgICAgaXNzdWVpc2ggPSByZXBvc2l0b3J5LnB1bGxSZXF1ZXN0O1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcHJlZml4ID0gJ0lzc3VlOic7XG4gICAgICAgIGlzc3VlaXNoID0gcmVwb3NpdG9yeS5pc3N1ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHRpdGxlID0gYCR7cHJlZml4fSAke3JlcG9zaXRvcnkub3duZXIubG9naW59LyR7cmVwb3NpdG9yeS5uYW1lfSMke2lzc3VlaXNoLm51bWJlcn0g4oCUICR7aXNzdWVpc2gudGl0bGV9YDtcbiAgICAgIHRoaXMucHJvcHMub25UaXRsZUNoYW5nZSh0aXRsZSk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHtyZXBvc2l0b3J5fSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKCFyZXBvc2l0b3J5IHx8ICFyZXBvc2l0b3J5Lmlzc3VlIHx8ICFyZXBvc2l0b3J5LnB1bGxSZXF1ZXN0KSB7XG4gICAgICByZXR1cm4gPGRpdj5Jc3N1ZS9QUiAje3RoaXMucHJvcHMuaXNzdWVpc2hOdW1iZXJ9IG5vdCBmb3VuZDwvZGl2PjsgLy8gVE9ETzogbm8gUFJzXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuZ2V0VHlwZW5hbWUoKSA9PT0gJ1B1bGxSZXF1ZXN0Jykge1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPFB1bGxSZXF1ZXN0Q2hlY2tvdXRDb250cm9sbGVyXG4gICAgICAgICAgcmVwb3NpdG9yeT17cmVwb3NpdG9yeX1cbiAgICAgICAgICBwdWxsUmVxdWVzdD17cmVwb3NpdG9yeS5wdWxsUmVxdWVzdH1cblxuICAgICAgICAgIGxvY2FsUmVwb3NpdG9yeT17dGhpcy5wcm9wcy5sb2NhbFJlcG9zaXRvcnl9XG4gICAgICAgICAgaXNBYnNlbnQ9e3RoaXMucHJvcHMuaXNBYnNlbnR9XG4gICAgICAgICAgaXNMb2FkaW5nPXt0aGlzLnByb3BzLmlzTG9hZGluZ31cbiAgICAgICAgICBpc1ByZXNlbnQ9e3RoaXMucHJvcHMuaXNQcmVzZW50fVxuICAgICAgICAgIGlzTWVyZ2luZz17dGhpcy5wcm9wcy5pc01lcmdpbmd9XG4gICAgICAgICAgaXNSZWJhc2luZz17dGhpcy5wcm9wcy5pc1JlYmFzaW5nfVxuICAgICAgICAgIGJyYW5jaGVzPXt0aGlzLnByb3BzLmJyYW5jaGVzfVxuICAgICAgICAgIHJlbW90ZXM9e3RoaXMucHJvcHMucmVtb3Rlc30+XG5cbiAgICAgICAgICB7Y2hlY2tvdXRPcCA9PiAoXG4gICAgICAgICAgICA8UHVsbFJlcXVlc3REZXRhaWxWaWV3XG4gICAgICAgICAgICAgIHJlbGF5PXt0aGlzLnByb3BzLnJlbGF5fVxuICAgICAgICAgICAgICByZXBvc2l0b3J5PXt0aGlzLnByb3BzLnJlcG9zaXRvcnl9XG4gICAgICAgICAgICAgIHB1bGxSZXF1ZXN0PXt0aGlzLnByb3BzLnJlcG9zaXRvcnkucHVsbFJlcXVlc3R9XG5cbiAgICAgICAgICAgICAgY2hlY2tvdXRPcD17Y2hlY2tvdXRPcH1cbiAgICAgICAgICAgICAgbG9jYWxSZXBvc2l0b3J5PXt0aGlzLnByb3BzLmxvY2FsUmVwb3NpdG9yeX1cblxuICAgICAgICAgICAgICByZXZpZXdDb21tZW50c0xvYWRpbmc9e3RoaXMucHJvcHMucmV2aWV3Q29tbWVudHNMb2FkaW5nfVxuICAgICAgICAgICAgICByZXZpZXdDb21tZW50c1RvdGFsQ291bnQ9e3RoaXMucHJvcHMucmV2aWV3Q29tbWVudHNUb3RhbENvdW50fVxuICAgICAgICAgICAgICByZXZpZXdDb21tZW50c1Jlc29sdmVkQ291bnQ9e3RoaXMucHJvcHMucmV2aWV3Q29tbWVudHNSZXNvbHZlZENvdW50fVxuICAgICAgICAgICAgICByZXZpZXdDb21tZW50VGhyZWFkcz17dGhpcy5wcm9wcy5yZXZpZXdDb21tZW50VGhyZWFkc31cblxuICAgICAgICAgICAgICBlbmRwb2ludD17dGhpcy5wcm9wcy5lbmRwb2ludH1cbiAgICAgICAgICAgICAgdG9rZW49e3RoaXMucHJvcHMudG9rZW59XG5cbiAgICAgICAgICAgICAgd29ya3NwYWNlPXt0aGlzLnByb3BzLndvcmtzcGFjZX1cbiAgICAgICAgICAgICAgY29tbWFuZHM9e3RoaXMucHJvcHMuY29tbWFuZHN9XG4gICAgICAgICAgICAgIGtleW1hcHM9e3RoaXMucHJvcHMua2V5bWFwc31cbiAgICAgICAgICAgICAgdG9vbHRpcHM9e3RoaXMucHJvcHMudG9vbHRpcHN9XG4gICAgICAgICAgICAgIGNvbmZpZz17dGhpcy5wcm9wcy5jb25maWd9XG5cbiAgICAgICAgICAgICAgb3BlbkNvbW1pdD17dGhpcy5vcGVuQ29tbWl0fVxuICAgICAgICAgICAgICBvcGVuUmV2aWV3cz17dGhpcy5vcGVuUmV2aWV3c31cbiAgICAgICAgICAgICAgc3dpdGNoVG9Jc3N1ZWlzaD17dGhpcy5wcm9wcy5zd2l0Y2hUb0lzc3VlaXNofVxuICAgICAgICAgICAgICBkZXN0cm95PXt0aGlzLnByb3BzLmRlc3Ryb3l9XG4gICAgICAgICAgICAgIHJlcG9ydFJlbGF5RXJyb3I9e3RoaXMucHJvcHMucmVwb3J0UmVsYXlFcnJvcn1cblxuICAgICAgICAgICAgICBpdGVtVHlwZT17dGhpcy5wcm9wcy5pdGVtVHlwZX1cbiAgICAgICAgICAgICAgcmVmRWRpdG9yPXt0aGlzLnByb3BzLnJlZkVkaXRvcn1cblxuICAgICAgICAgICAgICBpbml0Q2hhbmdlZEZpbGVQYXRoPXt0aGlzLnByb3BzLmluaXRDaGFuZ2VkRmlsZVBhdGh9XG4gICAgICAgICAgICAgIGluaXRDaGFuZ2VkRmlsZVBvc2l0aW9uPXt0aGlzLnByb3BzLmluaXRDaGFuZ2VkRmlsZVBvc2l0aW9ufVxuICAgICAgICAgICAgICBzZWxlY3RlZFRhYj17dGhpcy5wcm9wcy5zZWxlY3RlZFRhYn1cbiAgICAgICAgICAgICAgb25UYWJTZWxlY3RlZD17dGhpcy5wcm9wcy5vblRhYlNlbGVjdGVkfVxuICAgICAgICAgICAgICBvbk9wZW5GaWxlc1RhYj17dGhpcy5wcm9wcy5vbk9wZW5GaWxlc1RhYn1cbiAgICAgICAgICAgICAgd29ya2RpclBhdGg9e3RoaXMucHJvcHMud29ya2RpclBhdGh9XG4gICAgICAgICAgICAvPlxuICAgICAgICAgICl9XG5cbiAgICAgICAgPC9QdWxsUmVxdWVzdENoZWNrb3V0Q29udHJvbGxlcj5cbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAoXG4gICAgICAgIDxJc3N1ZURldGFpbFZpZXdcbiAgICAgICAgICByZXBvc2l0b3J5PXtyZXBvc2l0b3J5fVxuICAgICAgICAgIGlzc3VlPXtyZXBvc2l0b3J5Lmlzc3VlfVxuICAgICAgICAgIHN3aXRjaFRvSXNzdWVpc2g9e3RoaXMucHJvcHMuc3dpdGNoVG9Jc3N1ZWlzaH1cbiAgICAgICAgICB0b29sdGlwcz17dGhpcy5wcm9wcy50b29sdGlwc31cbiAgICAgICAgICByZXBvcnRSZWxheUVycm9yPXt0aGlzLnByb3BzLnJlcG9ydFJlbGF5RXJyb3J9XG4gICAgICAgIC8+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIG9wZW5Db21taXQgPSBhc3luYyAoe3NoYX0pID0+IHtcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICBpZiAoIXRoaXMucHJvcHMud29ya2RpclBhdGgpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCB1cmkgPSBDb21taXREZXRhaWxJdGVtLmJ1aWxkVVJJKHRoaXMucHJvcHMud29ya2RpclBhdGgsIHNoYSk7XG4gICAgYXdhaXQgdGhpcy5wcm9wcy53b3Jrc3BhY2Uub3Blbih1cmksIHtwZW5kaW5nOiB0cnVlfSk7XG4gICAgYWRkRXZlbnQoJ29wZW4tY29tbWl0LWluLXBhbmUnLCB7cGFja2FnZTogJ2dpdGh1YicsIGZyb206IHRoaXMuY29uc3RydWN0b3IubmFtZX0pO1xuICB9XG5cbiAgb3BlblJldmlld3MgPSBhc3luYyAoKSA9PiB7XG4gICAgLyogaXN0YW5idWwgaWdub3JlIGlmICovXG4gICAgaWYgKHRoaXMuZ2V0VHlwZW5hbWUoKSAhPT0gJ1B1bGxSZXF1ZXN0Jykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHVyaSA9IFJldmlld3NJdGVtLmJ1aWxkVVJJKHtcbiAgICAgIGhvc3Q6IHRoaXMucHJvcHMuZW5kcG9pbnQuZ2V0SG9zdCgpLFxuICAgICAgb3duZXI6IHRoaXMucHJvcHMucmVwb3NpdG9yeS5vd25lci5sb2dpbixcbiAgICAgIHJlcG86IHRoaXMucHJvcHMucmVwb3NpdG9yeS5uYW1lLFxuICAgICAgbnVtYmVyOiB0aGlzLnByb3BzLmlzc3VlaXNoTnVtYmVyLFxuICAgICAgd29ya2RpcjogdGhpcy5wcm9wcy53b3JrZGlyUGF0aCxcbiAgICB9KTtcbiAgICBhd2FpdCB0aGlzLnByb3BzLndvcmtzcGFjZS5vcGVuKHVyaSk7XG4gICAgYWRkRXZlbnQoJ29wZW4tcmV2aWV3cy10YWInLCB7cGFja2FnZTogJ2dpdGh1YicsIGZyb206IHRoaXMuY29uc3RydWN0b3IubmFtZX0pO1xuICB9XG5cbiAgZ2V0VHlwZW5hbWUoKSB7XG4gICAgY29uc3Qge3JlcG9zaXRvcnl9ID0gdGhpcy5wcm9wcztcbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICBpZiAoIXJlcG9zaXRvcnkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICAvKiBpc3RhbmJ1bCBpZ25vcmUgaWYgKi9cbiAgICBpZiAoIXJlcG9zaXRvcnkucHVsbFJlcXVlc3QpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gcmVwb3NpdG9yeS5wdWxsUmVxdWVzdC5fX3R5cGVuYW1lO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUZyYWdtZW50Q29udGFpbmVyKEJhcmVJc3N1ZWlzaERldGFpbENvbnRyb2xsZXIsIHtcbiAgcmVwb3NpdG9yeTogZ3JhcGhxbGBcbiAgICBmcmFnbWVudCBpc3N1ZWlzaERldGFpbENvbnRyb2xsZXJfcmVwb3NpdG9yeSBvbiBSZXBvc2l0b3J5XG4gICAgQGFyZ3VtZW50RGVmaW5pdGlvbnMoXG4gICAgICBpc3N1ZWlzaE51bWJlcjoge3R5cGU6IFwiSW50IVwifVxuICAgICAgdGltZWxpbmVDb3VudDoge3R5cGU6IFwiSW50IVwifVxuICAgICAgdGltZWxpbmVDdXJzb3I6IHt0eXBlOiBcIlN0cmluZ1wifVxuICAgICAgY29tbWl0Q291bnQ6IHt0eXBlOiBcIkludCFcIn1cbiAgICAgIGNvbW1pdEN1cnNvcjoge3R5cGU6IFwiU3RyaW5nXCJ9XG4gICAgICBjaGVja1N1aXRlQ291bnQ6IHt0eXBlOiBcIkludCFcIn1cbiAgICAgIGNoZWNrU3VpdGVDdXJzb3I6IHt0eXBlOiBcIlN0cmluZ1wifVxuICAgICAgY2hlY2tSdW5Db3VudDoge3R5cGU6IFwiSW50IVwifVxuICAgICAgY2hlY2tSdW5DdXJzb3I6IHt0eXBlOiBcIlN0cmluZ1wifVxuICAgICkge1xuICAgICAgLi4uaXNzdWVEZXRhaWxWaWV3X3JlcG9zaXRvcnlcbiAgICAgIC4uLnByQ2hlY2tvdXRDb250cm9sbGVyX3JlcG9zaXRvcnlcbiAgICAgIC4uLnByRGV0YWlsVmlld19yZXBvc2l0b3J5XG4gICAgICBuYW1lXG4gICAgICBvd25lciB7XG4gICAgICAgIGxvZ2luXG4gICAgICB9XG4gICAgICBpc3N1ZTogaXNzdWVPclB1bGxSZXF1ZXN0KG51bWJlcjogJGlzc3VlaXNoTnVtYmVyKSB7XG4gICAgICAgIF9fdHlwZW5hbWVcbiAgICAgICAgLi4uIG9uIElzc3VlIHtcbiAgICAgICAgICB0aXRsZVxuICAgICAgICAgIG51bWJlclxuICAgICAgICAgIC4uLmlzc3VlRGV0YWlsVmlld19pc3N1ZSBAYXJndW1lbnRzKFxuICAgICAgICAgICAgdGltZWxpbmVDb3VudDogJHRpbWVsaW5lQ291bnQsXG4gICAgICAgICAgICB0aW1lbGluZUN1cnNvcjogJHRpbWVsaW5lQ3Vyc29yLFxuICAgICAgICAgIClcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcHVsbFJlcXVlc3Q6IGlzc3VlT3JQdWxsUmVxdWVzdChudW1iZXI6ICRpc3N1ZWlzaE51bWJlcikge1xuICAgICAgICBfX3R5cGVuYW1lXG4gICAgICAgIC4uLiBvbiBQdWxsUmVxdWVzdCB7XG4gICAgICAgICAgdGl0bGVcbiAgICAgICAgICBudW1iZXJcbiAgICAgICAgICAuLi5wckNoZWNrb3V0Q29udHJvbGxlcl9wdWxsUmVxdWVzdFxuICAgICAgICAgIC4uLnByRGV0YWlsVmlld19wdWxsUmVxdWVzdCBAYXJndW1lbnRzKFxuICAgICAgICAgICAgdGltZWxpbmVDb3VudDogJHRpbWVsaW5lQ291bnRcbiAgICAgICAgICAgIHRpbWVsaW5lQ3Vyc29yOiAkdGltZWxpbmVDdXJzb3JcbiAgICAgICAgICAgIGNvbW1pdENvdW50OiAkY29tbWl0Q291bnRcbiAgICAgICAgICAgIGNvbW1pdEN1cnNvcjogJGNvbW1pdEN1cnNvclxuICAgICAgICAgICAgY2hlY2tTdWl0ZUNvdW50OiAkY2hlY2tTdWl0ZUNvdW50XG4gICAgICAgICAgICBjaGVja1N1aXRlQ3Vyc29yOiAkY2hlY2tTdWl0ZUN1cnNvclxuICAgICAgICAgICAgY2hlY2tSdW5Db3VudDogJGNoZWNrUnVuQ291bnRcbiAgICAgICAgICAgIGNoZWNrUnVuQ3Vyc29yOiAkY2hlY2tSdW5DdXJzb3JcbiAgICAgICAgICApXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIGAsXG59KTtcbiJdfQ==